<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ â€” Ù…Ø§Ù„ÙŠØ© ÙˆØªØ´ØºÙŠÙ„ÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø©</title>
  <meta name="robots" content="noindex">
  <link href="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.css" rel="stylesheet">
  <style>
    :root {
      --primary: #4361ee;
      --primary-light: #4895ef;
      --secondary: #3f37c9;
      --success: #4cc9f0;
      --success-dark: #3a86ff;
      --warning: #f72585;
      --warning-light: #b5179e;
      --danger: #f94144;
      --danger-light: #f3722c;
      --info: #7209b7;
      --info-light: #560bad;
      --dark: #1d3557;
      --light: #f1faee;
      --card: #ffffff;
      --muted: #6b7280;
      --gradient-primary: linear-gradient(135deg, var(--primary), var(--primary-light));
      --gradient-secondary: linear-gradient(135deg, var(--secondary), var(--primary));
      --gradient-success: linear-gradient(135deg, var(--success), var(--success-dark));
      --gradient-warning: linear-gradient(135deg, var(--warning), var(--warning-light));
      --gradient-danger: linear-gradient(135deg, var(--danger), var(--danger-light));
      --gradient-info: linear-gradient(135deg, var(--info), var(--info-light));
      --gradient-dark: linear-gradient(135deg, var(--dark), #457b9d);
      --shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 15px 40px rgba(0, 0, 0, 0.15);
      --radius: 12px;
      --transition: all 0.3s ease;
    }

    * {
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, system-ui, sans-serif;
    }

    html, body {
      height: 100%;
      margin: 0;
      background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
      color: var(--dark);
      scroll-behavior: smooth;
    }

    /* Ø£Ù†Ù…Ø§Ø· ØµÙØ­Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª */
    .help-nav-tabs {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 30px;
      background: white;
      padding: 15px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }

    .help-nav-tab {
      padding: 12px 20px;
      background: #f8fafc;
      border: none;
      border-radius: var(--radius);
      cursor: pointer;
      transition: var(--transition);
      font-weight: 600;
      color: var(--dark);
      font-size: 14px;
    }

    .help-nav-tab:hover {
      background: var(--primary-light);
      color: white;
      transform: translateY(-2px);
    }

    .help-nav-tab.active {
      background: var(--gradient-primary);
      color: white;
      box-shadow: var(--shadow);
    }

    .help-content-section {
      display: none;
      background: white;
      padding: 25px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      margin-bottom: 25px;
    }

    .help-content-section.active {
      display: block;
      animation: fadeIn 0.5s ease;
    }

    .help-step {
      background: #f8fafc;
      padding: 18px;
      border-radius: var(--radius);
      margin-bottom: 18px;
      border-right: 4px solid var(--primary);
      transition: var(--transition);
    }

    .help-step:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow);
    }

    .help-step-number {
      display: inline-block;
      background: var(--gradient-primary);
      color: white;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      text-align: center;
      line-height: 28px;
      margin-left: 10px;
      font-weight: bold;
      font-size: 14px;
    }

    .help-feature-card {
      background: white;
      border-radius: var(--radius);
      padding: 18px;
      margin-bottom: 18px;
      box-shadow: var(--shadow);
      border-top: 4px solid var(--primary);
      transition: var(--transition);
    }

    .help-feature-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
    }

    .help-feature-icon {
      font-size: 1.8rem;
      margin-bottom: 12px;
    }

    .help-role-section {
      margin-bottom: 25px;
    }

    .help-role-card {
      background: #f0f9ff;
      border-radius: var(--radius);
      padding: 18px;
      margin-bottom: 15px;
      border-left: 4px solid var(--info);
    }

    .help-faq-item {
      margin-bottom: 18px;
      border-bottom: 1px solid #f1f5f9;
      padding-bottom: 18px;
    }

    .help-faq-question {
      font-weight: 700;
      color: var(--dark);
      margin-bottom: 10px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .help-faq-answer {
      color: var(--muted);
      line-height: 1.7;
      font-size: 14px;
    }

    .help-tip-box {
      background: #f0fdf4;
      border-right: 4px solid var(--success);
      padding: 14px;
      border-radius: var(--radius);
      margin: 18px 0;
      font-size: 14px;
    }

    .help-warning-box {
      background: #fef2f2;
      border-right: 4px solid var(--danger);
      padding: 14px;
      border-radius: var(--radius);
      margin: 18px 0;
      font-size: 14px;
    }

    .help-info-box {
      background: #f0f9ff;
      border-right: 4px solid var(--info);
      padding: 14px;
      border-radius: var(--radius);
      margin: 18px 0;
      font-size: 14px;
    }

    .help-section-title {
      color: var(--primary);
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px solid #f1f5f9;
      font-size: 1.5rem;
    }

    .help-subsection-title {
      color: var(--secondary);
      margin: 22px 0 14px;
      font-size: 1.2rem;
    }

    .app {
      min-height: 100%;
      display: flex;
      flex-direction: column;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 20px;
      background: var(--gradient-primary);
      color: #fff;
      box-shadow: var(--shadow);
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .brand {
      font-weight: 800;
      font-size: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand i {
      font-size: 24px;
    }

    .role-switch {
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
    }

    .role-btn {
      background: rgba(255, 255, 255, 0.15);
      border: 0;
      padding: 8px 14px;
      border-radius: 8px;
      color: #fff;
      cursor: pointer;
      transition: var(--transition);
      font-size: 12px;
      font-weight: 600;
    }

    .role-btn:hover {
      background: rgba(255, 255, 255, 0.25);
      transform: translateY(-2px);
    }

    .role-btn.active {
      background: #fff;
      color: var(--primary);
      box-shadow: var(--shadow);
    }

    main {
      display: grid;
      grid-template-columns: 360px 1fr;
      gap: 18px;
      padding: 20px;
      flex: 1;
    }

    aside {
      background: var(--card);
      border-radius: var(--radius);
      padding: 16px;
      box-shadow: var(--shadow);
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .panel {
      background: var(--card);
      border-radius: var(--radius);
      padding: 16px;
      box-shadow: var(--shadow);
      transition: var(--transition);
    }

    .panel:hover {
      box-shadow: var(--shadow-lg);
      transform: translateY(-2px);
    }

    .kpis {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }

    .kpi {
      padding: 14px;
      border-radius: 10px;
      background: var(--light);
      text-align: right;
      transition: var(--transition);
      border-left: 4px solid var(--primary);
    }

    .kpi:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow);
    }

    .kpi .val {
      font-weight: 800;
      font-size: 20px;
      margin-top: 6px;
    }

    .list {
      max-height: 56vh;
      overflow: auto;
    }

    .item {
      padding: 12px;
      border-bottom: 1px solid #f1f5f9;
      transition: var(--transition);
    }

    .item:hover {
      background: #f8fafc;
      border-radius: 8px;
    }

    .muted {
      color: var(--muted);
      font-size: 13px;
    }

    .controls {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .btn {
      padding: 10px 16px;
      border-radius: 8px;
      border: 0;
      cursor: pointer;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
      font-size: 13px;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }

    .btn:hover::before {
      left: 100%;
    }

    .btn.primary {
      background: var(--gradient-primary);
      color: #fff;
    }

    .btn.ghost {
      background: transparent;
      border: 1px solid #e6eefc;
      color: var(--primary);
    }

    .btn.warn {
      background: var(--gradient-warning);
      color: #fff;
    }

    .btn.danger {
      background: var(--gradient-danger);
      color: #fff;
    }

    .btn.success {
      background: var(--gradient-success);
      color: #fff;
    }

    .btn.info {
      background: var(--gradient-info);
      color: #fff;
    }

    .btn.dark {
      background: var(--gradient-dark);
      color: #fff;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow);
    }

    .btn:active {
      transform: scale(0.98);
    }

    .view {
      display: none;
    }

    .view.active {
      display: block;
    }

    .driver-card {
      background: linear-gradient(90deg, #fff, #f7fbff);
      padding: 16px;
      border-radius: 12px;
      margin-bottom: 12px;
      border-left: 4px solid var(--primary);
      transition: var(--transition);
    }

    .driver-card:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow);
    }

    .big-btn {
      padding: 14px 18px;
      font-size: 15px;
      border-radius: 10px;
    }

    .notification {
      position: fixed;
      left: 20px;
      top: 20px;
      width: 360px;
      z-index: 9999;
    }

    .toast {
      background: #fff;
      padding: 14px;
      border-radius: 10px;
      box-shadow: var(--shadow-lg);
      margin-bottom: 10px;
      border-left: 6px solid var(--primary);
      transition: var(--transition);
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from { transform: translateX(-100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .timeline {
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
    }

    .timeline .step {
      padding: 10px 14px;
      border-radius: 10px;
      background: #f8fbff;
      color: var(--muted);
      font-weight: 700;
      font-size: 13px;
      transition: var(--transition);
    }

    .timeline .step.active {
      background: var(--gradient-primary);
      color: #fff;
      transform: scale(1.05);
    }

    .modal {
      position: fixed;
      inset: 0;
      background: rgba(2, 6, 23, 0.6);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 16px;
      z-index: 9999;
      backdrop-filter: blur(4px);
    }

    .modal.active {
      display: flex;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .dialog {
      width: 100%;
      max-width: 90vw;
      max-height: 85vh;
      background: #fff;
      border-radius: var(--radius);
      overflow: hidden;
      transition: transform 0.3s ease, opacity 0.3s ease;
      transform: scale(0.9);
      opacity: 0;
      box-shadow: var(--shadow-lg);
    }

    .dialog .head {
      padding: 16px;
      border-bottom: 1px solid #f1f5f9;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      background: #fff;
      z-index: 10;
    }

    .dialog .body {
      padding: 16px;
      max-height: calc(85vh - 80px);
      overflow-y: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th, td {
      padding: 12px;
      text-align: right;
      border-bottom: 1px solid #f3f6fb;
    }

    thead th {
      background: #f8fbff;
      color: var(--muted);
      font-weight: 700;
    }

    .deal-color-bar {
      height: 8px;
      border-radius: 6px 6px 0 0;
      margin-bottom: 12px;
    }

    .financial-summary {
      background: #fbfcff;
      border: 1px solid #eef4ff;
      padding: 14px;
      border-radius: 8px;
      margin-top: 12px;
    }

    .financial-summary-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
    }

    .financial-summary-table th,
    .financial-summary-table td {
      padding: 10px;
      text-align: right;
      border-bottom: 1px solid #f1f5f9;
    }

    .financial-summary-table th {
      background: #f8fafc;
      font-weight: 600;
      color: var(--dark);
    }

    .financial-summary-table .value {
      font-weight: 700;
      text-align: left;
    }

    .financial-summary-table .positive {
      color: var(--success);
    }

    .financial-summary-table .negative {
      color: var(--danger);
    }

    footer {
      padding: 16px;
      text-align: center;
      color: var(--muted);
      background: var(--light);
      margin-top: auto;
    }

    .tab-container {
      display: flex;
      border-bottom: 1px solid #e2e8f0;
      margin-bottom: 16px;
      overflow-x: auto;
    }

    .tab {
      padding: 10px 18px;
      cursor: pointer;
      border-bottom: 3px solid transparent;
      transition: var(--transition);
      white-space: nowrap;
      font-size: 14px;
      font-weight: 600;
    }

    .tab:hover {
      color: var(--primary);
    }

    .tab.active {
      border-bottom-color: var(--primary);
      color: var(--primary);
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
      animation: fadeIn 0.5s ease;
    }

    .employee-card, .account-card {
      background: #f8fafc;
      padding: 16px;
      border-radius: 10px;
      margin-bottom: 12px;
      border-left: 4px solid var(--primary);
      transition: var(--transition);
    }

    .employee-card:hover, .account-card:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow);
    }

    .report-card {
      background: #f0f9ff;
      padding: 16px;
      border-radius: 10px;
      margin-bottom: 12px;
      border-left: 4px solid var(--success);
      transition: var(--transition);
    }

    .report-card:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow);
    }

    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid #f3f3f3;
      border-top: 3px solid var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
    }

    .form-group {
      margin-bottom: 16px;
    }

    .form-group label {
      display: block;
      margin-bottom: 6px;
      font-weight: 600;
      font-size: 14px;
    }

    .form-group input, .form-group select, .form-group textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      font-size: 14px;
      transition: var(--transition);
    }

    .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
    }

    .truck-distribution {
      margin-top: 16px;
      padding: 16px;
      background: #f8fafc;
      border-radius: 8px;
    }

    .truck-item {
      padding: 12px;
      margin-bottom: 10px;
      background: #fff;
      border-radius: 8px;
      border: 1px solid #e2e8f0;
      transition: var(--transition);
    }

    .truck-item:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow);
    }

    .btn.active {
      background: var(--success);
      color: #fff;
      transform: scale(0.98);
      box-shadow: 0 2px 8px rgba(76, 201, 240, 0.3);
    }

    .driver-card .status-badge {
      padding: 6px 10px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 600;
      margin-left: 8px;
    }

    .status-pending {
      background: #fef3c7;
      color: #d97706;
    }

    .status-accepted {
      background: #d1fae5;
      color: #065f46;
    }

    .status-started {
      background: #dbeafe;
      color: #1e40af;
    }

    .status-delivered {
      background: #f3e8ff;
      color: #7c3aed;
    }

    .status-confirmed {
      background: #dcfce7;
      color: #166534;
    }

    .error-message {
      color: var(--danger);
      font-size: 12px;
      margin-top: 6px;
      display: none;
    }

    .input-error {
      border-color: var(--danger) !important;
    }

    .input-error:focus {
      box-shadow: 0 0 0 3px rgba(249, 65, 68, 0.1) !important;
    }

    .chart-container {
      position: relative;
      height: 300px;
      margin: 20px 0;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 16px;
      margin-bottom: 20px;
    }

    .stat-card {
      background: var(--card);
      border-radius: var(--radius);
      padding: 16px;
      box-shadow: var(--shadow);
      text-align: center;
      transition: var(--transition);
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
    }

    .stat-card .value {
      font-size: 28px;
      font-weight: 800;
      margin: 10px 0;
    }

    .stat-card.primary {
      border-top: 4px solid var(--primary);
    }

    .stat-card.success {
      border-top: 4px solid var(--success);
    }

    .stat-card.warning {
      border-top: 4px solid var(--warning);
    }

    .stat-card.danger {
      border-top: 4px solid var(--danger);
    }

    .ledger-entry {
      padding: 12px;
      border-bottom: 1px solid #f1f5f9;
      transition: var(--transition);
    }

    .ledger-entry:hover {
      background: #f8fafc;
    }

    .ledger-entry.credit {
      border-right: 4px solid var(--success);
    }

    .ledger-entry.debit {
      border-right: 4px solid var(--danger);
    }

    .permission-badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 600;
      margin-left: 6px;
    }

    .permission-admin {
      background: var(--gradient-danger);
      color: white;
    }

    .permission-supervisor {
      background: var(--gradient-warning);
      color: white;
    }

    .permission-driver {
      background: var(--gradient-info);
      color: white;
    }

    .permission-finance {
      background: var(--gradient-success);
      color: white;
    }

    .attendance-status {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-left: 8px;
    }

    .attendance-present {
      background: var(--success);
    }

    .attendance-absent {
      background: var(--danger);
    }

    .attendance-late {
      background: var(--warning);
    }

    @media (max-width: 1200px) {
      main {
        grid-template-columns: 300px 1fr;
      }
    }

    @media (max-width: 900px) {
      main {
        grid-template-columns: 1fr;
        padding: 16px;
      }

      .role-switch {
        overflow: auto;
        justify-content: center;
      }

      .role-btn {
        font-size: 11px;
        padding: 6px 10px;
      }
    }

    @media (max-width: 768px) {
      .dialog {
        max-width: 95vw;
        max-height: 90vh;
      }

      .dialog .body {
        max-height: calc(90vh - 80px);
        padding: 12px;
      }

      .deal-color-bar {
        height: 6px;
      }

      .financial-summary {
        padding: 12px;
        font-size: 14px;
      }

      .kpis {
        grid-template-columns: 1fr 1fr;
      }

      .controls {
        justify-content: center;
      }

      .stats-grid {
        grid-template-columns: 1fr 1fr;
      }
    }

    @media (max-width: 480px) {
      .dialog {
        max-width: 98vw;
        max-height: 95vh;
      }

      .dialog .body {
        max-height: calc(95vh - 80px);
        padding: 10px;
      }

      table {
        font-size: 12px;
      }

      th, td {
        padding: 8px 6px;
      }

      .kpis {
        grid-template-columns: 1fr;
      }

      header {
        flex-direction: column;
        gap: 12px;
      }

      .brand {
        font-size: 18px;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="brand">
        <i>ğŸšš</i> Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ â€” Ù…Ø§Ù„ÙŠØ© ÙˆØªØ´ØºÙŠÙ„ÙŠØ©
      </div>
      <div class="role-switch" title="Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆØ± Ù„Ù„ØªØ¬Ø±Ø¨Ø©">
        <button class="role-btn" data-role="help">Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª</button>
        <button class="role-btn active" data-role="admin">Ù…Ø¯ÙŠØ± (Ù†Ø¸Ø§Ù… Ù…Ø±ÙƒØ²ÙŠ)</button>
        <button class="role-btn" data-role="driver">ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ø§Ø¦Ù‚</button>
        <button class="role-btn" data-role="client">ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ù…ÙŠÙ„</button>
        <button class="role-btn" data-role="agent">ØªØ·Ø¨ÙŠÙ‚ Ù…Ù†Ø¯ÙˆØ¨ Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡</button>
        <button class="role-btn" data-role="hr">Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ©</button>
        <button class="role-btn" data-role="accountant">Ù…Ø­Ø§Ø³Ø¨</button>
        <button class="role-btn" data-role="reports">ØªÙ‚Ø§Ø±ÙŠØ±</button>
        <button class="role-btn" data-role="accounting">Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ø¨Ø§Ù„Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬</button>
      </div>
    </header>

    <main>
      <aside>
        <div class="panel">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div><strong>Ø§Ø®ØªØµØ§Ø±Ø§Øª</strong><div class="muted">Ù…Ø­Ø§ÙƒØ§Ø© Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</div></div>
            <div class="controls">
              <button class="btn ghost" onclick="loadSample()">Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©</button>
              <button class="btn danger" onclick="clearAllData()">Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
              <button class="btn success" onclick="exportData()">ØªØµØ¯ÙŠØ±</button>
            </div>
          </div>
        </div>

        <div class="panel">
          <div><strong>Ù…Ø¤Ø´Ø±Ø§Øª Ø³Ø±ÙŠØ¹Ø©</strong></div>
          <div class="kpis" style="margin-top:12px">
            <div class="kpi"><div class="muted">Ø§Ù„ØµÙÙ‚Ø§Øª</div><div class="val" id="k_deals">0</div></div>
            <div class="kpi"><div class="muted">Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª</div><div class="val" id="k_trucks">0</div></div>
            <div class="kpi"><div class="muted">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</div><div class="val" id="k_revenue">0 Ø±.ÙŠ</div></div>
          </div>
        </div>

        <div class="panel">
          <div><strong>Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·</strong></div>
          <div class="list" id="activityLog"></div>
        </div>
      </aside>

      <section>
        <!-- Admin view -->
        <div id="view_admin" class="view active">
          <div class="panel">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div><strong>Ù„ÙˆØ­Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ</strong><div class="muted">ØªØ­ÙƒÙ… ÙˆÙ…Ø±Ø§Ù‚Ø¨Ø© ÙƒØ§Ù…Ù„ Ù„Ù„Ø¹Ù…Ù„ÙŠØ©</div></div>
              <div>
                <button class="btn ghost" onclick="renderAdminList()">ØªØ­Ø¯ÙŠØ«</button>
                <button class="btn primary" onclick="openCreateDealModal()">Ø¥Ù†Ø´Ø§Ø¡ ØµÙÙ‚Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
              </div>
            </div>

            <div style="margin-top:16px"><div class="timeline" id="systemTimeline"></div></div>

            <div id="adminList" style="margin-top:16px"></div>
          </div>

          <div class="panel" style="margin-top:16px">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div><strong>ÙÙˆØ§ØªÙŠØ± ÙˆØ¯ÙØ¹Ø§Øª</strong></div>
              <div><button class="btn primary" onclick="renderInvoices()">Ø¹Ø±Ø¶ Ø§Ù„ÙÙˆØ§ØªÙŠØ±</button></div>
            </div>
            <div id="invoicesPanel" style="margin-top:12px"></div>
          </div>
        </div>

        <!-- Driver view -->
        <div id="view_driver" class="view">
          <div class="panel">
            <div><strong>ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ø§Ø¦Ù‚ â€” Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ù‡Ø§Ù…</strong><div class="muted">Ø§Ø³ØªÙ„Ù… Ù…Ù‡Ø§Ù…ÙƒØŒ ÙˆØ§ÙÙ‚ØŒ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø±Ø­Ù„Ø©ØŒ Ø£ÙƒØ¯ Ø§Ù„ØªÙØ±ÙŠØº (POD)ØŒ ÙˆØ³Ø¬Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div></div>
            <div id="driverTasks" style="margin-top:16px"></div>
          </div>

          <div class="panel" style="margin-top:16px">
            <div><strong>Ø³Ø¬Ù„ Ù…Ù‡Ø§Ù…Ùƒ</strong></div>
            <div id="driverHistory" class="list"></div>
          </div>
        </div>

        <!-- Client view -->
        <div id="view_client" class="view">
          <div class="panel">
            <div><strong>ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ù…ÙŠÙ„</strong><div class="muted">Ø§Ø³ØªØ¹Ø±Ø¶ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„ØªØ³Ù„ÙŠÙ… ÙˆØ£ÙƒØ¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</div></div>
            <div id="clientNotifications" style="margin-top:16px"></div>
          </div>

          <div class="panel" style="margin-top:16px">
            <div><strong>ØªØ³Ù„ÙŠÙ…Ø§ØªÙŠ</strong></div>
            <div id="clientHistory" class="list"></div>
          </div>
        </div>

        <!-- Agent view -->
        <div id="view_agent" class="view">
          <div class="panel">
            <div><strong>ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠ</strong><div class="muted">ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„/Ø§Ù„ØªÙØ±ÙŠØº Ù…Ù† Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡ Ø£Ùˆ Ø§Ù„Ù…ÙˆÙ‚Ø¹</div></div>
            <div id="agentTasks" style="margin-top:16px"></div>
          </div>

          <div class="panel" style="margin-top:16px">
            <div><strong>ØªØ³Ø¬ÙŠÙ„Ø§Øª Ù…ÙŠØ¯Ø§Ù†ÙŠØ©</strong></div>
            <div id="agentHistory" class="list"></div>
          </div>
        </div>

        <!-- HR view -->
        <div id="view_hr" class="view">
          <div class="panel">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div><strong>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</strong><div class="muted">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†ØŒ Ø§Ù„Ø±ÙˆØ§ØªØ¨ØŒ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§ØªØŒ ÙˆØ§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</div></div>
              <div>
                <button class="btn ghost" onclick="renderHRDashboard()">ØªØ­Ø¯ÙŠØ«</button>
                <button class="btn primary" onclick="openAddEmployeeModal()">Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù</button>
              </div>
            </div>
            
            <div class="tab-container">
              <div class="tab active" data-tab="employees">Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</div>
              <div class="tab" data-tab="salaries">Ø§Ù„Ø±ÙˆØ§ØªØ¨</div>
              <div class="tab" data-tab="leaves">Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª</div>
              <div class="tab" data-tab="evaluations">Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</div>
              <div class="tab" data-tab="attendance">Ø§Ù„Ø­Ø¶ÙˆØ±</div>
            </div>
            
            <div id="hrContent">
              <div id="tab-employees" class="tab-content active"></div>
              <div id="tab-salaries" class="tab-content"></div>
              <div id="tab-leaves" class="tab-content"></div>
              <div id="tab-evaluations" class="tab-content"></div>
              <div id="tab-attendance" class="tab-content"></div>
            </div>
          </div>
        </div>

        <!-- Accountant view -->
        <div id="view_accountant" class="view">
          <div class="panel">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div><strong>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª ÙˆØ§Ù„Ù…Ø§Ù„ÙŠØ©</strong><div class="muted">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©ØŒ Ø§Ù„Ù…ØµØ±ÙˆÙØ§ØªØŒ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§ØªØŒ ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©</div></div>
              <div>
                <button class="btn ghost" onclick="renderAccountantDashboard()">ØªØ­Ø¯ÙŠØ«</button>
                <button class="btn primary" onclick="openAddTransactionModal()">Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù…Ù„Ø©</button>
              </div>
            </div>
            
            <div class="tab-container">
              <div class="tab active" data-tab="overview">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©</div>
              <div class="tab" data-tab="transactions">Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª</div>
              <div class="tab" data-tab="ledger">Ø¯ÙØªØ± Ø§Ù„Ø£Ø³ØªØ§Ø°</div>
              <div class="tab" data-tab="budget">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</div>
              <div class="tab" data-tab="taxes">Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨</div>
            </div>
            
            <div id="accountantContent">
              <div id="tab-overview" class="tab-content active"></div>
              <div id="tab-transactions" class="tab-content"></div>
              <div id="tab-ledger" class="tab-content"></div>
              <div id="tab-budget" class="tab-content"></div>
              <div id="tab-taxes" class="tab-content"></div>
            </div>
          </div>
        </div>

        <!-- Reports view -->
        <div id="view_reports" class="view">
          <div class="panel">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div><strong>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</strong><div class="muted">ØªÙ‚Ø§Ø±ÙŠØ± Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø´Ø±ÙƒØ©ØŒ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§ØªØŒ ÙˆØ§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div></div>
              <div>
                <button class="btn ghost" onclick="renderReportsDashboard()">ØªØ­Ø¯ÙŠØ«</button>
                <button class="btn primary" onclick="generateCustomReport()">ØªÙ‚Ø±ÙŠØ± Ù…Ø®ØµØµ</button>
              </div>
            </div>
            
            <div class="tab-container">
              <div class="tab active" data-tab="financial">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©</div>
              <div class="tab" data-tab="operational">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©</div>
              <div class="tab" data-tab="hr">ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</div>
              <div class="tab" data-tab="custom">ØªÙ‚Ø§Ø±ÙŠØ± Ù…Ø®ØµØµØ©</div>
            </div>
            
            <div id="reportsContent">
              <div id="tab-financial" class="tab-content active"></div>
              <div id="tab-operational" class="tab-content"></div>
              <div id="tab-hr" class="tab-content"></div>
              <div id="tab-custom" class="tab-content"></div>
            </div>
          </div>
        </div>

        <!-- Accounting view -->
        <div id="view_accounting" class="view">
          <div class="panel">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div><strong>Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ø¨Ø§Ù„Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬</strong><div class="muted">Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§ØªØŒ Ù‚ÙŠÙˆØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©ØŒ Ù…ÙŠØ²Ø§Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©ØŒ ÙˆØªØ³ÙˆÙŠØ© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</div></div>
              <div>
                <button class="btn ghost" onclick="renderAccountingDashboard()">ØªØ­Ø¯ÙŠØ«</button>
                <button class="btn primary" onclick="uiCreateAccount()">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</button>
              </div>
            </div>
            
            <div class="tab-container">
              <div class="tab active" data-tab="dashboard">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</div>
              <div class="tab" data-tab="accounts">Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</div>
              <div class="tab" data-tab="journal">Ù‚ÙŠÙˆØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</div>
              <div class="tab" data-tab="ledger">Ø¯ÙØªØ± Ø§Ù„Ø£Ø³ØªØ§Ø°</div>
              <div class="tab" data-tab="trial">Ù…ÙŠØ²Ø§Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</div>
              <div class="tab" data-tab="reconcile">ØªØ³ÙˆÙŠØ© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</div>
            </div>
            
            <div id="accountingContent">
              <div id="tab-dashboard" class="tab-content active"></div>
              <div id="tab-accounts" class="tab-content"></div>
              <div id="tab-journal" class="tab-content"></div>
              <div id="tab-ledger" class="tab-content"></div>
              <div id="tab-trial" class="tab-content"></div>
              <div id="tab-reconcile" class="tab-content"></div>
            </div>
          </div>
        </div>

        <!-- Help view -->
        <div id="view_help" class="view">
          <div class="panel">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div><strong>Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… - Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ - ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ø­ØªÙŠØ§Ø¬ Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ 781110333</strong><div class="muted">Ø¯Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ø¸Ø§Ù… - Ø§Ù„Ø¥ØµØ¯Ø§Ø± 2.0</div></div>
              <div>
                <button class="btn ghost" onclick="printHelp()">Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø¯Ù„ÙŠÙ„</button>
              </div>
            </div>

            <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª -->
            <div id="helpContent" style="margin-top:20px">
              <!-- Ø³ÙŠØªÙ… Ø¥Ø¯Ø±Ø§Ø¬ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ù‡Ù†Ø§ -->
            </div>
          </div>
        </div>
      </section>
    </main>

    <div class="notification" id="notificationsArea"></div>
    <div class="modal" id="modal">
      <div class="dialog">
        <div class="head">
          <div id="modalTitle">ØªÙØ§ØµÙŠÙ„</div>
          <button class="btn" onclick="closeModal()">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
        <div class="body" id="modalBody"></div>
      </div>
    </div>

    <!-- Ø²Ø± Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ© -->
    <div style="position: fixed; bottom: 20px; left: 20px; z-index: 1000;">
      <button class="btn danger" onclick="fixSampleData()" style="background: #e74c3c; color: white; padding: 10px 15px; border-radius: 8px; border: none; cursor: pointer; font-weight: bold;">
        Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©
      </button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
  <script>
    // ======================= Ø¯ÙˆØ§Ù„ ØµÙØ­Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª =======================
    function renderHelpContent() {
      const container = document.getElementById('helpContent');
      if (!container) return;
      
      container.innerHTML = `
        <div class="help-nav-tabs">
          <button class="help-nav-tab active" data-help-target="help-overview">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©</button>
          <button class="help-nav-tab" data-help-target="help-getting-started">Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</button>
          <button class="help-nav-tab" data-help-target="help-features">Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
          <button class="help-nav-tab" data-help-target="help-roles">Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</button>
          <button class="help-nav-tab" data-help-target="help-financial">Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø§Ù„ÙŠ</button>
          <button class="help-nav-tab" data-help-target="help-faq">Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©</button>
        </div>

        <!-- Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© -->
        <section id="help-overview" class="help-content-section active">
          <h2 class="help-section-title">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
          <p>Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ Ù‡Ùˆ Ù…Ù†ØµØ© Ø´Ø§Ù…Ù„Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ø¨Ø±ÙŠØŒ ØªÙ… ØªØµÙ…ÙŠÙ…Ù‡ Ù„ØªØ¨Ø³ÙŠØ· ÙˆØ¥Ø¯Ø§Ø±Ø© Ø¬Ù…ÙŠØ¹ Ø¬ÙˆØ§Ù†Ø¨ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù†Ù‚Ù„ Ù…Ù† Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙÙ‚Ø§Øª Ø¥Ù„Ù‰ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙÙˆØ§ØªÙŠØ± ÙˆØ§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©.</p>
          
          <div class="help-info-box">
            <strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> Ù‡Ø°Ø§ Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¯Ø¹Ù… Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¨Ø´ÙƒÙ„ ÙƒØ§Ù…Ù„ ÙˆØªÙ… ØªØµÙ…ÙŠÙ…Ù‡ Ø®ØµÙŠØµÙ‹Ø§ Ù„ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø³ÙˆÙ‚ Ø§Ù„Ù†Ù‚Ù„ ÙÙŠ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©.
          </div>
          
          <h3 class="help-subsection-title">Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„Ù†Ø¸Ø§Ù…</h3>
          <div class="help-feature-card">
            <div class="help-feature-icon">ğŸ“Š</div>
            <h3>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ©</h3>
            <p>ÙˆØ§Ø¬Ù‡Ø© Ù…ÙˆØ­Ø¯Ø© ØªØªÙŠØ­ Ù„Ù„Ù…Ø¯ÙŠØ±ÙŠÙ† Ù…Ø±Ø§Ù‚Ø¨Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ø¹ Ù…Ø¤Ø´Ø±Ø§Øª Ø£Ø¯Ø§Ø¡ Ø±Ø¦ÙŠØ³ÙŠØ©.</p>
          </div>
          
          <div class="help-feature-card">
            <div class="help-feature-icon">ğŸš›</div>
            <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙÙ‚Ø§Øª ÙˆØ§Ù„Ø´Ø­Ù†Ø§Øª</h3>
            <p>Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙÙ‚Ø§Øª Ù…Ø¹ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª Ø¨Ø´ÙƒÙ„ Ø£Ù…Ø«Ù„ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ§Øª Ù…ØªÙ‚Ø¯Ù…Ø©.</p>
          </div>
          
          <div class="help-feature-card">
            <div class="help-feature-icon">ğŸ’¼</div>
            <h3>Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø§Ù„ÙŠ ÙˆØ§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠ</h3>
            <p>Ù†Ø¸Ø§Ù… Ù…Ø­Ø§Ø³Ø¨Ø© Ù…ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬ØŒ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙÙˆØ§ØªÙŠØ±ØŒ ÙˆØ§Ù„Ù…ØµØ±ÙˆÙØ§ØªØŒ ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©.</p>
          </div>
          
          <div class="help-feature-card">
            <div class="help-feature-icon">ğŸ‘¥</div>
            <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</h3>
            <p>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†ØŒ Ø§Ù„Ø±ÙˆØ§ØªØ¨ØŒ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§ØªØŒ ÙˆØ§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª ÙÙŠ Ù…Ù†ØµØ© ÙˆØ§Ø­Ø¯Ø©.</p>
          </div>
        </section>

        <!-- Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… -->
        <section id="help-getting-started" class="help-content-section">
          <h2 class="help-section-title">Ø¨Ø¯Ø¡ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
          <p>Ø§ØªØ¨Ø¹ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø¨Ø³ÙŠØ·Ø© Ù„Ø¨Ø¯Ø¡ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø´ÙƒÙ„ ÙØ¹Ø§Ù„:</p>
          
          <div class="help-step">
            <h3><span class="help-step-number">1</span> ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©</h3>
            <p>Ù„Ø¨Ø¯Ø¡ ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù†Ø¸Ø§Ù…ØŒ Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± <strong>"Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©"</strong> ÙÙŠ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ. Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ø§Ù„ØªÙŠ ØªØªÙŠØ­ Ù„Ùƒ Ø§Ø³ØªÙƒØ´Ø§Ù Ø¬Ù…ÙŠØ¹ Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù….</p>
            <div class="help-tip-box">
              <strong>Ù†ØµÙŠØ­Ø©:</strong> Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù… Ù‚Ø¨Ù„ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„ÙØ¹Ù„ÙŠØ©.
            </div>
          </div>
          
          <div class="help-step">
            <h3><span class="help-step-number">2</span> Ø¥Ù†Ø´Ø§Ø¡ ØµÙÙ‚Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
            <p>Ù„Ø¥Ù†Ø´Ø§Ø¡ ØµÙÙ‚Ø© Ø¬Ø¯ÙŠØ¯Ø©ØŒ Ø§ØªØ¨Ø¹ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:</p>
            <ol>
              <li>Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ± (Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ)</li>
              <li>Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± <strong>"Ø¥Ù†Ø´Ø§Ø¡ ØµÙÙ‚Ø© Ø¬Ø¯ÙŠØ¯Ø©"</strong></li>
              <li>Ø§Ù…Ù„Ø£ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØµÙÙ‚Ø© (Ø±Ù‚Ù… Ø§Ù„ØµÙÙ‚Ø©ØŒ Ø§Ø³Ù… Ø§Ù„Ø³ÙÙŠÙ†Ø©ØŒ Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ø¹Ù…ÙŠÙ„Ø©ØŒ Ø§Ù„ÙˆØ¬Ù‡Ø©ØŒ Ø¥Ù„Ø®)</li>
              <li>Ø­Ø¯Ø¯ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ù…ÙˆÙ„Ø© ÙˆØ³Ø¹Ø± Ø§Ù„Ø·Ù†</li>
              <li>Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ <strong>"Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØªÙˆØ²ÙŠØ¹"</strong> Ù„Ø±Ø¤ÙŠØ© ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­</li>
              <li>Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ <strong>"Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙÙ‚Ø©"</strong> Ù„Ø­ÙØ¸ Ø§Ù„ØµÙÙ‚Ø©</li>
            </ol>
          </div>
          
          <div class="help-step">
            <h3><span class="help-step-number">3</span> ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª ÙˆØ§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†</h3>
            <p>Ø¨Ø¹Ø¯ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙÙ‚Ø©ØŒ ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª ÙˆØ§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†:</p>
            <ol>
              <li>Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØµÙÙ‚Ø§ØªØŒ Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± <strong>"ØªØ¹ÙŠÙŠÙ† Ù‚Ø§Ø·Ø±Ø§Øª"</strong></li>
              <li>Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚Ø§Ø·Ø±Ø© (Ø±Ù‚Ù… Ø§Ù„Ù‚Ø§Ø·Ø±Ø©ØŒ Ø§Ø³Ù… Ø§Ù„Ø³Ø§Ø¦Ù‚ØŒ Ø§Ù„Ø­Ù…ÙˆÙ„Ø©ØŒ Ø§Ù„Ø¥ÙŠØ¬Ø§Ø±)</li>
              <li>Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ <strong>"Ø¥Ø¶Ø§ÙØ© Ù‚Ø§Ø·Ø±Ø©"</strong></li>
              <li>ÙƒØ±Ø± Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù„Ø¥Ø¶Ø§ÙØ© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</li>
            </ol>
            <div class="help-tip-box">
              <strong>Ù†ØµÙŠØ­Ø©:</strong> Ø§Ù„Ù†Ø¸Ø§Ù… Ø³ÙŠÙ‚ÙˆÙ… ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¨Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø£Ù…Ø«Ù„ Ù„Ù„Ø­Ù…ÙˆÙ„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø³Ø¹ØªÙ‡Ø§ Ø§Ù„Ù‚ØµÙˆÙ‰.
            </div>
          </div>
          
          <div class="help-step">
            <h3><span class="help-step-number">4</span> Ù…ØªØ§Ø¨Ø¹Ø© ØªÙ‚Ø¯Ù… Ø§Ù„ØµÙÙ‚Ø©</h3>
            <p>ÙŠÙ…ÙƒÙ†Ùƒ Ù…ØªØ§Ø¨Ø¹Ø© ØªÙ‚Ø¯Ù… Ø§Ù„ØµÙÙ‚Ø© Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ø®Ø· Ø§Ù„Ø²Ù…Ù†ÙŠ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ±:</p>
            <ul>
              <li><strong>Ø§Ù„ÙˆØµÙˆÙ„:</strong> ÙˆØµÙˆÙ„ Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡</li>
              <li><strong>ØªØ­Ù…ÙŠÙ„/ØªÙØ±ÙŠØº:</strong> Ø¹Ù…Ù„ÙŠØ© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª</li>
              <li><strong>Ù†Ù‚Ù„:</strong> Ø¨Ø¯Ø¡ Ø±Ø­Ù„Ø© Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª</li>
              <li><strong>ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…ÙŠÙ„:</strong> ØªØ£ÙƒÙŠØ¯ Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø© Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¹Ù…ÙŠÙ„</li>
              <li><strong>Ø§Ù„ÙÙˆØªØ±Ø©/Ø§Ù„Ø¥Ù‚ÙØ§Ù„:</strong> Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙÙˆØ§ØªÙŠØ± ÙˆØ¥Ù‚ÙØ§Ù„ Ø§Ù„ØµÙÙ‚Ø©</li>
            </ul>
          </div>
        </section>

        <!-- Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
        <section id="help-features" class="help-content-section">
          <h2 class="help-section-title">Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„Ù†Ø¸Ø§Ù…</h2>
          
          <h3 class="help-subsection-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙÙ‚Ø§Øª</h3>
          <div class="help-feature-card">
            <h4>Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙÙ‚Ø§Øª</h4>
            <p>Ø¥Ù†Ø´Ø§Ø¡ ØµÙÙ‚Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ØŒ Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø©ØŒ Ø§Ù„ÙˆØ¬Ù‡Ø©ØŒ ÙˆØ§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©.</p>
          </div>
          
          <div class="help-feature-card">
            <h4>ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª</h4>
            <p>ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø­Ù…ÙˆÙ„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª Ø¨Ø´ÙƒÙ„ Ø£Ù…Ø«Ù„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ§Øª Ù…ØªÙ‚Ø¯Ù…Ø© ØªØ£Ø®Ø° ÙÙŠ Ø§Ù„Ø§Ø¹ØªØ¨Ø§Ø± Ø§Ù„Ø³Ø¹Ø© Ø§Ù„Ù‚ØµÙˆÙ‰ Ù„Ù„Ù‚Ø§Ø·Ø±Ø§Øª.</p>
          </div>
          
          <div class="help-feature-card">
            <h4>Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø­Ø§Ù„Ø©</h4>
            <p>Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø§Ù„Ø© ÙƒÙ„ Ù‚Ø§Ø·Ø±Ø© ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¥Ù„Ù‰ Ø§Ù„ØªØ³Ù„ÙŠÙ… ÙˆØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…ÙŠÙ„.</p>
          </div>
          
          <h3 class="help-subsection-title">Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø§Ù„ÙŠ</h3>
          <div class="help-feature-card">
            <h4>Ø§Ù„Ø®Ù„Ø§ØµØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ©</h4>
            <p>Ø¹Ø±Ø¶ Ø®Ù„Ø§ØµØ© Ù…Ø§Ù„ÙŠØ© Ù…ÙØµÙ„Ø© Ù„ÙƒÙ„ ØµÙÙ‚Ø© ØªØ´Ù…Ù„ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª ÙˆØ§Ù„Ù…ØµØ±ÙˆÙØ§Øª ÙˆØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹.</p>
          </div>
          
          <div class="help-feature-card">
            <h4>Ø¥ØµØ¯Ø§Ø± Ø§Ù„ÙÙˆØ§ØªÙŠØ±</h4>
            <p>Ø¥Ù†Ø´Ø§Ø¡ ÙÙˆØ§ØªÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØµÙÙ‚Ø§Øª Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø© Ù…Ø¹ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© ØªØªØ¨Ø¹ Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹.</p>
          </div>
          
          <div class="help-feature-card">
            <h4>Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ø¨Ø§Ù„Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬</h4>
            <p>Ù†Ø¸Ø§Ù… Ù…Ø­Ø§Ø³Ø¨Ø© Ù…ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬ ÙŠØ¶Ù…Ù† Ø¯Ù‚Ø© Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØ¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ØªØªØ¨Ø¹.</p>
          </div>
          
          <h3 class="help-subsection-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</h3>
          <div class="help-feature-card">
            <h4>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</h4>
            <p>ØªØ³Ø¬ÙŠÙ„ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ø¹ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª.</p>
          </div>
          
          <div class="help-feature-card">
            <h4>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ÙˆØ§ØªØ¨</h4>
            <p>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø±ÙˆØ§ØªØ¨ ÙˆØ§Ù„Ù…ÙƒØ§ÙØ¢Øª Ù…Ø¹ ØªÙƒØ§Ù…Ù„Ù‡Ø§ Ù…Ø¹ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø§Ù„ÙŠ.</p>
          </div>
          
          <div class="help-feature-card">
            <h4>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±</h4>
            <p>Ù†Ø¸Ø§Ù… Ù…ØªÙƒØ§Ù…Ù„ Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø§Ù†ØµØ±Ø§Ù Ù…Ø¹ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ.</p>
          </div>
          
          <h3 class="help-subsection-title">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h3>
          <div class="help-feature-card">
            <h4>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©</h4>
            <p>ØªÙ‚Ø§Ø±ÙŠØ± Ø´Ø§Ù…Ù„Ø© Ø¹Ù† Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª ÙˆØ§Ù„Ù…ØµØ±ÙˆÙØ§Øª ÙˆØ§Ù„Ø£Ø±Ø¨Ø§Ø­ ÙˆØ§Ù„Ø®Ø³Ø§Ø¦Ø±.</p>
          </div>
          
          <div class="help-feature-card">
            <h4>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©</h4>
            <p>ØªÙ‚Ø§Ø±ÙŠØ± Ø¹Ù† Ø£Ø¯Ø§Ø¡ Ø§Ù„ØµÙÙ‚Ø§ØªØŒ Ù…Ø¹Ø¯Ù„Ø§Øª Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²ØŒ ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª.</p>
          </div>
          
          <div class="help-feature-card">
            <h4>ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</h4>
            <p>ØªÙ‚Ø§Ø±ÙŠØ± Ø¹Ù† Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†ØŒ Ù…Ø¹Ø¯Ù„Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ±ØŒ ÙˆØªÙƒØ§Ù„ÙŠÙ Ø§Ù„Ø±ÙˆØ§ØªØ¨.</p>
          </div>
        </section>

        <!-- Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† -->
        <section id="help-roles" class="help-content-section">
          <h2 class="help-section-title">Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
          <p>ÙŠØ¯Ø¹Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¹Ø¯Ø© Ø£Ø¯ÙˆØ§Ø± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†ØŒ ÙƒÙ„ Ø¯ÙˆØ± Ù„Ù‡ ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆÙˆØ¸Ø§Ø¦Ù Ù…Ø­Ø¯Ø¯Ø©:</p>
          
          <div class="help-role-section">
            <h3 class="help-subsection-title">ğŸ‘¨â€ğŸ’¼ Ø§Ù„Ù…Ø¯ÙŠØ± (Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ)</h3>
            <div class="help-role-card">
              <h4>Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:</h4>
              <ul>
                <li>Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙƒØ§Ù…Ù„ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆØ¥Ø¹Ø¯Ø§Ø¯Ø§ØªÙ‡</li>
                <li>Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙÙ‚Ø§Øª</li>
                <li>ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª ÙˆØ§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†</li>
                <li>Ù…Ø±Ø§Ù‚Ø¨Ø© ØªÙ‚Ø¯Ù… Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙÙ‚Ø§Øª</li>
                <li>Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</li>
                <li>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª</li>
              </ul>
            </div>
          </div>
          
          <div class="help-role-section">
            <h3 class="help-subsection-title">ğŸš› Ø§Ù„Ø³Ø§Ø¦Ù‚</h3>
            <div class="help-role-card">
              <h4>Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:</h4>
              <ul>
                <li>Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ÙˆÙƒÙ„Ø© Ø¥Ù„ÙŠÙ‡</li>
                <li>Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù‡Ø§Ù…</li>
                <li>Ø¨Ø¯Ø¡ Ø§Ù„Ø±Ø­Ù„Ø©</li>
                <li>Ø±ÙØ¹ Ø¥Ø«Ø¨Ø§Øª Ø§Ù„ØªØ³Ù„ÙŠÙ… (POD)</li>
                <li>Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</li>
              </ul>
            </div>
          </div>
          
          <div class="help-role-section">
            <h3 class="help-subsection-title">ğŸ‘¤ Ø§Ù„Ø¹Ù…ÙŠÙ„</h3>
            <div class="help-role-card">
              <h4>Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:</h4>
              <ul>
                <li>Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„ØªØ³Ù„ÙŠÙ…</li>
                <li>ØªØ£ÙƒÙŠØ¯ Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø©</li>
                <li>Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„ØªØ³Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</li>
                <li>Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ø´Ø­Ù†Ø§Øª</li>
              </ul>
            </div>
          </div>
          
          <div class="help-role-section">
            <h3 class="help-subsection-title">ğŸ‘¨â€ğŸ’¼ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠ</h3>
            <div class="help-role-card">
              <h4>Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:</h4>
              <ul>
                <li>ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙˆØ§Ù„ØªÙØ±ÙŠØº</li>
                <li>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠØ©</li>
                <li>Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ† ÙˆØ§Ù„Ø¹Ù…Ù„Ø§Ø¡</li>
              </ul>
            </div>
          </div>
          
          <div class="help-role-section">
            <h3 class="help-subsection-title">ğŸ‘¥ Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ©</h3>
            <div class="help-role-card">
              <h4>Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:</h4>
              <ul>
                <li>Ø¥Ø¯Ø§Ø±Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</li>
                <li>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø±ÙˆØ§ØªØ¨ ÙˆØ§Ù„Ù…ÙƒØ§ÙØ¢Øª</li>
                <li>Ø¥Ø¯Ø§Ø±Ø© Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª</li>
                <li>ØªØ³Ø¬ÙŠÙ„ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡</li>
                <li>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø§Ù†ØµØ±Ø§Ù</li>
              </ul>
            </div>
          </div>
          
          <div class="help-role-section">
            <h3 class="help-subsection-title">ğŸ’° Ù…Ø­Ø§Ø³Ø¨</h3>
            <div class="help-role-card">
              <h4>Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:</h4>
              <ul>
                <li>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©</li>
                <li>Ø¥ØµØ¯Ø§Ø± Ø§Ù„ÙÙˆØ§ØªÙŠØ± ÙˆÙ…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø¯ÙØ¹Ø§Øª</li>
                <li>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© ÙˆØ§Ù„Ù…ØµØ±ÙˆÙØ§Øª</li>
                <li>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨</li>
                <li>Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©</li>
              </ul>
            </div>
          </div>
          
          <div class="help-info-box">
            <strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> ÙŠÙ…ÙƒÙ† ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ø¨Ø³Ù‡ÙˆÙ„Ø© Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ù„ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ù† ÙˆØ¬Ù‡Ø§Øª Ù†Ø¸Ø± Ù…Ø®ØªÙ„ÙØ©.
          </div>
        </section>

        <!-- Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø§Ù„ÙŠ -->
        <section id="help-financial" class="help-content-section">
          <h2 class="help-section-title">Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø§Ù„ÙŠ ÙˆØ§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠ</h2>
          <p>ÙŠØªÙ…ÙŠØ² Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø§Ù„ÙŠ ÙÙŠ Ù…Ù†ØµØ© Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ Ø¨Ø§Ù„Ø´Ù…ÙˆÙ„ÙŠØ© ÙˆØ§Ù„Ø¯Ù‚Ø©ØŒ Ù…Ø¹ Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ù…Ø¨Ø§Ø¯Ø¦ Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ø¨Ø§Ù„Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬.</p>
          
          <h3 class="help-subsection-title">Ø§Ù„Ø®Ù„Ø§ØµØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ù„Ù„ØµÙÙ‚Ø§Øª</h3>
          <p>ÙŠØ¹Ø±Ø¶ Ø§Ù„Ù†Ø¸Ø§Ù… Ø®Ù„Ø§ØµØ© Ù…Ø§Ù„ÙŠØ© Ù…ÙØµÙ„Ø© Ù„ÙƒÙ„ ØµÙÙ‚Ø© ØªØ´Ù…Ù„:</p>
          
          <div class="help-feature-card">
            <h4>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø© Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„</h4>
            <p>Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ù„ØµÙÙ‚Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ù…ÙˆÙ„Ø© ÙˆØ³Ø¹Ø± Ø§Ù„Ø·Ù†.</p>
          </div>
          
          <div class="help-feature-card">
            <h4>Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ø³Ù„Ù Ù„Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†</h4>
            <p>Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© ÙƒØ³Ù„Ù Ù„Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ† Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ù‡Ø§Ù….</p>
          </div>
          
          <div class="help-feature-card">
            <h4>Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ø¯ÙŠØ²Ù„ Ù„Ù„Ù‚Ø§Ø·Ø±Ø§Øª</h4>
            <p>ØªÙƒØ§Ù„ÙŠÙ Ø§Ù„ÙˆÙ‚ÙˆØ¯ Ø§Ù„Ù…Ø³Ø¬Ù„Ø© Ù„ÙƒÙ„ Ù‚Ø§Ø·Ø±Ø©.</p>
          </div>
          
          <div class="help-feature-card">
            <h4>Ø¥ÙŠØ±Ø§Ø¯ Ø§Ù„Ø´Ø±ÙƒØ© Ù…Ù† Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª</h4>
            <p>Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ© Ù„Ù„Ø´Ø±ÙƒØ© Ù…Ù† ÙƒÙ„ Ù‚Ø§Ø·Ø±Ø©.</p>
          </div>
          
          <div class="help-feature-card">
            <h4>Ø¥ÙŠØ¬Ø§Ø± Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª</h4>
            <p>ØªÙƒØ§Ù„ÙŠÙ Ø¥ÙŠØ¬Ø§Ø± Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø© Ù„Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ† (Ù…Ø¬Ù…ÙˆØ¹ Ø³Ø¹Ø± Ø§Ù„Ø·Ù† ÙÙŠ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø·Ù†Ø§Ù†).</p>
          </div>
          
          <div class="help-feature-card">
            <h4>ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹</h4>
            <p>Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ØµØ§ÙÙŠ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ Ù„Ù„Ø´Ø±ÙƒØ© Ø¨Ø¹Ø¯ Ø®ØµÙ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª.</p>
          </div>
          
          <h3 class="help-subsection-title">Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© ÙˆØ§Ù„ÙÙˆØªØ±Ø©</h3>
          <div class="help-step">
            <h3><span class="help-step-number">1</span> Ù…ØªØ§Ø¨Ø¹Ø© Ø¥ØªÙ…Ø§Ù… Ø§Ù„ØµÙÙ‚Ø©</h3>
            <p>ØªØ£ÙƒØ¯ Ù…Ù† Ø§ÙƒØªÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ù…Ø±Ø§Ø­Ù„ Ø§Ù„ØµÙÙ‚Ø©ØŒ Ø®Ø§ØµØ©:</p>
            <ul>
              <li>Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù‡Ø§Ù…</li>
              <li>Ø¨Ø¯Ø¡ Ø§Ù„Ø±Ø­Ù„Ø©</li>
              <li>Ø±ÙØ¹ Ø¥Ø«Ø¨Ø§Øª Ø§Ù„ØªØ³Ù„ÙŠÙ… (POD)</li>
              <li>ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù„Ù„Ø§Ø³ØªÙ„Ø§Ù…</li>
            </ul>
          </div>
          
          <div class="help-step">
            <h3><span class="help-step-number">2</span> Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø©</h3>
            <p>Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© Ù„Ù„ØµÙÙ‚Ø©:</p>
            <ol>
              <li>Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØµÙÙ‚Ø©</li>
              <li>Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± <strong>"Ù…Ø·Ø§Ø¨Ù‚Ø© ÙˆÙÙˆØªØ±Ø©"</strong></li>
              <li>Ø³ÙŠÙ‚ÙˆÙ… Ø§Ù„Ù†Ø¸Ø§Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¨Ø­Ø³Ø§Ø¨ Ù‚ÙŠÙ…Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø³Ù„Ù…Ø©</li>
              <li>Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø© ÙˆØªØ¸Ù‡Ø± ÙÙŠ Ù‚Ø³Ù… Ø§Ù„ÙÙˆØ§ØªÙŠØ±</li>
            </ol>
          </div>
          
          <div class="help-step">
            <h3><span class="help-step-number">3</span> Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø¯ÙØ¹Ø§Øª</h3>
            <p>Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø¯ÙØ¹Ø§Øª Ø§Ù„ÙÙˆØ§ØªÙŠØ±:</p>
            <ol>
              <li>Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ù‚Ø³Ù… "ÙÙˆØ§ØªÙŠØ± ÙˆØ¯ÙØ¹Ø§Øª"</li>
              <li>Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± <strong>"Ø¹Ø±Ø¶ Ø§Ù„ÙÙˆØ§ØªÙŠØ±"</strong></li>
              <li>Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± <strong>"ØªØ³Ø¬ÙŠÙ„ Ø¯ÙØ¹"</strong> Ø¨Ø¬Ø§Ù†Ø¨ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</li>
              <li>Ø£Ø¯Ø®Ù„ Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…Ø©</li>
              <li>Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§</li>
            </ol>
          </div>
          
          <div class="help-warning-box">
            <strong>ØªÙ†Ø¨ÙŠÙ‡:</strong> ØªØ£ÙƒØ¯ Ù…Ù† Ø§ÙƒØªÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ù…Ø±Ø§Ø­Ù„ Ø§Ù„ØµÙÙ‚Ø© Ù‚Ø¨Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ù„Ø¶Ù…Ø§Ù† Ø¯Ù‚Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª.
          </div>
          
          <h3 class="help-subsection-title">Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠ Ø¨Ø§Ù„Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬</h3>
          <p>ÙŠØ¯Ø¹Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ø¨Ø§Ù„Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬ Ù…Ø¹ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:</p>
          
          <div class="help-feature-card">
            <h4>Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</h4>
            <p>ØªØµÙ†ÙŠÙ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø¥Ù„Ù‰ Ø£ØµÙˆÙ„ØŒ Ø®ØµÙˆÙ…ØŒ Ø¥ÙŠØ±Ø§Ø¯Ø§ØªØŒ ÙˆÙ…ØµØ±ÙˆÙØ§Øª.</p>
          </div>
          
          <div class="help-feature-card">
            <h4>Ù‚ÙŠÙˆØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h4>
            <p>ØªØ³Ø¬ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙÙŠ Ù‚ÙŠÙˆØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ù…Ø¹ Ø§Ù„ØªÙˆØ§Ø²Ù† Ø¨ÙŠÙ† Ø§Ù„Ù…Ø¯ÙŠÙ† ÙˆØ§Ù„Ø¯Ø§Ø¦Ù†.</p>
          </div>
          
          <div class="help-feature-card">
            <h4>Ø¯ÙØªØ± Ø§Ù„Ø£Ø³ØªØ§Ø°</h4>
            <p>Ø¹Ø±Ø¶ Ø­Ø±ÙƒØ© ÙƒÙ„ Ø­Ø³Ø§Ø¨ Ø¨Ø´ÙƒÙ„ Ù…Ù†ÙØµÙ„ ÙÙŠ Ø¯ÙØªØ± Ø§Ù„Ø£Ø³ØªØ§Ø°.</p>
          </div>
          
          <div class="help-feature-card">
            <h4>Ù…ÙŠØ²Ø§Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</h4>
            <p>ØªÙ‚Ø±ÙŠØ± ÙŠØ¶Ù…Ù† ØªÙˆØ§Ø²Ù† Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª ÙˆØ®Ù„ÙˆÙ‡Ø§ Ù…Ù† Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠØ©.</p>
          </div>
          
          <div class="help-feature-card">
            <h4>ØªØ³ÙˆÙŠØ© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</h4>
            <p>Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„ÙÙˆØ§ØªÙŠØ± ÙˆØ§Ù„Ø¯ÙØ¹Ø§Øª Ù„Ø¶Ù…Ø§Ù† Ø¯Ù‚Ø© Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©.</p>
          </div>
        </section>

        <!-- Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø© -->
        <section id="help-faq" class="help-content-section">
          <h2 class="help-section-title">Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©</h2>
          
          <div class="help-faq-item">
            <div class="help-faq-question">
              <span>ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø¥Ù†Ø´Ø§Ø¡ ØµÙÙ‚Ø© Ø¬Ø¯ÙŠØ¯Ø©ØŸ</span>
            </div>
            <div class="help-faq-answer">
              <p>Ù„Ø¥Ù†Ø´Ø§Ø¡ ØµÙÙ‚Ø© Ø¬Ø¯ÙŠØ¯Ø©ØŒ Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ± (Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ) ÙˆØ§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± "Ø¥Ù†Ø´Ø§Ø¡ ØµÙÙ‚Ø© Ø¬Ø¯ÙŠØ¯Ø©". Ø§Ù…Ù„Ø£ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØµÙÙ‚Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø±Ù‚Ù… Ø§Ù„ØµÙÙ‚Ø©ØŒ Ø§Ø³Ù… Ø§Ù„Ø³ÙÙŠÙ†Ø©ØŒ Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ø¹Ù…ÙŠÙ„Ø©ØŒ Ø§Ù„ÙˆØ¬Ù‡Ø©ØŒ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ù…ÙˆÙ„Ø©ØŒ ÙˆØ³Ø¹Ø± Ø§Ù„Ø·Ù†. Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ "Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØªÙˆØ²ÙŠØ¹" Ù„Ø±Ø¤ÙŠØ© ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­ØŒ Ø«Ù… Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ "Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙÙ‚Ø©" Ù„Ø­ÙØ¸Ù‡Ø§.</p>
            </div>
          </div>
          
          <div class="help-faq-item">
            <div class="help-faq-question">
              <span>ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ù†Ø¸Ø§Ù… ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù‚Ø§Ø·Ø±Ø§ØªØŸ</span>
            </div>
            <div class="help-faq-answer">
              <p>ÙŠØ³ØªØ®Ø¯Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø© Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø­Ù…ÙˆÙ„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª Ø¨Ø´ÙƒÙ„ Ø£Ù…Ø«Ù„. ØªÙ‚ÙˆÙ… Ø§Ù„Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ø¨Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ù…ÙˆÙ„Ø© ÙˆØ§Ù„Ø³Ø¹Ø© Ø§Ù„Ù‚ØµÙˆÙ‰ Ù„Ù„Ù‚Ø§Ø·Ø±Ø© (60 Ø·Ù† Ø§ÙØªØ±Ø§Ø¶ÙŠÙ‹Ø§). Ø«Ù… ØªÙ‚ÙˆÙ… Ø¨ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø­Ù…ÙˆÙ„Ø© Ø¨Ø§Ù„ØªØ³Ø§ÙˆÙŠ Ù‚Ø¯Ø± Ø§Ù„Ø¥Ù…ÙƒØ§Ù† Ù…Ø¹ Ù…Ø±Ø§Ø¹Ø§Ø© Ø¹Ø¯Ù… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø³Ø¹Ø© Ø§Ù„Ù‚ØµÙˆÙ‰ Ù„Ø£ÙŠ Ù‚Ø§Ø·Ø±Ø©.</p>
            </div>
          </div>
          
          <div class="help-faq-item">
            <div class="help-faq-question">
              <span>ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© Ù„Ù„ØµÙÙ‚Ø©ØŸ</span>
            </div>
            <div class="help-faq-answer">
              <p>Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© Ù„Ù„ØµÙÙ‚Ø©ØŒ ØªØ£ÙƒØ¯ Ø£ÙˆÙ„Ø§Ù‹ Ù…Ù† Ø§ÙƒØªÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ù…Ø±Ø§Ø­Ù„ Ø§Ù„ØµÙÙ‚Ø© (Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†ØŒ Ø¨Ø¯Ø¡ Ø§Ù„Ø±Ø­Ù„Ø©ØŒ Ø±ÙØ¹ PODØŒ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…ÙŠÙ„). Ø«Ù… Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØµÙÙ‚Ø© ÙˆØ§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± "Ù…Ø·Ø§Ø¨Ù‚Ø© ÙˆÙÙˆØªØ±Ø©". Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø³Ù„Ù…Ø© ÙˆØ³Ø¹Ø± Ø§Ù„Ø·Ù†.</p>
            </div>
          </div>
          
          <div class="help-faq-item">
            <div class="help-faq-question">
              <span>ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø¯ÙØ¹Ø© Ù…Ø³ØªÙ„Ù…Ø©ØŸ</span>
            </div>
            <div class="help-faq-answer">
              <p>Ù„ØªØ³Ø¬ÙŠÙ„ Ø¯ÙØ¹Ø© Ù…Ø³ØªÙ„Ù…Ø©ØŒ Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ù‚Ø³Ù… "ÙÙˆØ§ØªÙŠØ± ÙˆØ¯ÙØ¹Ø§Øª" ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ± ÙˆØ§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± "Ø¹Ø±Ø¶ Ø§Ù„ÙÙˆØ§ØªÙŠØ±". Ø«Ù… Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± "ØªØ³Ø¬ÙŠÙ„ Ø¯ÙØ¹" Ø¨Ø¬Ø§Ù†Ø¨ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ÙˆØ£Ø¯Ø®Ù„ Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…Ø©. Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§.</p>
            </div>
          </div>
          
          <div class="help-faq-item">
            <div class="help-faq-question">
              <span>ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯ØŸ</span>
            </div>
            <div class="help-faq-answer">
              <p>Ù„Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯ØŒ Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ© ÙˆØ§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± "Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù". Ø§Ù…Ù„Ø£ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„ÙˆØ¸ÙŠÙØ©ØŒ Ø§Ù„Ù‚Ø³Ù…ØŒ Ù†ÙˆØ¹ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©ØŒ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØŒ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙØŒ Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØŒ ÙˆØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ¹ÙŠÙŠÙ†. Ø«Ù… Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ "Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù" Ù„Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.</p>
            </div>
          </div>
          
          <div class="help-faq-item">
            <div class="help-faq-question">
              <span>ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ù…Ø§Ù„ÙŠØŸ</span>
            </div>
            <div class="help-faq-answer">
              <p>Ù„Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ù…Ø§Ù„ÙŠØŒ Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ø®ØªØ± "Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©". ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ø´Ù‡Ø±ÙŠ Ø£Ùˆ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ Ø£Ùˆ Ø³Ù†ÙˆÙŠ Ø¨Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©. Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ ÙˆØ¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª ÙˆØ§Ù„Ù…ØµØ±ÙˆÙØ§Øª ÙˆØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­ Ù„Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©.</p>
            </div>
          </div>
          
          <div class="help-faq-item">
            <div class="help-faq-question">
              <span>Ù…Ø§ Ù‡Ùˆ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ø¨Ø§Ù„Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬ØŸ</span>
            </div>
            <div class="help-faq-answer">
              <p>Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ø¨Ø§Ù„Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬ Ù‡Ùˆ Ø·Ø±ÙŠÙ‚Ø© Ù…Ø­Ø§Ø³Ø¨ÙŠØ© ØªÙ‚ÙˆÙ… Ø¹Ù„Ù‰ ØªØ³Ø¬ÙŠÙ„ ÙƒÙ„ Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ø§Ù„ÙŠØ© ÙÙŠ Ø­Ø³Ø§Ø¨ÙŠÙ† Ù…ØªÙ‚Ø§Ø¨Ù„ÙŠÙ† (Ù…Ø¯ÙŠÙ† ÙˆØ¯Ø§Ø¦Ù†) Ù„Ø¶Ù…Ø§Ù† ØªÙˆØ§Ø²Ù† Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠØ©. ÙŠØ¯Ø¹Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ù…Ø¹ Ù…ÙƒÙˆÙ†Ø§Øª Ù…ØªÙƒØ§Ù…Ù„Ø© ØªØ´Ù…Ù„ Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§ØªØŒ Ù‚ÙŠÙˆØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©ØŒ Ø¯ÙØªØ± Ø§Ù„Ø£Ø³ØªØ§Ø°ØŒ ÙˆÙ…ÙŠØ²Ø§Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©.</p>
            </div>
          </div>
          
          <div class="help-faq-item">
            <div class="help-faq-question">
              <span>ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ</span>
            </div>
            <div class="help-faq-answer">
              <p>Ù„ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± "ØªØµØ¯ÙŠØ±" ÙÙŠ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ. Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù JSON ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ù„Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø£Ùˆ Ù„Ù†Ù‚Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ù†Ø¸Ø§Ù… Ø¢Ø®Ø±.</p>
            </div>
          </div>
          
          <div class="help-faq-item">
            <div class="help-faq-question">
              <span>Ù…Ø§Ø°Ø§ Ø£ÙØ¹Ù„ Ø¥Ø°Ø§ ÙˆØ§Ø¬Ù‡Øª Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…ØŸ</span>
            </div>
            <div class="help-faq-answer">
              <p>Ø¥Ø°Ø§ ÙˆØ§Ø¬Ù‡Øª Ø£ÙŠ Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…ØŒ ÙŠÙ…ÙƒÙ†Ùƒ:</p>
              <ul>
                <li>Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¯Ù‚Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯Ø®Ù„Ø©</li>
                <li>Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø²Ø± "Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©" Ù„Ø¥ØµÙ„Ø§Ø­ Ø£ÙŠ Ù…Ø´Ø§ÙƒÙ„ ÙÙŠ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</li>
                <li>Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø¨Ø¯Ø¡ Ù…Ù† Ø¬Ø¯ÙŠØ¯ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø²Ø± "Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"</li>
                <li>Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø¯Ø¹Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¥Ø°Ø§ Ø§Ø³ØªÙ…Ø±Øª Ø§Ù„Ù…Ø´ÙƒÙ„Ø©</li>
              </ul>
            </div>
          </div>
          
          <div class="help-info-box">
           
          </div>
        </section>
      `;
      
      // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª
      setupHelpEventListeners();
    }

    function setupHelpEventListeners() {
      // ØªØ¨Ø¯ÙŠÙ„ Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª
      document.addEventListener('click', function(e) {
        if (e.target && e.target.classList.contains('help-nav-tab')) {
          // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø§Ø· Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ø£Ù‚Ø³Ø§Ù…
          document.querySelectorAll('.help-nav-tab').forEach(t => t.classList.remove('active'));
          document.querySelectorAll('.help-content-section').forEach(s => s.classList.remove('active'));
          
          // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ø´Ø§Ø· Ù„Ù„Ø²Ø± ÙˆØ§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ø­Ø¯Ø¯
          e.target.classList.add('active');
          const targetId = e.target.getAttribute('data-help-target');
          document.getElementById(targetId).classList.add('active');
        }
        
        // ØªÙˆØ³ÙŠØ¹/Ø·ÙŠ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©
        if (e.target && e.target.classList.contains('help-faq-question')) {
          const answer = e.target.nextElementSibling;
          answer.style.display = answer.style.display === 'none' ? 'block' : 'none';
        }
      });
    }

    function printHelp() {
      const helpContent = document.getElementById('helpContent');
      if (!helpContent) return;
      
      const printWindow = window.open('', '_blank');
      printWindow.document.write(`
        <html dir="rtl">
          <head>
            <title>Ø¯Ù„ÙŠÙ„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</title>
            <style>
              body { 
                font-family: 'Segoe UI', Tahoma, system-ui, sans-serif; 
                line-height: 1.6; 
                color: #1d3557;
                padding: 20px;
                max-width: 1000px;
                margin: 0 auto;
              }
              h1 { color: #4361ee; border-bottom: 2px solid #f1f5f9; padding-bottom: 10px; }
              h2 { color: #4361ee; margin-top: 30px; }
              h3 { color: #3f37c9; margin-top: 25px; }
              .step { background: #f8fafc; padding: 15px; margin: 15px 0; border-right: 4px solid #4361ee; }
              .feature-card { background: white; padding: 15px; margin: 15px 0; border: 1px solid #e2e8f0; border-top: 4px solid #4361ee; }
              .tip-box { background: #f0fdf4; padding: 12px; margin: 15px 0; border-right: 4px solid #4cc9f0; }
              .info-box { background: #f0f9ff; padding: 12px; margin: 15px 0; border-right: 4px solid #7209b7; }
              @media print {
                .help-nav-tabs { display: none; }
                .help-content-section { display: block !important; }
              }
            </style>
          </head>
          <body>
            <h1>ğŸšš Ø¯Ù„ÙŠÙ„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</h1>
            <p><strong>Ø§Ù„Ø¥ØµØ¯Ø§Ø± 2.0</strong> - ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©: ${new Date().toLocaleDateString('ar-SA')}</p>
            ${helpContent.innerHTML}
          </body>
        </html>
      `);
      printWindow.document.close();
      printWindow.focus();
      setTimeout(() => {
        printWindow.print();
      }, 500);
    }

    // ======================= Ù…Ø±ÙƒØ² Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª =======================
    const KEY = 'tms_sim_fin_v10';
    let DB = JSON.parse(localStorage.getItem(KEY) || '{}');
    let currentUserRole = 'admin';

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    const initializeDB = () => {
      const defaults = {
        deals: [],
        notifications: [],
        invoices: [],
        payments: [],
        activity: [],
        ledger: [],
        journal: [],
        accounts: {
          cash: { id: 'cash', code: '1000', name: 'Ø§Ù„Ø®Ø²ÙŠÙ†Ø© (Ù†Ù‚Ø¯)', type: 'asset', balance: 0 },
          bank: { id: 'bank', code: '1010', name: 'Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†Ùƒ', type: 'asset', balance: 0 },
          ar: { id: 'ar', code: '1100', name: 'Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ - Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© (Ø¹Ø§Ù…)', type: 'asset', balance: 0 },
          ap: { id: 'ap', code: '2000', name: 'Ø§Ù„Ù…ÙˆØ±Ø¯ÙˆÙ† - Ø§Ù„Ø¯Ø§Ø¦Ù†ÙˆÙ† (Ø¹Ø§Ù…)', type: 'liability', balance: 0 },
          revenue: { id: 'revenue', code: '4000', name: 'Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ù‚Ù„', type: 'income', balance: 0 },
          fuel_exp: { id: 'fuel_exp', code: '5100', name: 'Ù…ØµØ§Ø±ÙŠÙ ÙˆÙ‚ÙˆØ¯', type: 'expense', balance: 0 },
          salary_exp: { id: 'salary_exp', code: '5200', name: 'Ø±ÙˆØ§ØªØ¨', type: 'expense', balance: 0 },
          maintenance_exp: { id: 'maintenance_exp', code: '5300', name: 'ØµÙŠØ§Ù†Ø©', type: 'expense', balance: 0 },
          equity: { id: 'equity', code: '3000', name: 'Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„', type: 'equity', balance: 0 }
        },
        settings: {
          advance: 20000, 
          companyEmail: 'ceo@company.com', 
          companyRevenuePerTruck: 5000, 
          maxTruckLoad: 60,
          pricePerTon: 50,
          lastInvoiceNumber: 0
        },
        employees: [],
        salaries: [],
        leaves: [],
        evaluations: [],
        attendance: [],
        transactions: [],
        budget: { income: 0, expenses: 0, balance: 0 },
        taxes: [],
        reports: []
      };

      Object.keys(defaults).forEach(key => {
        if (!DB[key]) DB[key] = defaults[key];
      });
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª ÙˆØ§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ† ÙˆØ§Ù„Ø¹Ù…Ù„Ø§Ø¡
      DB.deals.forEach(deal => {
        deal.trucks.forEach(truck => {
          const truckAccountId = `truck_${truck.id}`;
          if (!DB.accounts[truckAccountId]) {
            DB.accounts[truckAccountId] = {
              id: truckAccountId,
              code: Math.floor(Math.random()*9000)+1000,
              name: `Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‚Ø§Ø·Ø±Ø© ${truck.truckNumber}`,
              type: 'asset',
              balance: 0
            };
          }
          
          const driverAccountId = `driver_${truck.driverName.replace(/\s+/g, '_')}`;
          if (!DB.accounts[driverAccountId]) {
            DB.accounts[driverAccountId] = {
              id: driverAccountId,
              code: Math.floor(Math.random()*9000)+1000,
              name: `Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø§Ø¦Ù‚ ${truck.driverName}`,
              type: 'asset',
              balance: 0
            };
          }
        });
        
        const clientAccountId = `client_${deal.clientId}`;
        if (!DB.accounts[clientAccountId]) {
          DB.accounts[clientAccountId] = {
            id: clientAccountId,
            code: Math.floor(Math.random()*9000)+1000,
            name: `Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„ ${deal.companyName}`,
            type: 'asset',
            balance: 0
          };
        }
      });
    };

    initializeDB();

    // ======================= Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© =======================
    function save(){ 
      try {
        localStorage.setItem(KEY, JSON.stringify(DB));
        return true;
      } catch (e) {
        console.error('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', e);
        pushNotification('Ø®Ø·Ø£', 'ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 1000);
        return false;
      }
    }

    function log(msg){ 
      DB.activity.unshift({
        at: new Date().toISOString(),
        msg,
        role: currentUserRole
      }); 
      if(DB.activity.length > 350) DB.activity.pop(); 
      save(); 
      renderActivity(); 
    }

    function pushNotification(title, text, ttl=5000){ 
      const box = document.getElementById('notificationsArea'); 
      const el = document.createElement('div'); 
      el.className='toast'; 
      el.innerHTML = `<div style="font-weight:700">${title}</div><div class="muted" style="font-size:13px">${text}</div>`; 
      box.prepend(el); 
      setTimeout(()=>{ 
        el.style.transition='opacity 0.5s'; 
        el.style.opacity='0'; 
        setTimeout(()=>el.remove(),500); 
      }, ttl); 
    }

    function emit(event, payload){ window.dispatchEvent(new CustomEvent(event,{detail:payload})); }

    function colorFromString(str){ 
      let h=0; for(let i=0;i<str.length;i++){ h = str.charCodeAt(i) + ((h<<5)-h); } 
      const hue = Math.abs(h)%360; 
      return `linear-gradient(90deg,hsl(${hue} 70% 55%), hsl(${(hue+30)%360} 65% 50%))`; 
    }

    function uid(prefix='id'){return prefix + '_' + Date.now() + '_' + Math.floor(Math.random()*1000)}
    function fmt(n){return Number(n).toFixed(2)}
    function nowISO(){ return new Date().toISOString(); }

    // ======================= Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬ =======================
    function addJournalEntry({ref=null,date=null,description='',lines=[]}){
      date = date || nowISO();
      const id = uid('JRN');
      const totalDebit = lines.filter(l=>l.side==='debit').reduce((s,l)=>s+Number(l.amount),0);
      const totalCredit = lines.filter(l=>l.side==='credit').reduce((s,l)=>s+Number(l.amount),0);
      if(Math.abs(totalDebit - totalCredit) > 0.0001) throw new Error('Ù‚ÙŠØ¯ ØºÙŠØ± Ù…ØªÙˆØ§Ø²Ù†: Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…Ø¯ÙŠÙ† Ù„Ø§ ÙŠØ³Ø§ÙˆÙŠ Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø¯Ø§Ø¦Ù†');
      const entry = {id,ref,date,description,lines};
      DB.journal.unshift(entry);
      // update account balances (simplified rules)
      lines.forEach(l=>{
        const acc = DB.accounts[l.accountId];
        if(!acc){ console.warn('Ø­Ø³Ø§Ø¨ Ù…ÙÙ‚ÙˆØ¯:', l.accountId); return; }
        if(['asset','expense'].includes(acc.type)){
          acc.balance = (acc.balance || 0) + (l.side==='debit' ? Number(l.amount) : -Number(l.amount));
        } else {
          // income, liability, equity
          acc.balance = (acc.balance || 0) + (l.side==='credit' ? Number(l.amount) : -Number(l.amount));
        }
      });
      // mirror in ledger for backward compatibility
      DB.ledger.unshift({id: uid('LED'), date, ref, description, lines});
      // keep size reasonable
      if(DB.journal.length>5000) DB.journal.pop();
      if(DB.ledger.length>5000) DB.ledger.pop();
      save();
      return entry;
    }

    // wrapper to preserve old ledgerAdd signature
    function ledgerAdd(entry){
      // entry: {desc, amount, fromAccount, toAccount, ref}
      const lines = [
        {accountId: entry.toAccount, side:'debit', amount: Number(entry.amount)},
        {accountId: entry.fromAccount, side:'credit', amount: Number(entry.amount)}
      ];
      return addJournalEntry({ref: entry.ref || null, description: entry.desc || '', lines});
    }

    // ======================= Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠØ© =======================
    function ensureEntityAccount(typePrefix, entityId, name, accountType='asset'){
      const accId = `${typePrefix}_${entityId}`;
      if(!DB.accounts[accId]){
        // code generation: take last digits
        const code = Math.floor(Math.random()*9000)+1000;
        DB.accounts[accId] = {id:accId, code:String(code), name, type:accountType, balance:0};
        save();
      }
      return DB.accounts[accId];
    }

    function issueInvoice({dealId,clientId,amount,items=[]}){
      DB.settings.lastInvoiceNumber = (DB.settings.lastInvoiceNumber || 0) + 1;
      const number = 'INV-' + String(DB.settings.lastInvoiceNumber).padStart(6,'0');
      const inv = { id: uid('INV'), number, dealId, clientId, date:nowISO(), amount:Number(amount), items, paid:0, status:'issued' };
      DB.invoices.unshift(inv);
      // ensure client account
      ensureEntityAccount('client', clientId, 'Ø¹Ù…ÙŠÙ„ ' + clientId, 'asset');
      // journal: dr client (AR) / cr revenue
      addJournalEntry({ ref: inv.id, description:`Ø¥ØµØ¯Ø§Ø± ÙØ§ØªÙˆØ±Ø© ${number}`, lines:[
        {accountId:`client_${clientId}`, side:'debit', amount:inv.amount},
        {accountId:'revenue', side:'credit', amount:inv.amount}
      ]});
      save();
      return inv;
    }

    function recordPayment({invoiceId, amount, receivedAccountId='cash', date=null}){
      const inv = DB.invoices.find(i=>i.id===invoiceId);
      if(!inv) throw new Error('ÙØ§ØªÙˆØ±Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©');
      const payment = {id:uid('PAY'), invoiceId, amount:Number(amount), accountId:receivedAccountId, date:date||nowISO()};
      DB.payments.unshift(payment);
      // journal: dr cash/bank / cr client AR
      addJournalEntry({ ref: payment.id, description:`Ø¯ÙØ¹Ø© Ù„ÙØ§ØªÙˆØ±Ø© ${inv.number}`, lines:[
        {accountId:receivedAccountId, side:'debit', amount:payment.amount},
        {accountId:`client_${inv.clientId}`, side:'credit', amount:payment.amount}
      ]});
      inv.paid = (inv.paid || 0) + payment.amount;
      if(Math.abs(inv.paid - inv.amount) < 0.0001) inv.status = 'paid';
      else if(inv.paid>0 && inv.paid<inv.amount) inv.status = 'partial';
      save();
      return payment;
    }

    function createDeal(deal){
      const d = Object.assign({id:uid('DEAL'), date:nowISO()}, deal);
      DB.deals.unshift(d);
      // ensure accounts for client/truck/driver
      if(d.clientId) ensureEntityAccount('client', d.clientId, 'Ø¹Ù…ÙŠÙ„ ' + d.clientId, 'asset');
      if(d.truckId) ensureEntityAccount('truck', d.truckId, 'Ù‚Ø§Ø·Ø±Ø© ' + d.truckId, 'asset');
      if(d.driverId) ensureEntityAccount('driver', d.driverId, 'Ø³Ø§Ø¦Ù‚ ' + d.driverId, 'asset');
      save();
      return d;
    }

    function payExpense({amount, accountId='cash', expenseAccountId='fuel_exp', description=''}){
      // dr expense / cr cash
      addJournalEntry({description:`${description || 'ØµØ±Ù Ù…ØµØ±ÙˆÙ'}`, lines:[
        {accountId:expenseAccountId, side:'debit', amount:amount},
        {accountId:accountId, side:'credit', amount:amount}
      ]});
    }

    // ======================= ØªØ³ÙˆÙŠØ© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª =======================
    function reconcileAccount(accountId, targetTransactions){
      // targetTransactions: array of {invoiceId?, paymentId?, amount}
      // for demo: we'll mark matched flag on invoices/payments
      targetTransactions.forEach(t=>{
        if(t.invoiceId){ const inv = DB.invoices.find(i=>i.id===t.invoiceId); if(inv) inv.reconciled = true; }
        if(t.paymentId){ const pay = DB.payments.find(p=>p.id===t.paymentId); if(pay) pay.reconciled = true; }
      });
      save();
    }

    // ======================= Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª (Linear Programming) =======================
    function calculateOptimalTrucks(totalLoad, maxTruckLoad = 60) {
      const trucks = [];
      let remainingLoad = totalLoad;
      
      const truckCount = Math.ceil(totalLoad / maxTruckLoad);
      const baseLoad = Math.floor(totalLoad / truckCount);
      let extraLoad = totalLoad % truckCount;
      
      for (let i = 0; i < truckCount; i++) {
        let load = baseLoad;
        if (extraLoad > 0) {
          load += 1;
          extraLoad -= 1;
        }
        
        load = Math.min(load, maxTruckLoad);
        
        trucks.push({
          id: 'T' + Date.now() + i,
          load: load,
          truckNumber: `TR-${1000 + i}`,
          driverName: 'Ø³ÙŠØªÙ… Ø§Ù„ØªØ¹ÙŠÙŠÙ†',
          driverPhone: '',
          rentAmount: 0,
          dieselAmount: 0,
          expensesAdvance: 0,
          driverAccepted: false,
          delivered: false,
          clientConfirmed: false,
          companyRevenue: 0,
          payout: { created: false, paid: false }
        });
        
        remainingLoad -= load;
        if (remainingLoad <= 0) break;
      }
      
      return trucks;
    }

    // ======================= API Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ =======================
    const TMS = {
      createDeal(dealData) {
        const { 
          dealNumber, shipName, companyName, clientId, destination, 
          totalLoad, pricePerTon, cargoType, notes 
        } = dealData;
        
        const dealValue = totalLoad * pricePerTon;
        const trucks = calculateOptimalTrucks(totalLoad, DB.settings.maxTruckLoad);
        
        const newDeal = {
          id: 'D' + Date.now(),
          dealNumber,
          shipName,
          companyName,
          clientId,
          destination,
          totalLoad,
          pricePerTon,
          dealValue,
          cargoType,
          notes,
          trucks,
          createdAt: new Date().toISOString(),
          status: 'created'
        };
        
        DB.deals.push(newDeal);
        save();
        
        log(`ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØµÙÙ‚Ø© Ø¬Ø¯ÙŠØ¯Ø©: ${dealNumber} - ${totalLoad} Ø·Ù† - ${dealValue.toLocaleString()} Ø±.ÙŠ`);
        pushNotification('ØµÙÙ‚Ø© Ø¬Ø¯ÙŠØ¯Ø©', `ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ${dealNumber} Ø¨Ù‚ÙŠÙ…Ø© ${dealValue.toLocaleString()} Ø±.ÙŠ`);
        
        return Promise.resolve(newDeal);
      },

      acceptTask(dealId,truckId){ 
        const d = DB.deals.find(x=>x.id===dealId); 
        const t = d.trucks.find(x=>x.id===truckId);
        if(t.driverAccepted) return Promise.resolve(false);
        
        t.driverAccepted = true; 
        t.acceptedAt = new Date().toISOString(); 
        
        t.expensesAdvance = DB.settings.advance; 
        ledgerAdd({
          type:'expense', 
          amount:DB.settings.advance, 
          desc:`Ø³Ù„ÙØ© Ù„Ù„Ø³Ø§Ø¦Ù‚ ${t.driverName}`, 
          dealId, 
          truckId,
          fromAccount: 'cash',
          toAccount: `driver_${t.driverName.replace(/\s+/g, '_')}`
        });
        
        t.companyRevenue = DB.settings.companyRevenuePerTruck; 
        ledgerAdd({
          type:'revenue', 
          amount: t.companyRevenue, 
          desc:`Ø¥ÙŠØ±Ø§Ø¯ Ø«Ø§Ø¨Øª Ù„Ù„Ø´Ø±ÙƒØ© â€” Ù‚Ø§Ø·Ø±Ø© ${t.truckNumber}`, 
          dealId, 
          truckId,
          fromAccount: `client_${d.clientId}`,
          toAccount: 'revenue'
        });
        
        save(); 
        log(`Ø§Ù„Ø³Ø§Ø¦Ù‚ ${t.driverName} ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù‡Ù…Ø© (${t.truckNumber}). Ø³Ù„ÙØ© ${DB.settings.advance} Ø±.ÙŠ Ù…Ø³Ø¬Ù„Ø©.`);
        pushNotification('Ù…ÙˆØ§ÙÙ‚Ø© Ø³Ø§Ø¦Ù‚', `Ø§Ù„Ø³Ø§Ø¦Ù‚ ${t.driverName} ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø·Ø±Ø© ${t.truckNumber}`);
        emit('task.accepted',{dealId,truckId}); 
        return Promise.resolve(true); 
      },

      startTrip(dealId,truckId){ 
        const d = DB.deals.find(x=>x.id===dealId); 
        const t = d.trucks.find(x=>x.id===truckId); 
        t.startedAt = new Date().toISOString(); 
        save(); 
        log(`Ø§Ù†Ø·Ù„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø·Ø±Ø© ${t.truckNumber} â€” ${d.dealNumber}`); 
        pushNotification('Ø§Ù†Ø·Ù„Ø§Ù‚ Ø§Ù„Ø±Ø­Ù„Ø©', `${t.truckNumber} Ø§Ù†Ø·Ù„Ù‚Øª`); 
        emit('trip.started',{dealId,truckId}); 
        return Promise.resolve(true); 
      },

      uploadPOD(dealId,truckId, podData){ 
        const d = DB.deals.find(x=>x.id===dealId); 
        const t = d.trucks.find(x=>x.id===truckId); 
        if(!t.driverAccepted) return Promise.reject('Ø§Ù„Ø³Ø§Ø¦Ù‚ Ù„Ù… ÙŠØ¤ÙƒØ¯ Ø§Ù„Ù…Ù‡Ù…Ø©'); 
        t.delivered = true; 
        t.deliveredAt = new Date().toISOString(); 
        t.pod = {uploadedAt:new Date().toISOString(),data:podData}; 
        
        DB.notifications.push({
          id:'CL'+Date.now(),
          type:'client_confirm',
          dealId,
          truckId,
          createdAt: new Date().toISOString()
        }); 
        
        save(); 
        log(`POD: Ø§Ù„Ø³Ø§Ø¦Ù‚ ${t.driverName} Ø±ÙØ¹ Ø¯Ù„ÙŠÙ„ Ø§Ù„ØªØ³Ù„ÙŠÙ… â€” ${t.truckNumber}`); 
        pushNotification('POD Ù…Ø±ÙÙˆØ¹', `Ø§Ù„Ù‚Ø§Ø·Ø±Ø© ${t.truckNumber} Ø±ÙØ¹Øª POD`); 
        emit('pod.uploaded',{dealId,truckId}); 
        return Promise.resolve(true); 
      },

      clientConfirm(dealId,truckId){ 
        const d = DB.deals.find(x=>x.id===dealId); 
        const t = d.trucks.find(x=>x.id===truckId); 
        t.clientConfirmed = true; 
        t.clientConfirmedAt = new Date().toISOString(); 
        
        DB.notifications = DB.notifications.filter(n=> !(n.type==='client_confirm' && n.dealId===dealId && n.truckId===truckId)); 
        
        save(); 
        log(`Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø£ÙƒØ¯ Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ù‚Ø§Ø·Ø±Ø© ${t.truckNumber} â€” ${d.dealNumber}`); 
        pushNotification('ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…ÙŠÙ„', `ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø§Ø³ØªÙ„Ø§Ù… ${t.truckNumber}`); 
        emit('client.confirmed',{dealId,truckId}); 
        return Promise.resolve(true); 
      },

      agentUpdateLoad(dealId, data){ 
        const d = DB.deals.find(x=>x.id===dealId); 
        d.loadedAt = new Date().toISOString(); 
        d.loadNote = data.note || ''; 
        save(); 
        log(`Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ Ø£ÙƒØ¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ø­Ù†Ø© Ù„Ù„ØµÙÙ‚Ø© ${d.dealNumber}`); 
        pushNotification('ØªØ­Ù…ÙŠÙ„ ÙÙŠ Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡', `ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„ â€” ${d.dealNumber}`); 
        emit('agent.loaded',{dealId}); 
        return Promise.resolve(true); 
      },

      setDieselAmount(dealId,truckId,amount){ 
        const d = DB.deals.find(x=>x.id===dealId); 
        const t = d.trucks.find(x=>x.id===truckId); 
        t.dieselAmount = Number(amount); 
        ledgerAdd({
          type:'expense', 
          amount: Number(amount), 
          desc:`Ø¯ÙŠØ²Ù„ Ù„Ù„Ù‚Ø§Ø·Ø±Ø© ${t.truckNumber}`, 
          dealId, 
          truckId,
          fromAccount: 'cash',
          toAccount: 'fuel_exp'
        }); 
        save(); 
        log(`ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯ÙŠØ²Ù„ Ù„Ù„Ù‚Ø§Ø·Ø±Ø© ${t.truckNumber} â€” ${amount.toLocaleString()} Ø±.ÙŠ`); 
        return Promise.resolve(true); 
      },

      matchAndInvoice(dealId){ 
        const d = DB.deals.find(x=>x.id===dealId); 
        const confirmed = d.trucks.filter(t=> t.delivered && t.clientConfirmed); 
        if(!confirmed.length) return Promise.reject('Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ£ÙƒÙŠØ¯Ø§Øª Ù„Ù„ØªÙØ±ÙŠØº'); 
        
        const deliveredLoad = confirmed.reduce((s,t)=> s + (t.load||0),0); 
        const perTon = d.pricePerTon || (d.dealValue/d.totalLoad) || 0; 
        const amount = Number((deliveredLoad * perTon).toFixed(2)); 
        
        const inv = { 
          id:'INV'+Date.now(), 
          dealId, 
          amount, 
          issuedAt:new Date().toISOString(), 
          paid:0, 
          status:'issued', 
          lines:confirmed.map(t=>({
            truckId:t.id,
            truckNumber:t.truckNumber,
            load:t.load,
            amount:Number((perTon * t.load).toFixed(2))
          })) 
        }; 
        
        DB.invoices.push(inv); 
        save(); 
        log(`ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© ${inv.id} Ø¨Ù‚ÙŠÙ…Ø© ${inv.amount.toLocaleString()} Ø±.ÙŠ Ù„Ù„ØµÙÙ‚Ø© ${d.dealNumber}`); 
        pushNotification('ÙØ§ØªÙˆØ±Ø© Ù…Ù†Ø´Ø£Ø©', `ÙØ§ØªÙˆØ±Ø© ${inv.id} â€” ${inv.amount.toLocaleString()} Ø±.ÙŠ`); 
        emit('invoice.created',{dealId,invoiceId:inv.id}); 
        return Promise.resolve(inv); 
      },

      recordPayment(invoiceId,amount){ 
        const inv = DB.invoices.find(i=>i.id===invoiceId); 
        inv.paid = (inv.paid||0) + Number(amount); 
        if(inv.paid >= inv.amount) inv.status='paid'; 
        
        DB.payments.push({
          id:'PAY'+Date.now(),
          invoiceId,
          amount:Number(amount),
          date:new Date().toISOString()
        }); 
        
        ledgerAdd({
          type: 'revenue',
          amount: Number(amount),
          desc: `Ø¯ÙØ¹Ø© ÙØ§ØªÙˆØ±Ø© ${invoiceId}`,
          fromAccount: `client_${DB.deals.find(d => d.id === inv.dealId)?.clientId}`,
          toAccount: 'revenue'
        });
        
        save(); 
        log(`ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø¯ÙØ¹Ø© ${Number(amount).toLocaleString()} Ø±.ÙŠ Ù„Ù„ÙØ§ØªÙˆØ±Ø© ${invoiceId}`); 
        pushNotification('Ø¯ÙØ¹Ø© Ù…Ø³ØªÙ„Ù…Ø©', `ÙØ§ØªÙˆØ±Ø© ${invoiceId} â€” ${Number(amount).toLocaleString()} Ø±.ÙŠ`); 
        emit('payment.received',{invoiceId,amount}); 
        return Promise.resolve(true); 
      }
    };

    // ======================= API Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© =======================
    const HR = {
      addEmployee(employeeData) {
        const newEmployee = {
          id: 'EMP' + Date.now(),
          ...employeeData,
          createdAt: new Date().toISOString(),
          status: 'active'
        };
        
        DB.employees.push(newEmployee);
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ù„Ù„Ù…ÙˆØ¸Ù ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø§Ù„ÙŠ
        const employeeAccountId = `employee_${newEmployee.id}`;
        DB.accounts[employeeAccountId] = {
          id: employeeAccountId,
          code: Math.floor(Math.random()*9000)+1000,
          name: `Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ÙˆØ¸Ù ${employeeData.name}`,
          type: 'asset',
          balance: 0
        };
        
        save();
        
        log(`ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯: ${employeeData.name}`);
        pushNotification('Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯', `ØªÙ… Ø¥Ø¶Ø§ÙØ© ${employeeData.name} Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª`);
        
        return Promise.resolve(newEmployee);
      },
      
      updateEmployee(employeeId, updates) {
        const employee = DB.employees.find(e => e.id === employeeId);
        if (!employee) return Promise.reject('Ø§Ù„Ù…ÙˆØ¸Ù ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
        
        Object.assign(employee, updates);
        save();
        
        log(`ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù: ${employee.name}`);
        pushNotification('ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª', `ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª ${employee.name}`);
        
        return Promise.resolve(employee);
      },
      
      addSalaryRecord(employeeId, salaryData) {
        const employee = DB.employees.find(e => e.id === employeeId);
        if (!employee) return Promise.reject('Ø§Ù„Ù…ÙˆØ¸Ù ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
        
        const salaryRecord = {
          id: 'SAL' + Date.now(),
          employeeId,
          employeeName: employee.name,
          ...salaryData,
          date: new Date().toISOString()
        };
        
        DB.salaries.push(salaryRecord);
        
        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ©
        ledgerAdd({
          type: 'expense',
          amount: salaryData.amount,
          desc: `Ø±Ø§ØªØ¨ Ø§Ù„Ù…ÙˆØ¸Ù ${employee.name}`,
          fromAccount: 'cash',
          toAccount: 'salary_exp'
        });
        
        save();
        
        log(`ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø±Ø§ØªØ¨ Ù„Ù„Ù…ÙˆØ¸Ù: ${employee.name} - ${salaryData.amount} Ø±.ÙŠ`);
        pushNotification('ØªØ³Ø¬ÙŠÙ„ Ø±Ø§ØªØ¨', `ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø±Ø§ØªØ¨ ${employee.name}`);
        
        return Promise.resolve(salaryRecord);
      },
      
      addLeaveRequest(employeeId, leaveData) {
        const employee = DB.employees.find(e => e.id === employeeId);
        if (!employee) return Promise.reject('Ø§Ù„Ù…ÙˆØ¸Ù ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
        
        const leaveRequest = {
          id: 'LEV' + Date.now(),
          employeeId,
          employeeName: employee.name,
          ...leaveData,
          createdAt: new Date().toISOString(),
          status: 'pending'
        };
        
        DB.leaves.push(leaveRequest);
        save();
        
        log(`ØªÙ… ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø¥Ø¬Ø§Ø²Ø© Ù…Ù†: ${employee.name}`);
        pushNotification('Ø·Ù„Ø¨ Ø¥Ø¬Ø§Ø²Ø©', `Ø·Ù„Ø¨ Ø¥Ø¬Ø§Ø²Ø© Ù…Ù† ${employee.name}`);
        
        return Promise.resolve(leaveRequest);
      },
      
      addEvaluation(employeeId, evaluationData) {
        const employee = DB.employees.find(e => e.id === employeeId);
        if (!employee) return Promise.reject('Ø§Ù„Ù…ÙˆØ¸Ù ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
        
        const evaluation = {
          id: 'EVAL' + Date.now(),
          employeeId,
          employeeName: employee.name,
          ...evaluationData,
          date: new Date().toISOString()
        };
        
        DB.evaluations.push(evaluation);
        save();
        
        log(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ØªÙ‚ÙŠÙŠÙ… Ù„Ù„Ù…ÙˆØ¸Ù: ${employee.name}`);
        pushNotification('ØªÙ‚ÙŠÙŠÙ… Ù…ÙˆØ¸Ù', `ØªÙ… ØªÙ‚ÙŠÙŠÙ… ${employee.name}`);
        
        return Promise.resolve(evaluation);
      },
      
      recordAttendance(employeeId, status, date = new Date().toISOString().split('T')[0]) {
        const employee = DB.employees.find(e => e.id === employeeId);
        if (!employee) return Promise.reject('Ø§Ù„Ù…ÙˆØ¸Ù ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
        
        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø³Ø¬Ù„ Ø­Ø¶ÙˆØ± Ù…ÙˆØ¬ÙˆØ¯ Ù„Ù†ÙØ³ Ø§Ù„ÙŠÙˆÙ…
        const existingRecord = DB.attendance.find(a => a.employeeId === employeeId && a.date === date);
        
        if (existingRecord) {
          existingRecord.status = status;
        } else {
          DB.attendance.push({
            id: 'ATT' + Date.now(),
            employeeId,
            employeeName: employee.name,
            date,
            status,
            recordedAt: new Date().toISOString()
          });
        }
        
        save();
        
        log(`ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± Ø§Ù„Ù…ÙˆØ¸Ù: ${employee.name} - ${status}`);
        pushNotification('ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ±', `ØªÙ… ØªØ³Ø¬ÙŠÙ„ ${status} Ù„Ù€ ${employee.name}`);
        
        return Promise.resolve(DB.attendance.find(a => a.employeeId === employeeId && a.date === date));
      }
    };

    // ======================= API Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© =======================
    const ACCOUNTING = {
      addTransaction(transactionData) {
        const transaction = {
          id: 'TRX' + Date.now(),
          ...transactionData,
          date: new Date().toISOString()
        };
        
        DB.transactions.push(transaction);
        
        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬ ÙÙŠ Ø¯ÙØªØ± Ø§Ù„Ø£Ø³ØªØ§Ø°
        if (transaction.fromAccount && transaction.toAccount) {
          ledgerAdd({
            type: transaction.type,
            amount: transaction.amount,
            desc: transaction.description,
            fromAccount: transaction.fromAccount,
            toAccount: transaction.toAccount
          });
        }
        
        if (transaction.type === 'income') {
          DB.budget.income += transaction.amount;
          DB.budget.balance += transaction.amount;
        } else if (transaction.type === 'expense') {
          DB.budget.expenses += transaction.amount;
          DB.budget.balance -= transaction.amount;
        }
        
        save();
        
        log(`ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ø§Ù„ÙŠØ©: ${transaction.description} - ${transaction.amount} Ø±.ÙŠ`);
        pushNotification('Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ø§Ù„ÙŠØ©', `ØªÙ… Ø¥Ø¶Ø§ÙØ© ${transaction.description}`);
        
        return Promise.resolve(transaction);
      },
      
      updateBudget(budgetData) {
        DB.budget = { ...DB.budget, ...budgetData };
        save();
        
        log('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©');
        pushNotification('ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©', 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©');
        
        return Promise.resolve(DB.budget);
      },
      
      addTaxRecord(taxData) {
        const taxRecord = {
          id: 'TAX' + Date.now(),
          ...taxData,
          date: new Date().toISOString()
        };
        
        DB.taxes.push(taxRecord);
        save();
        
        log(`ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø³Ø¬Ù„ Ø¶Ø±ÙŠØ¨ÙŠ: ${taxRecord.description}`);
        pushNotification('Ø³Ø¬Ù„ Ø¶Ø±ÙŠØ¨ÙŠ', `ØªÙ… Ø¥Ø¶Ø§ÙØ© ${taxRecord.description}`);
        
        return Promise.resolve(taxRecord);
      },
      
      getProfitLossStatement(startDate, endDate) {
        const transactions = DB.transactions.filter(t => {
          const tDate = new Date(t.date);
          return tDate >= new Date(startDate) && tDate <= new Date(endDate);
        });
        
        const income = transactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
        const expenses = transactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0);
        const netProfit = income - expenses;
        
        return {
          income,
          expenses,
          netProfit,
          period: `${startDate} Ø¥Ù„Ù‰ ${endDate}`,
          generatedAt: new Date().toISOString()
        };
      },
      
      getBalanceSheet() {
        const assets = Object.values(DB.accounts).filter(a => a.type === 'asset').reduce((sum, a) => sum + a.balance, 0);
        const liabilities = Object.values(DB.accounts).filter(a => a.type === 'liability').reduce((sum, a) => sum + a.balance, 0);
        const equity = Object.values(DB.accounts).filter(a => a.type === 'equity').reduce((sum, a) => sum + a.balance, 0);
        const income = Object.values(DB.accounts).filter(a => a.type === 'income').reduce((sum, a) => sum + a.balance, 0);
        const expenses = Object.values(DB.accounts).filter(a => a.type === 'expense').reduce((sum, a) => sum + a.balance, 0);
        
        const totalAssets = assets;
        const totalLiabilities = liabilities;
        const totalEquity = equity + (income - expenses);
        
        return {
          assets: totalAssets,
          liabilities: totalLiabilities,
          equity: totalEquity,
          generatedAt: new Date().toISOString()
        };
      }
    };

    // ======================= API Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© =======================
    const REPORTS = {
      generateFinancialReport(period) {
        const startDate = new Date();
        if (period === 'month') {
          startDate.setMonth(startDate.getMonth() - 1);
        } else if (period === 'quarter') {
          startDate.setMonth(startDate.getMonth() - 3);
        } else if (period === 'year') {
          startDate.setFullYear(startDate.getFullYear() - 1);
        }
        
        const transactions = DB.transactions.filter(t => new Date(t.date) >= startDate);
        const income = transactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
        const expenses = transactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0);
        const netProfit = income - expenses;
        
        const report = {
          id: 'REP' + Date.now(),
          type: 'financial',
          period,
          generatedAt: new Date().toISOString(),
          data: {
            income,
            expenses,
            netProfit,
            transactionCount: transactions.length
          }
        };
        
        DB.reports.push(report);
        save();
        
        log(`ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ù…Ø§Ù„ÙŠ Ù„Ù„ÙØªØ±Ø©: ${period}`);
        pushNotification('ØªÙ‚Ø±ÙŠØ± Ù…Ø§Ù„ÙŠ', `ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ù„Ù„ÙØªØ±Ø© ${period}`);
        
        return Promise.resolve(report);
      },
      
      generateOperationalReport(period) {
        const startDate = new Date();
        if (period === 'month') {
          startDate.setMonth(startDate.getMonth() - 1);
        } else if (period === 'quarter') {
          startDate.setMonth(startDate.getMonth() - 3);
        } else if (period === 'year') {
          startDate.setFullYear(startDate.getFullYear() - 1);
        }
        
        const deals = DB.deals.filter(d => new Date(d.createdAt) >= startDate);
        const completedDeals = deals.filter(d => d.trucks.every(t => t.clientConfirmed));
        const totalRevenue = deals.reduce((sum, d) => sum + (d.dealValue || 0), 0);
        const totalTrucks = deals.reduce((sum, d) => sum + d.trucks.length, 0);
        const completedTrucks = deals.reduce((sum, d) => sum + d.trucks.filter(t => t.clientConfirmed).length, 0);
        
        const report = {
          id: 'REP' + Date.now(),
          type: 'operational',
          period,
          generatedAt: new Date().toISOString(),
          data: {
            totalDeals: deals.length,
            completedDeals: completedDeals.length,
            completionRate: deals.length > 0 ? (completedDeals.length / deals.length * 100).toFixed(2) : 0,
            totalRevenue,
            totalTrucks,
            completedTrucks,
            truckUtilizationRate: totalTrucks > 0 ? (completedTrucks / totalTrucks * 100).toFixed(2) : 0
          }
        };
        
        DB.reports.push(report);
        save();
        
        log(`ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± ØªØ´ØºÙŠÙ„ÙŠ Ù„Ù„ÙØªØ±Ø©: ${period}`);
        pushNotification('ØªÙ‚Ø±ÙŠØ± ØªØ´ØºÙŠÙ„ÙŠ', `ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ù„Ù„ÙØªØ±Ø© ${period}`);
        
        return Promise.resolve(report);
      },
      
      generateHRReport(period) {
        const startDate = new Date();
        if (period === 'month') {
          startDate.setMonth(startDate.getMonth() - 1);
        } else if (period === 'quarter') {
          startDate.setMonth(startDate.getMonth() - 3);
        } else if (period === 'year') {
          startDate.setFullYear(startDate.getFullYear() - 1);
        }
        
        const employees = DB.employees;
        const activeEmployees = employees.filter(e => e.status === 'active');
        const salaries = DB.salaries.filter(s => new Date(s.date) >= startDate);
        const leaves = DB.leaves.filter(l => new Date(l.createdAt) >= startDate);
        const evaluations = DB.evaluations.filter(e => new Date(e.date) >= startDate);
        const attendance = DB.attendance.filter(a => new Date(a.date) >= startDate);
        
        const totalSalary = salaries.reduce((sum, s) => sum + s.amount, 0);
        const avgSalary = salaries.length > 0 ? totalSalary / salaries.length : 0;
        const presentDays = attendance.filter(a => a.status === 'present').length;
        const totalDays = attendance.length;
        const attendanceRate = totalDays > 0 ? (presentDays / totalDays * 100).toFixed(2) : 0;
        
        const report = {
          id: 'REP' + Date.now(),
          type: 'hr',
          period,
          generatedAt: new Date().toISOString(),
          data: {
            totalEmployees: employees.length,
            activeEmployees: activeEmployees.length,
            totalSalary,
            avgSalary,
            leaveRequests: leaves.length,
            approvedLeaves: leaves.filter(l => l.status === 'approved').length,
            evaluations: evaluations.length,
            attendanceRate
          }
        };
        
        DB.reports.push(report);
        save();
        
        log(`ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ© Ù„Ù„ÙØªØ±Ø©: ${period}`);
        pushNotification('ØªÙ‚Ø±ÙŠØ± Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ©', `ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ù„Ù„ÙØªØ±Ø© ${period}`);
        
        return Promise.resolve(report);
      }
    };

    // ======================= Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© =======================
    function renderKPIs(){ 
      document.getElementById('k_deals').innerText = DB.deals.length; 
      const trucks = DB.deals.reduce((s,d)=> s + (d.trucks?d.trucks.length:0),0); 
      document.getElementById('k_trucks').innerText = trucks; 
      const rev = DB.deals.reduce((s,d)=> s + (Number(d.dealValue)||0),0); 
      document.getElementById('k_revenue').innerText = rev.toLocaleString() + ' Ø±.ÙŠ'; 
    }

    function renderActivity(){ 
      const el = document.getElementById('activityLog'); 
      el.innerHTML=''; 
      DB.activity.slice(0,100).forEach(a=>{ 
        const div=document.createElement('div'); 
        div.className='item'; 
        div.innerHTML = `<div style="font-size:12px;color:var(--muted)">${new Date(a.at).toLocaleString()}</div><div>${a.msg}</div>`; 
        el.appendChild(div); 
      }); 
    }

    function computeDealFinance(dealId){ 
      const d = DB.deals.find(x=>x.id===dealId); 
      const expectedRevenue = Number(d.dealValue||0); 
      const totalAdvances = d.trucks.reduce((s,t)=> s + (t.expensesAdvance||0),0); 
      const totalDiesel = d.trucks.reduce((s,t)=> s + (t.dieselAmount||0),0); 
      const totalCompanyRevenue = d.trucks.reduce((s,t)=> s + (t.companyRevenue||0),0); 
      const totalDriverPayouts = d.trucks.reduce((s,t)=> s + (t.rentAmount||0),0);
      
      const netProfit = Number((expectedRevenue + totalCompanyRevenue - totalAdvances - totalDiesel - totalDriverPayouts).toFixed(2)); 
      
      return {
        expectedRevenue,
        totalAdvances,
        totalDiesel,
        totalCompanyRevenue,
        totalDriverPayouts,
        netProfit
      }; 
    }

    function renderSystemTimeline(){ 
      const el = document.getElementById('systemTimeline'); 
      el.innerHTML=''; 
      const steps = ['ÙˆØµÙˆÙ„','ØªØ­Ù…ÙŠÙ„/ØªÙØ±ÙŠØº','Ù†Ù‚Ù„','ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…ÙŠÙ„','Ø§Ù„ÙÙˆØªØ±Ø©/Ø§Ù„Ø¥Ù‚ÙØ§Ù„']; 
      let totalScore=0,count=0; 
      
      DB.deals.forEach(d=>{ 
        let score=0; 
        const allDelivered = d.trucks.every(t=> t.delivered && t.clientConfirmed); 
        const someDelivered = d.trucks.some(t=> t.delivered && t.clientConfirmed); 
        if(d.loadedAt) score=1; 
        if(someDelivered) score=2; 
        if(allDelivered) score=3; 
        if(DB.invoices.some(i=> i.dealId===d.id)) score=4; 
        totalScore+=score; 
        count++; 
      }); 
      
      const avg = count? Math.round(totalScore/count):0; 
      steps.forEach((s,i)=>{ 
        const span = document.createElement('div'); 
        span.className='step'+(i<=avg? ' active':''); 
        span.innerText = s; 
        el.appendChild(span); 
      }); 
    }

    // ======================= Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¹Ø±Ø¶ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø© =======================
    function renderAdminList(){ 
      const container = document.getElementById('adminList'); 
      container.innerHTML = ''; 
      
      if(!DB.deals.length) {
        container.innerHTML = '<div class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙÙ‚Ø§Øª</div>';
        return;
      }
      
      DB.deals.forEach(d=>{
        const color = colorFromString(d.id);
        const wrap = document.createElement('div'); 
        wrap.className='item';
        
        const trucksSummary = d.trucks.map(t=> 
          `${t.truckNumber}(${t.driverName}) ${t.delivered? 'âœ…':'â³'}`
        ).join(' â€” ');
        
        const finance = computeDealFinance(d.id);
        const truckNames = d.trucks.map(t => t.truckNumber).join(' Ùˆ ');
        
        wrap.innerHTML = `
          <div class='deal-color-bar' style='background:${color}'></div>
          <div style='display:flex;justify-content:space-between;align-items:center'>
            <div>
              <strong>${d.dealNumber}</strong> â€” ${d.shipName}
              <div class='muted'>${d.companyName} â€¢ ${d.destination} â€¢ ${d.totalLoad} Ø·Ù† â€¢ ${d.pricePerTon} Ø±.ÙŠ/Ø·Ù†</div>
            </div>
            <div style='text-align:left'>
              <div class='muted'>${trucksSummary}</div>
              <div style='margin-top:8px'>
                <button class='btn' onclick="openDeal('${d.id}')">ØªÙØ§ØµÙŠÙ„</button> 
                <button class='btn primary' onclick="openAssign('${d.id}')">ØªØ¹ÙŠÙŠÙ† Ù‚Ø§Ø·Ø±Ø§Øª</button>
                <button class='btn info' onclick="openEditDealModal('${d.id}')">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØµÙÙ‚Ø©</button>
                <button class='btn success' onclick="TMS.matchAndInvoice('${d.id}').then(()=>{ renderAll(); pushNotification('ØªÙ… Ø§Ù„ÙÙˆØªØ±Ø©', 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© Ù„Ù„ØµÙÙ‚Ø©'); })">Ù…Ø·Ø§Ø¨Ù‚Ø© ÙˆÙÙˆØªØ±Ø©</button>
              </div>
            </div>
          </div>
          <div class='financial-summary'>
            <div><strong>Ø§Ù„Ø®Ù„Ø§ØµØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ©:</strong></div>
            <table class="financial-summary-table">
              <tr>
                <th>Ø§Ù„Ø¨Ù†Ø¯</th>
                <th class="value">Ø§Ù„Ù…Ø¨Ù„Øº (Ø±.ÙŠ)</th>
              </tr>
              <tr>
                <td>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø© Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„</td>
                <td class="value">${finance.expectedRevenue.toLocaleString()}</td>
              </tr>
              <tr>
                <td>Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ø³Ù„Ù Ù„Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†</td>
                <td class="value negative">- ${finance.totalAdvances.toLocaleString()}</td>
              </tr>
              <tr>
                <td>Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ø¯ÙŠØ²Ù„ Ù„Ù„Ù‚Ø§Ø·Ø±Ø§Øª</td>
                <td class="value negative">- ${finance.totalDiesel.toLocaleString()}</td>
              </tr>
              <tr>
                <td>Ø¥ÙŠØ±Ø§Ø¯ Ø§Ù„Ø´Ø±ÙƒØ© Ù…Ù† Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª ${truckNames}</td>
                <td class="value positive">+ ${finance.totalCompanyRevenue.toLocaleString()}</td>
              </tr>
              <tr>
                <td>Ø¥ÙŠØ¬Ø§Ø± Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª ${truckNames} (Ù…Ø¬Ù…ÙˆØ¹ Ø³Ø¹Ø± Ø§Ù„Ø·Ù† ÙÙŠ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø·Ù†Ø§Ù†)</td>
                <td class="value negative">- ${finance.totalDriverPayouts.toLocaleString()}</td>
              </tr>
              <tr style="background:#f8fafc; font-weight:700;">
                <td>ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹</td>
                <td class="value ${finance.netProfit >= 0 ? 'positive' : 'negative'}">${finance.netProfit.toLocaleString()}</td>
              </tr>
            </table>
          </div>
        `;
        container.appendChild(wrap);
      }); 
      
      renderSystemTimeline(); 
    }

    function renderDriverTasks(){ 
      const el = document.getElementById('driverTasks'); 
      el.innerHTML=''; 
      
      let hasTasks = false;
      
      DB.deals.forEach(d=>{
        d.trucks.forEach(t=>{
          hasTasks = true;
          let status = 'Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©';
          let statusClass = 'status-pending';
          
          if(t.clientConfirmed) {
              status = 'ØªÙ… Ø§Ù„ØªØ£ÙƒÙŠØ¯';
              statusClass = 'status-confirmed';
          } else if(t.delivered) {
              status = 'ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…';
              statusClass = 'status-delivered';
          } else if(t.startedAt) {
              status = 'ÙÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚';
              statusClass = 'status-started';
          } else if(t.driverAccepted) {
              status = 'ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©';
              statusClass = 'status-accepted';
          }

          const card = document.createElement('div'); 
          card.className='driver-card'; 
          card.innerHTML = `
              <div style='display:flex;justify-content:space-between;align-items:center'>
                  <div>
                      <strong>${t.truckNumber}</strong> â€” ${t.driverName}
                      <div class='muted'>ØµÙÙ‚Ø©: ${d.dealNumber} â€¢ ${d.companyName}</div>
                  </div>
                  <div style='display:flex;align-items:center;gap:8px'>
                      <span class="status-badge ${statusClass}">${status}</span>
                      <div class='muted'>Ø­Ù…ÙˆÙ„Ø©: ${t.load} Ø·Ù†</div>
                  </div>
              </div>
              <div style='margin-top:8px;display:flex;gap:8px'>
                  <button class='btn primary big-btn ${t.driverAccepted ? 'active' : ''}' 
                          onclick="apiAccept('${d.id}','${t.id}')"
                          ${t.driverAccepted ? 'disabled' : ''}>
                      ${t.driverAccepted ? 'âœ“ ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©' : 'Ù…ÙˆØ§ÙÙ‚'}
                  </button>
                  <button class='btn big-btn ${t.startedAt ? 'active' : ''}' 
                          onclick="apiStart('${d.id}','${t.id}')"
                          ${!t.driverAccepted || t.startedAt ? 'disabled' : ''}>
                      ${t.startedAt ? 'âœ“ Ø¨Ø¯Ø£Øª Ø§Ù„Ø±Ø­Ù„Ø©' : 'Ø¨Ø¯Ø¡ Ø§Ù„Ø±Ø­Ù„Ø©'}
                  </button>
                  <button class='btn warn big-btn ${t.delivered ? 'active' : ''}' 
                          onclick="apiUploadPOD('${d.id}','${t.id}')"
                          ${!t.startedAt || t.delivered ? 'disabled' : ''}>
                      ${t.delivered ? 'âœ“ ØªÙ… Ø±ÙØ¹ POD' : 'Ø±ÙØ¹ POD'}
                  </button>
              </div>
          `;
          el.appendChild(card);
        });
      }); 
      
      if (!hasTasks) {
        el.innerHTML = '<div class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ø­Ø§Ù„ÙŠØ§Ù‹</div>';
      }
      
      renderDriverHistory(); 
    }

    function renderDriverHistory(){ 
      const el = document.getElementById('driverHistory'); 
      el.innerHTML=''; 
      
      let hasHistory = false;
      
      DB.deals.forEach(d=> d.trucks.forEach(t=>{ 
        if (t.acceptedAt || t.delivered) {
          hasHistory = true;
          const div = document.createElement('div'); 
          div.className='item'; 
          div.innerHTML = `<div><strong>${t.truckNumber}</strong> â€” ${t.driverName}</div><div class='muted'>${t.acceptedAt? 'Ù…ÙˆØ§ÙÙ‚Ø©: '+new Date(t.acceptedAt).toLocaleString() : ''} ${t.delivered? ' â€¢ ØªÙØ±ÙŠØº: '+new Date(t.deliveredAt).toLocaleString():''}</div>`; 
          el.appendChild(div); 
        }
      })); 
      
      if (!hasHistory) {
        el.innerHTML = '<div class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„ Ù…Ù‡Ø§Ù… Ø³Ø§Ø¨Ù‚Ø©</div>';
      }
    }

    function renderClientNotifications(){ 
      const el = document.getElementById('clientNotifications'); 
      el.innerHTML=''; 
      const clientNotifs = DB.notifications.filter(n=> n.type==='client_confirm'); 
      if(!clientNotifs.length) return el.innerHTML = '<div class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</div>';
      
      clientNotifs.forEach(n=>{ 
        const d = DB.deals.find(x=>x.id===n.dealId); 
        const t = d.trucks.find(x=>x.id===n.truckId); 
        const item = document.createElement('div'); 
        item.className='item'; 
        item.innerHTML = `
            <div>
                <strong>ÙˆØµÙ„Øª Ù‚Ø§Ø·Ø±Ø© ${t.truckNumber}</strong>
                <div class='muted'>Ø§Ù„ØµÙÙ‚Ø©: ${d.dealNumber} â€” Ø§Ù„Ø³Ø§Ø¦Ù‚: ${t.driverName} â€” ${t.load} Ø·Ù†</div>
            </div>
            <div style='text-align:left;margin-top:8px'>
                <button class='btn primary ${t.clientConfirmed ? 'active' : ''}' 
                        onclick="apiClientConfirm('${d.id}','${t.id}')"
                        ${t.clientConfirmed ? 'disabled' : ''}>
                    ${t.clientConfirmed ? 'âœ“ ØªÙ… Ø§Ù„ØªØ£ÙƒÙŠØ¯' : 'ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…'}
                </button>
            </div>
        `; 
        el.appendChild(item); 
      }); 
      renderClientHistory(); 
    }

    function renderClientHistory(){ 
      const el = document.getElementById('clientHistory'); 
      el.innerHTML=''; 
      
      let hasHistory = false;
      
      DB.deals.forEach(d=> d.trucks.forEach(t=>{ 
        if(t.clientConfirmed){ 
          hasHistory = true;
          const div=document.createElement('div'); 
          div.className='item'; 
          div.innerHTML = `<div><strong>${d.dealNumber}</strong> â€” Ù‚Ø§Ø·Ø±Ø© ${t.truckNumber}</div><div class='muted'>ØªÙ… Ø§Ù„ØªØ£ÙƒÙŠØ¯: ${new Date(t.clientConfirmedAt).toLocaleString()}</div>`; 
          el.appendChild(div); 
        } 
      })); 
      
      if (!hasHistory) {
        el.innerHTML = '<div class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ³Ù„ÙŠÙ…Ø§Øª Ø³Ø§Ø¨Ù‚Ø©</div>';
      }
    }

    function renderAgentTasks(){ 
      const el = document.getElementById('agentTasks'); 
      el.innerHTML=''; 
      
      let hasTasks = false;
      
      DB.deals.forEach(d=>{ 
        if(!d.loadedAt){ 
          hasTasks = true;
          const item = document.createElement('div'); 
          item.className='item'; 
          item.innerHTML = `
              <div>
                  <strong>${d.dealNumber}</strong>
                  <div class='muted'>${d.shipName} â€” ${d.companyName}</div>
              </div>
              <div style='text-align:left;margin-top:8px'>
                  <button class='btn primary ${d.loadedAt ? 'active' : ''}' 
                          onclick="apiAgentLoad('${d.id}')"
                          ${d.loadedAt ? 'disabled' : ''}>
                      ${d.loadedAt ? 'âœ“ ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„' : 'ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„/Ø§Ù„Ø§Ø³ØªØ¹Ø¯Ø§Ø¯'}
                  </button>
              </div>
          `; 
          el.appendChild(item); 
        } 
      }); 
      
      if (!hasTasks) {
        el.innerHTML = '<div class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ø­Ø§Ù„ÙŠØ§Ù‹</div>';
      }
      
      renderAgentHistory(); 
    }

    function renderAgentHistory(){ 
      const el = document.getElementById('agentHistory'); 
      el.innerHTML=''; 
      
      let hasHistory = false;
      
      DB.deals.forEach(d=>{ 
        if(d.loadedAt){ 
          hasHistory = true;
          const div=document.createElement('div'); 
          div.className='item'; 
          div.innerHTML=`<div><strong>${d.dealNumber}</strong></div><div class='muted'>ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„: ${new Date(d.loadedAt).toLocaleString()}</div>`; 
          el.appendChild(div); 
        } 
      }); 
      
      if (!hasHistory) {
        el.innerHTML = '<div class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ³Ø¬ÙŠÙ„Ø§Øª Ù…ÙŠØ¯Ø§Ù†ÙŠØ© Ø³Ø§Ø¨Ù‚Ø©</div>';
      }
    }

    function renderInvoices(){ 
      const el = document.getElementById('invoicesPanel'); 
      el.innerHTML=''; 
      if(!DB.invoices.length) return el.innerHTML = '<div class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙÙˆØ§ØªÙŠØ±</div>'; 
      let html = '<table><thead><tr><th>Ø§Ù„Ø±Ù‚Ù…</th><th>Ø§Ù„ØµÙÙ‚Ø©</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th><th>Ø§Ù„Ù…Ø¯ÙÙˆØ¹</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr></thead><tbody>';
      DB.invoices.forEach(inv=>{ 
        const d = DB.deals.find(x=>x.id===inv.dealId) || {}; 
        html += `<tr><td>${inv.id}</td><td>${d.dealNumber||'â€”'}</td><td>${inv.amount.toLocaleString()} Ø±.ÙŠ</td><td>${(inv.paid||0).toLocaleString()} Ø±.ÙŠ</td><td>${inv.status}</td><td><button class='btn' onclick="apiRecordPayment('${inv.id}')">ØªØ³Ø¬ÙŠÙ„ Ø¯ÙØ¹</button></td></tr>`; 
      }); 
      html += '</tbody></table>'; 
      el.innerHTML = html; 
    }

    // ======================= Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¹Ø±Ø¶ Ù„Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© =======================
    function renderHRDashboard() {
      renderEmployeesTab();
      renderSalariesTab();
      renderLeavesTab();
      renderEvaluationsTab();
      renderAttendanceTab();
    }
    
    function renderEmployeesTab() {
      const container = document.getElementById('tab-employees');
      container.innerHTML = '';
      
      if (!DB.employees.length) {
        container.innerHTML = '<div class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ¸ÙÙŠÙ†</div>';
        return;
      }
      
      DB.employees.forEach(employee => {
        const card = document.createElement('div');
        card.className = 'employee-card';
        
        let permissionBadge = '';
        if (employee.permission === 'admin') {
          permissionBadge = '<span class="permission-badge permission-admin">Ù…Ø¯ÙŠØ±</span>';
        } else if (employee.permission === 'supervisor') {
          permissionBadge = '<span class="permission-badge permission-supervisor">Ù…Ø´Ø±Ù</span>';
        } else if (employee.permission === 'driver') {
          permissionBadge = '<span class="permission-badge permission-driver">Ø³Ø§Ø¦Ù‚</span>';
        } else if (employee.permission === 'finance') {
          permissionBadge = '<span class="permission-badge permission-finance">Ù…Ø§Ù„ÙŠ</span>';
        }
        
        card.innerHTML = `
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <strong>${employee.name}</strong> ${permissionBadge}
              <div class="muted">${employee.position} â€¢ ${employee.department}</div>
              <div class="muted">${employee.phone} â€¢ ${employee.email}</div>
            </div>
            <div>
              <span class="status-badge ${employee.status === 'active' ? 'status-accepted' : 'status-pending'}">
                ${employee.status === 'active' ? 'Ù†Ø´Ø·' : 'ØºÙŠØ± Ù†Ø´Ø·'}
              </span>
              <div style="margin-top:8px">
                <button class="btn" onclick="openEmployeeDetails('${employee.id}')">ØªÙØ§ØµÙŠÙ„</button>
                <button class="btn primary" onclick="openEditEmployeeModal('${employee.id}')">ØªØ¹Ø¯ÙŠÙ„</button>
              </div>
            </div>
          </div>
        `;
        container.appendChild(card);
      });
    }
    
    function renderSalariesTab() {
      const container = document.getElementById('tab-salaries');
      container.innerHTML = '';
      
      if (!DB.salaries.length) {
        container.innerHTML = '<div class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª Ø±ÙˆØ§ØªØ¨</div>';
        return;
      }
      
      let html = '<table><thead><tr><th>Ø§Ù„Ù…ÙˆØ¸Ù</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ù†ÙˆØ¹ Ø§Ù„Ø±Ø§ØªØ¨</th><th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th></tr></thead><tbody>';
      
      DB.salaries.slice(0, 20).forEach(salary => {
        html += `
          <tr>
            <td>${salary.employeeName}</td>
            <td>${salary.amount.toLocaleString()} Ø±.ÙŠ</td>
            <td>${new Date(salary.date).toLocaleDateString()}</td>
            <td>${salary.type || 'Ø±Ø¦ÙŠØ³ÙŠ'}</td>
            <td>${salary.notes || '-'}</td>
          </tr>
        `;
      });
      
      html += '</tbody></table>';
      container.innerHTML = html;
    }
    
    function renderLeavesTab() {
      const container = document.getElementById('tab-leaves');
      container.innerHTML = '';
      
      if (!DB.leaves.length) {
        container.innerHTML = '<div class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¥Ø¬Ø§Ø²Ø©</div>';
        return;
      }
      
      DB.leaves.forEach(leave => {
        const card = document.createElement('div');
        card.className = 'employee-card';
        
        let statusClass = 'status-pending';
        if (leave.status === 'approved') statusClass = 'status-accepted';
        else if (leave.status === 'rejected') statusClass = 'status-delivered';
        
        card.innerHTML = `
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <strong>${leave.employeeName}</strong>
              <div class="muted">${leave.type} â€¢ Ù…Ù† ${new Date(leave.startDate).toLocaleDateString()} Ø¥Ù„Ù‰ ${new Date(leave.endDate).toLocaleDateString()}</div>
              <div class="muted">${leave.reason || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª'}</div>
            </div>
            <div>
              <span class="status-badge ${statusClass}">
                ${leave.status === 'pending' ? 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©' : leave.status === 'approved' ? 'Ù…Ù‚Ø¨ÙˆÙ„' : 'Ù…Ø±ÙÙˆØ¶'}
              </span>
              <div style="margin-top:8px">
                <button class="btn primary" onclick="updateLeaveStatus('${leave.id}', 'approved')" ${leave.status !== 'pending' ? 'disabled' : ''}>Ù‚Ø¨ÙˆÙ„</button>
                <button class="btn danger" onclick="updateLeaveStatus('${leave.id}', 'rejected')" ${leave.status !== 'pending' ? 'disabled' : ''}>Ø±ÙØ¶</button>
              </div>
            </div>
          </div>
        `;
        container.appendChild(card);
      });
    }
    
    function renderEvaluationsTab() {
      const container = document.getElementById('tab-evaluations');
      container.innerHTML = '';
      
      if (!DB.evaluations.length) {
        container.innerHTML = '<div class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª</div>';
        return;
      }
      
      DB.evaluations.forEach(evaluation => {
        const card = document.createElement('div');
        card.className = 'employee-card';
        card.innerHTML = `
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <strong>${evaluation.employeeName}</strong>
              <div class="muted">Ø§Ù„ØªÙ‚ÙŠÙŠÙ…: ${evaluation.rating}/5 â€¢ ${new Date(evaluation.date).toLocaleDateString()}</div>
              <div class="muted">${evaluation.comments || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª'}</div>
            </div>
            <div>
              <button class="btn" onclick="openEvaluationDetails('${evaluation.id}')">ØªÙØ§ØµÙŠÙ„</button>
            </div>
          </div>
        `;
        container.appendChild(card);
      });
    }
    
    function renderAttendanceTab() {
      const container = document.getElementById('tab-attendance');
      container.innerHTML = '';
      
      const today = new Date().toISOString().split('T')[0];
      const todayAttendance = DB.attendance.filter(a => a.date === today);
      
      container.innerHTML = `
        <div class="panel">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div><strong>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ù„ÙŠÙˆÙ… ${today}</strong></div>
            <div>
              <button class="btn primary" onclick="openBulkAttendanceModal()">ØªØ³Ø¬ÙŠÙ„ Ø¬Ù…Ø§Ø¹ÙŠ</button>
            </div>
          </div>
          
          <div style="margin-top:12px">
            ${DB.employees.filter(e => e.status === 'active').map(employee => {
              const todayRecord = todayAttendance.find(a => a.employeeId === employee.id);
              let status = todayRecord ? todayRecord.status : 'Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„';
              let statusClass = 'status-pending';
              
              if (status === 'present') statusClass = 'status-accepted';
              else if (status === 'absent') statusClass = 'status-delivered';
              else if (status === 'late') statusClass = 'status-started';
              
              return `
                <div class="employee-card">
                  <div style="display:flex;justify-content:space-between;align-items:center">
                    <div>
                      <strong>${employee.name}</strong>
                      <div class="muted">${employee.position} â€¢ ${employee.department}</div>
                    </div>
                    <div style="display:flex;align-items:center;gap:8px">
                      <span class="status-badge ${statusClass}">${status}</span>
                      <div style="display:flex;gap:4px">
                        <button class="btn success" onclick="HR.recordAttendance('${employee.id}', 'present', '${today}').then(() => renderHRDashboard())">Ø­Ø§Ø¶Ø±</button>
                        <button class="btn warn" onclick="HR.recordAttendance('${employee.id}', 'late', '${today}').then(() => renderHRDashboard())">Ù…ØªØ£Ø®Ø±</button>
                        <button class="btn danger" onclick="HR.recordAttendance('${employee.id}', 'absent', '${today}').then(() => renderHRDashboard())">ØºØ§Ø¦Ø¨</button>
                      </div>
                    </div>
                  </div>
                </div>
              `;
            }).join('')}
          </div>
        </div>
        
        <div class="panel" style="margin-top:16px">
          <div><strong>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø­Ø¶ÙˆØ±</strong></div>
          <div class="stats-grid" style="margin-top:12px">
            <div class="stat-card primary">
              <div class="muted">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</div>
              <div class="value">${DB.employees.filter(e => e.status === 'active').length}</div>
            </div>
            <div class="stat-card success">
              <div class="muted">Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…</div>
              <div class="value">${todayAttendance.filter(a => a.status === 'present').length}</div>
            </div>
            <div class="stat-card warning">
              <div class="muted">Ø§Ù„ØªØ£Ø®Ø± Ø§Ù„ÙŠÙˆÙ…</div>
              <div class="value">${todayAttendance.filter(a => a.status === 'late').length}</div>
            </div>
            <div class="stat-card danger">
              <div class="muted">Ø§Ù„ØºÙŠØ§Ø¨ Ø§Ù„ÙŠÙˆÙ…</div>
              <div class="value">${todayAttendance.filter(a => a.status === 'absent').length}</div>
            </div>
          </div>
        </div>
      `;
    }

    // ======================= Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¹Ø±Ø¶ Ù„Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© =======================
    function renderAccountantDashboard() {
      renderOverviewTab();
      renderTransactionsTab();
      renderLedgerTab();
      renderBudgetTab();
      renderTaxesTab();
    }
    
    function renderOverviewTab() {
      const container = document.getElementById('tab-overview');
      
      const income = DB.transactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
      const expenses = DB.transactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0);
      const balance = income - expenses;
      
      const balanceSheet = ACCOUNTING.getBalanceSheet();
      
      container.innerHTML = `
        <div class="stats-grid">
          <div class="stat-card primary">
            <div class="muted">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</div>
            <div class="value">${income.toLocaleString()} Ø±.ÙŠ</div>
          </div>
          <div class="stat-card danger">
            <div class="muted">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</div>
            <div class="value">${expenses.toLocaleString()} Ø±.ÙŠ</div>
          </div>
          <div class="stat-card success">
            <div class="muted">ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­</div>
            <div class="value">${balance.toLocaleString()} Ø±.ÙŠ</div>
          </div>
          <div class="stat-card warning">
            <div class="muted">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆÙ„</div>
            <div class="value">${balanceSheet.assets.toLocaleString()} Ø±.ÙŠ</div>
          </div>
        </div>
        
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:16px">
          <div class="panel">
            <div><strong>Ø¢Ø®Ø± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª</strong></div>
            <div class="list" style="max-height:200px">
              ${DB.transactions.slice(0, 5).map(t => `
                <div class="item">
                  <div style="display:flex;justify-content:space-between">
                    <div>${t.description}</div>
                    <div style="color:${t.type === 'income' ? 'var(--success)' : 'var(--danger)'}">
                      ${t.type === 'income' ? '+' : '-'}${t.amount.toLocaleString()} Ø±.ÙŠ
                    </div>
                  </div>
                  <div class="muted">${new Date(t.date).toLocaleDateString()}</div>
                </div>
              `).join('')}
            </div>
          </div>
          
          <div class="panel">
            <div><strong>Ø§Ù„ÙÙˆØ§ØªÙŠØ±</strong></div>
            <div class="list" style="max-height:200px">
              ${DB.invoices.slice(0, 5).map(i => `
                <div class="item">
                  <div style="display:flex;justify-content:space-between">
                    <div>${i.id}</div>
                    <div>${i.amount.toLocaleString()} Ø±.ÙŠ</div>
                  </div>
                  <div class="muted">${i.status === 'paid' ? 'Ù…Ø¯ÙÙˆØ¹Ø©' : 'ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹Ø©'}</div>
                </div>
              `).join('')}
            </div>
          </div>
        </div>
        
        <div class="panel" style="margin-top:16px">
          <div><strong>ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ÙˆØ§Ù„Ø®Ø³Ø§Ø¦Ø±</strong></div>
          <div style="margin-top:12px">
            <button class="btn primary" onclick="generateProfitLossReport()">Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ÙˆØ§Ù„Ø®Ø³Ø§Ø¦Ø±</button>
            <button class="btn success" onclick="generateBalanceSheet()">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ©</button>
          </div>
        </div>
      `;
    }
    
    function renderTransactionsTab() {
      const container = document.getElementById('tab-transactions');
      container.innerHTML = '';
      
      if (!DB.transactions.length) {
        container.innerHTML = '<div class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§Øª</div>';
        return;
      }
      
      let html = '<table><thead><tr><th>Ø§Ù„ÙˆØµÙ</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„ÙØ¦Ø©</th></tr></thead><tbody>';
      
      DB.transactions.slice(0, 20).forEach(transaction => {
        html += `
          <tr>
            <td>${transaction.description}</td>
            <td>
              <span class="status-badge ${transaction.type === 'income' ? 'status-accepted' : 'status-pending'}">
                ${transaction.type === 'income' ? 'Ø¥ÙŠØ±Ø§Ø¯' : 'Ù…ØµØ±ÙˆÙ'}
              </span>
            </td>
            <td>${transaction.amount.toLocaleString()} Ø±.ÙŠ</td>
            <td>${new Date(transaction.date).toLocaleDateString()}</td>
            <td>${transaction.category || '-'}</td>
          </tr>
        `;
      });
      
      html += '</tbody></table>';
      container.innerHTML = html;
    }
    
    function renderLedgerTab() {
      const container = document.getElementById('tab-ledger');
      container.innerHTML = '';
      
      if (!DB.ledger.length) {
        container.innerHTML = '<div class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚ÙŠÙˆØ¯ ÙÙŠ Ø¯ÙØªØ± Ø§Ù„Ø£Ø³ØªØ§Ø°</div>';
        return;
      }
      
      let html = '<div class="list" style="max-height:500px">';
      
      DB.ledger.slice(0, 50).forEach(entry => {
        const fromAccount = DB.accounts[entry.fromAccount]?.name || entry.fromAccount;
        const toAccount = DB.accounts[entry.toAccount]?.name || entry.toAccount;
        
        html += `
          <div class="ledger-entry ${entry.type === 'income' ? 'credit' : 'debit'}">
            <div style="display:flex;justify-content:space-between">
              <div>
                <strong>${entry.desc}</strong>
                <div class="muted">${new Date(entry.date).toLocaleString()}</div>
              </div>
              <div style="color:${entry.type === 'income' ? 'var(--success)' : 'var(--danger)'}">
                ${entry.type === 'income' ? '+' : '-'}${entry.amount.toLocaleString()} Ø±.ÙŠ
              </div>
            </div>
            <div class="muted" style="margin-top:4px">
              Ù…Ù†: ${fromAccount} â†’ Ø¥Ù„Ù‰: ${toAccount}
            </div>
          </div>
        `;
      });
      
      html += '</div>';
      container.innerHTML = html;
    }
    
    function renderBudgetTab() {
      const container = document.getElementById('tab-budget');
      
      container.innerHTML = `
        <div class="panel">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div><strong>Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©</strong></div>
            <div>
              <button class="btn primary" onclick="openUpdateBudgetModal()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</button>
            </div>
          </div>
          
          <div style="margin-top:12px">
            <div class="stats-grid">
              <div class="stat-card success">
                <div class="muted">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</div>
                <div class="value">${DB.budget.income.toLocaleString()} Ø±.ÙŠ</div>
              </div>
              <div class="stat-card danger">
                <div class="muted">Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</div>
                <div class="value">${DB.budget.expenses.toLocaleString()} Ø±.ÙŠ</div>
              </div>
              <div class="stat-card primary">
                <div class="muted">Ø§Ù„Ø±ØµÙŠØ¯</div>
                <div class="value">${DB.budget.balance.toLocaleString()} Ø±.ÙŠ</div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="panel" style="margin-top:16px">
          <div><strong>ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</strong></div>
          <div style="margin-top:8px">
            <div class="muted">Ù†Ø³Ø¨Ø© Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª Ø¥Ù„Ù‰ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª: ${DB.budget.income > 0 ? ((DB.budget.expenses / DB.budget.income) * 100).toFixed(2) : 0}%</div>
            <div class="muted">Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­: ${DB.budget.income > 0 ? ((DB.budget.balance / DB.budget.income) * 100).toFixed(2) : 0}%</div>
          </div>
          
          <div class="chart-container">
            <canvas id="budgetChart"></canvas>
          </div>
        </div>
      `;
      
      // Ø±Ø³Ù… Ù…Ø®Ø·Ø· Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©
      setTimeout(() => {
        const ctx = document.getElementById('budgetChart').getContext('2d');
        new Chart(ctx, {
          type: 'doughnut',
          data: {
            labels: ['Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª', 'Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª'],
            datasets: [{
              data: [DB.budget.income, DB.budget.expenses],
              backgroundColor: ['#4cc9f0', '#f94144'],
              borderWidth: 2
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: 'bottom'
              }
            }
          }
        });
      }, 100);
    }
    
    function renderTaxesTab() {
      const container = document.getElementById('tab-taxes');
      container.innerHTML = '';
      
      if (!DB.taxes.length) {
        container.innerHTML = '<div class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª Ø¶Ø±ÙŠØ¨ÙŠØ©</div>';
        return;
      }
      
      let html = '<table><thead><tr><th>Ø§Ù„ÙˆØµÙ</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th></tr></thead><tbody>';
      
      DB.taxes.slice(0, 20).forEach(tax => {
        html += `
          <tr>
            <td>${tax.description}</td>
            <td>${tax.amount.toLocaleString()} Ø±.ÙŠ</td>
            <td>${new Date(tax.date).toLocaleDateString()}</td>
            <td>${tax.type || '-'}</td>
            <td>
              <span class="status-badge ${tax.status === 'paid' ? 'status-accepted' : 'status-pending'}">
                ${tax.status === 'paid' ? 'Ù…Ø¯ÙÙˆØ¹Ø©' : 'ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹Ø©'}
              </span>
            </td>
          </tr>
        `;
      });
      
      html += '</tbody></table>';
      container.innerHTML = html;
    }

    // ======================= Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¹Ø±Ø¶ Ù„Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© =======================
    function renderReportsDashboard() {
      renderFinancialReportsTab();
      renderOperationalReportsTab();
      renderHRReportsTab();
      renderCustomReportsTab();
    }
    
    function renderFinancialReportsTab() {
      const container = document.getElementById('tab-financial');
      
      container.innerHTML = `
        <div class="panel">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div><strong>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©</strong></div>
            <div>
              <button class="btn primary" onclick="REPORTS.generateFinancialReport('month').then(() => renderReportsDashboard())">ØªÙ‚Ø±ÙŠØ± Ø´Ù‡Ø±ÙŠ</button>
              <button class="btn primary" onclick="REPORTS.generateFinancialReport('quarter').then(() => renderReportsDashboard())">ØªÙ‚Ø±ÙŠØ± Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ</button>
              <button class="btn primary" onclick="REPORTS.generateFinancialReport('year').then(() => renderReportsDashboard())">ØªÙ‚Ø±ÙŠØ± Ø³Ù†ÙˆÙŠ</button>
            </div>
          </div>
          
          <div style="margin-top:12px">
            ${DB.reports.filter(r => r.type === 'financial').slice(0, 5).map(report => `
              <div class="report-card">
                <div style="display:flex;justify-content:space-between;align-items:center">
                  <div>
                    <strong>ØªÙ‚Ø±ÙŠØ± Ù…Ø§Ù„ÙŠ - ${report.period}</strong>
                    <div class="muted">${new Date(report.generatedAt).toLocaleDateString()}</div>
                  </div>
                  <div>
                    <button class="btn" onclick="openReportDetails('${report.id}')">Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</button>
                  </div>
                </div>
                <div style="margin-top:8px">
                  <div class="muted">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª: ${report.data.income.toLocaleString()} Ø±.ÙŠ â€¢ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª: ${report.data.expenses.toLocaleString()} Ø±.ÙŠ â€¢ ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­: ${report.data.netProfit.toLocaleString()} Ø±.ÙŠ</div>
                </div>
              </div>
            `).join('')}
          </div>
        </div>
      `;
    }
    
    function renderOperationalReportsTab() {
      const container = document.getElementById('tab-operational');
      
      container.innerHTML = `
        <div class="panel">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div><strong>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©</strong></div>
            <div>
              <button class="btn primary" onclick="REPORTS.generateOperationalReport('month').then(() => renderReportsDashboard())">ØªÙ‚Ø±ÙŠØ± Ø´Ù‡Ø±ÙŠ</button>
              <button class="btn primary" onclick="REPORTS.generateOperationalReport('quarter').then(() => renderReportsDashboard())">ØªÙ‚Ø±ÙŠØ± Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ</button>
              <button class="btn primary" onclick="REPORTS.generateOperationalReport('year').then(() => renderReportsDashboard())">ØªÙ‚Ø±ÙŠØ± Ø³Ù†ÙˆÙŠ</button>
            </div>
          </div>
          
          <div style="margin-top:12px">
            ${DB.reports.filter(r => r.type === 'operational').slice(0, 5).map(report => `
              <div class="report-card">
                <div style="display:flex;justify-content:space-between;align-items:center">
                  <div>
                    <strong>ØªÙ‚Ø±ÙŠØ± ØªØ´ØºÙŠÙ„ÙŠ - ${report.period}</strong>
                    <div class="muted">${new Date(report.generatedAt).toLocaleDateString()}</div>
                  </div>
                  <div>
                    <button class="btn" onclick="openReportDetails('${report.id}')">Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</button>
                  </div>
                </div>
                <div style="margin-top:8px">
                  <div class="muted">Ø§Ù„ØµÙÙ‚Ø§Øª: ${report.data.totalDeals} â€¢ Ù…ÙƒØªÙ…Ù„Ø©: ${report.data.completedDeals} â€¢ Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²: ${report.data.completionRate}%</div>
                </div>
              </div>
            `).join('')}
          </div>
        </div>
      `;
    }
    
    function renderHRReportsTab() {
      const container = document.getElementById('tab-hr');
      
      container.innerHTML = `
        <div class="panel">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div><strong>ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</strong></div>
            <div>
              <button class="btn primary" onclick="REPORTS.generateHRReport('month').then(() => renderReportsDashboard())">ØªÙ‚Ø±ÙŠØ± Ø´Ù‡Ø±ÙŠ</button>
              <button class="btn primary" onclick="REPORTS.generateHRReport('quarter').then(() => renderReportsDashboard())">ØªÙ‚Ø±ÙŠØ± Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ</button>
              <button class="btn primary" onclick="REPORTS.generateHRReport('year').then(() => renderReportsDashboard())">ØªÙ‚Ø±ÙŠØ± Ø³Ù†ÙˆÙŠ</button>
            </div>
          </div>
          
          <div style="margin-top:12px">
            ${DB.reports.filter(r => r.type === 'hr').slice(0, 5).map(report => `
              <div class="report-card">
                <div style="display:flex;justify-content:space-between;align-items:center">
                  <div>
                    <strong>ØªÙ‚Ø±ÙŠØ± Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ© - ${report.period}</strong>
                    <div class="muted">${new Date(report.generatedAt).toLocaleDateString()}</div>
                  </div>
                  <div>
                    <button class="btn" onclick="openReportDetails('${report.id}')">Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</button>
                  </div>
                </div>
                <div style="margin-top:8px">
                  <div class="muted">Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†: ${report.data.totalEmployees} â€¢ Ù†Ø´Ø·ÙŠÙ†: ${report.data.activeEmployees} â€¢ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨: ${report.data.totalSalary.toLocaleString()} Ø±.ÙŠ</div>
                </div>
              </div>
            `).join('')}
          </div>
        </div>
      `;
    }
    
    function renderCustomReportsTab() {
      const container = document.getElementById('tab-custom');
      
      container.innerHTML = `
        <div class="panel">
          <div><strong>ØªÙ‚Ø§Ø±ÙŠØ± Ù…Ø®ØµØµØ©</strong></div>
          <div style="margin-top:12px">
            <div class="muted">ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø§Ø±ÙŠØ± Ù…Ø®ØµØµØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ Ø§Ù„Ø®Ø§ØµØ©</div>
            
            <div style="margin-top:12px">
              <button class="btn primary" onclick="generateCustomReport()">Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ù…Ø®ØµØµ</button>
            </div>
          </div>
        </div>
        
        <div class="panel" style="margin-top:16px">
          <div><strong>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</strong></div>
          <div style="margin-top:8px">
            ${DB.reports.filter(r => r.type === 'custom').slice(0, 5).map(report => `
              <div class="report-card">
                <div style="display:flex;justify-content:space-between;align-items:center">
                  <div>
                    <strong>${report.title || 'ØªÙ‚Ø±ÙŠØ± Ù…Ø®ØµØµ'}</strong>
                    <div class="muted">${new Date(report.generatedAt).toLocaleDateString()}</div>
                  </div>
                  <div>
                    <button class="btn" onclick="openReportDetails('${report.id}')">Ø¹Ø±Ø¶</button>
                  </div>
                </div>
              </div>
            `).join('')}
          </div>
        </div>
      `;
    }

    // ======================= Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¹Ø±Ø¶ Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ø¨Ø§Ù„Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬ =======================
    function renderAccountingDashboard() {
      renderAccountingDashboardTab();
      renderAccountsTab();
      renderJournalTab();
      renderLedgerTab();
      renderTrialBalanceTab();
      renderReconcileTab();
    }
    
    function renderAccountingDashboardTab() {
      const container = document.getElementById('tab-dashboard');
      
      const totalAccounts = Object.keys(DB.accounts).length;
      const totalJournalEntries = DB.journal.length;
      const totalInvoices = DB.invoices.length;
      const totalPayments = DB.payments.length;
      
      container.innerHTML = `
        <h2>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©</h2>
        <div class="stats-grid">
          <div class="stat-card primary">
            <div class="muted">Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</div>
            <div class="value">${totalAccounts}</div>
          </div>
          <div class="stat-card success">
            <div class="muted">Ù‚ÙŠÙˆØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</div>
            <div class="value">${totalJournalEntries}</div>
          </div>
          <div class="stat-card warning">
            <div class="muted">Ø§Ù„ÙÙˆØ§ØªÙŠØ±</div>
            <div class="value">${totalInvoices}</div>
          </div>
          <div class="stat-card danger">
            <div class="muted">Ø§Ù„Ø¯ÙØ¹Ø§Øª</div>
            <div class="value">${totalPayments}</div>
          </div>
        </div>
        
        <div class="panel" style="margin-top:16px">
          <div><strong>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</strong></div>
          <div style="margin-top:12px" class="controls">
            <button class="btn primary" onclick="uiCreateAccount()">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</button>
            <button class="btn success" onclick="uiIssueInvoice()">Ø¥ØµØ¯Ø§Ø± ÙØ§ØªÙˆØ±Ø©</button>
            <button class="btn info" onclick="uiRecordPayment()">ØªØ³Ø¬ÙŠÙ„ Ø¯ÙØ¹Ø©</button>
            <button class="btn dark" onclick="uiCreateDeal()">Ø¥Ù†Ø´Ø§Ø¡ ØµÙÙ‚Ø©</button>
          </div>
        </div>
        
        <div class="panel" style="margin-top:16px">
          <div><strong>Ø¢Ø®Ø± Ù‚ÙŠÙˆØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</strong></div>
          <div class="list" style="max-height:300px;margin-top:12px">
            ${DB.journal.slice(0, 10).map(entry => `
              <div class="item">
                <div style="display:flex;justify-content:space-between">
                  <div>
                    <strong>${entry.description}</strong>
                    <div class="muted">${new Date(entry.date).toLocaleString()}</div>
                  </div>
                  <div>
                    <div class="muted">${entry.lines.length} Ø³Ø·Ø±</div>
                  </div>
                </div>
              </div>
            `).join('')}
          </div>
        </div>
      `;
    }
    
    function renderAccountsTab() {
      const container = document.getElementById('tab-accounts');
      
      container.innerHTML = `
        <h2>Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</h2>
        <button class="btn primary" onclick="uiCreateAccount()">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</button>
        <table style="margin-top:12px">
          <thead>
            <tr>
              <th>Ø§Ù„ÙƒÙˆØ¯</th>
              <th>Ø§Ù„Ø§Ø³Ù…</th>
              <th>Ø§Ù„Ù†ÙˆØ¹</th>
              <th>Ø§Ù„Ø±ØµÙŠØ¯</th>
            </tr>
          </thead>
          <tbody>
            ${Object.values(DB.accounts).map(account => `
              <tr>
                <td>${account.code}</td>
                <td>${account.name}</td>
                <td>
                  <span class="status-badge ${
                    account.type === 'asset' ? 'status-accepted' : 
                    account.type === 'liability' ? 'status-delivered' : 
                    account.type === 'income' ? 'status-confirmed' : 
                    account.type === 'expense' ? 'status-pending' : 'status-started'
                  }">
                    ${account.type === 'asset' ? 'Ø£ØµÙˆÙ„' : 
                      account.type === 'liability' ? 'Ø§Ù„ØªØ²Ø§Ù…Ø§Øª' : 
                      account.type === 'income' ? 'Ø¥ÙŠØ±Ø§Ø¯Ø§Øª' : 
                      account.type === 'expense' ? 'Ù…ØµØ±ÙˆÙØ§Øª' : 'Ø­Ù‚ÙˆÙ‚ Ù…Ù„ÙƒÙŠØ©'}
                  </span>
                </td>
                <td>${fmt(account.balance || 0)} Ø±.ÙŠ</td>
              </tr>
            `).join('')}
          </tbody>
        </table>
      `;
    }
    
    function renderJournalTab() {
      const container = document.getElementById('tab-journal');
      
      container.innerHTML = `
        <h2>Ù‚ÙŠÙˆØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h2>
        <div class="muted">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${DB.journal.length} Ù‚ÙŠØ¯</div>
        <table style="margin-top:12px">
          <thead>
            <tr>
              <th>Ø§Ù„Ø±Ù‚Ù…</th>
              <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
              <th>Ø§Ù„ÙˆØµÙ</th>
              <th>Ø³Ø·Ø± Ø§Ù„Ù‚ÙŠØ¯</th>
            </tr>
          </thead>
          <tbody>
            ${DB.journal.map(entry => `
              <tr>
                <td>${entry.id}</td>
                <td>${new Date(entry.date).toLocaleString()}</td>
                <td>${entry.description}</td>
                <td>
                  ${entry.lines.map(line => `
                    <div style="display:flex;justify-content:space-between;margin-bottom:4px">
                      <span>${line.accountId}</span>
                      <span style="color:${line.side === 'debit' ? 'var(--danger)' : 'var(--success)'}">
                        ${line.side === 'debit' ? 'Ù…Ø¯ÙŠÙ†' : 'Ø¯Ø§Ø¦Ù†'} ${fmt(line.amount)} Ø±.ÙŠ
                      </span>
                    </div>
                  `).join('')}
                </td>
              </tr>
            `).join('')}
          </tbody>
        </table>
      `;
    }
    
    function renderLedgerTab() {
      const container = document.getElementById('tab-ledger');
      
      container.innerHTML = `
        <h2>Ø¯ÙØªØ± Ø§Ù„Ø£Ø³ØªØ§Ø°</h2>
        <div class="muted">Ø§Ø®ØªØ± Ø­Ø³Ø§Ø¨ Ù„Ø¹Ø±Ø¶ Ø¯ÙØªØ± Ø§Ù„Ø£Ø³ØªØ§Ø° Ø§Ù„Ø®Ø§Øµ Ø¨Ù‡</div>
        <div style="margin-top:12px">
          <select id="ledgerAccountSelect" style="margin-bottom:12px">
            <option value="">-- Ø§Ø®ØªØ± Ø­Ø³Ø§Ø¨ --</option>
            ${Object.values(DB.accounts).map(account => `
              <option value="${account.id}">${account.code} - ${account.name}</option>
            `).join('')}
          </select>
          <button class="btn primary" onclick="renderLedgerForAccount()">Ø¹Ø±Ø¶ Ø¯ÙØªØ± Ø§Ù„Ø£Ø³ØªØ§Ø°</button>
        </div>
        <div id="ledgerDetails" style="margin-top:12px"></div>
      `;
    }
    
    function renderLedgerForAccount() {
      const accountId = document.getElementById('ledgerAccountSelect').value;
      if (!accountId) return;
      
      const account = DB.accounts[accountId];
      const entries = DB.journal.filter(e => e.lines.some(l => l.accountId === accountId));
      
      const container = document.getElementById('ledgerDetails');
      container.innerHTML = `
        <h3>Ø¯ÙØªØ± Ø§Ù„Ø£Ø³ØªØ§Ø°: ${account.name}</h3>
        <div>Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: ${fmt(account.balance || 0)} Ø±.ÙŠ</div>
        <table style="margin-top:12px">
          <thead>
            <tr>
              <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
              <th>Ø§Ù„Ù…Ø±Ø¬Ø¹</th>
              <th>Ø§Ù„ÙˆØµÙ</th>
              <th>Ø§Ù„Ù…Ø¯ÙŠÙ†</th>
              <th>Ø§Ù„Ø¯Ø§Ø¦Ù†</th>
            </tr>
          </thead>
          <tbody>
            ${entries.map(entry => {
              const debitLines = entry.lines.filter(l => l.accountId === accountId && l.side === 'debit');
              const creditLines = entry.lines.filter(l => l.accountId === accountId && l.side === 'credit');
              
              return `
                <tr>
                  <td>${new Date(entry.date).toLocaleDateString()}</td>
                  <td>${entry.ref || ''}</td>
                  <td>${entry.description}</td>
                  <td>${debitLines.map(l => fmt(l.amount)).join(', ') || '-'}</td>
                  <td>${creditLines.map(l => fmt(l.amount)).join(', ') || '-'}</td>
                </tr>
              `;
            }).join('')}
          </tbody>
        </table>
      `;
    }
    
    function renderTrialBalanceTab() {
      const container = document.getElementById('tab-trial');
      
      const rows = Object.values(DB.accounts).map(a => ({
        id: a.id,
        name: a.name,
        type: a.type,
        balance: a.balance || 0
      }));
      
      const totalDebit = rows.filter(r => ['asset','expense'].includes(r.type))
        .reduce((s, r) => s + Math.max(0, r.balance), 0);
      const totalCredit = rows.filter(r => ['income','liability','equity'].includes(r.type))
        .reduce((s, r) => s + Math.max(0, r.balance), 0);
      
      container.innerHTML = `
        <h2>Ù…ÙŠØ²Ø§Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</h2>
        <table>
          <thead>
            <tr>
              <th>Ø§Ù„Ø­Ø³Ø§Ø¨</th>
              <th>Ø§Ù„Ù†ÙˆØ¹</th>
              <th>Ø§Ù„Ø±ØµÙŠØ¯</th>
            </tr>
          </thead>
          <tbody>
            ${rows.map(row => `
              <tr>
                <td>${row.name}</td>
                <td>
                  <span class="status-badge ${
                    row.type === 'asset' ? 'status-accepted' : 
                    row.type === 'liability' ? 'status-delivered' : 
                    row.type === 'income' ? 'status-confirmed' : 
                    row.type === 'expense' ? 'status-pending' : 'status-started'
                  }">
                    ${row.type === 'asset' ? 'Ø£ØµÙˆÙ„' : 
                      row.type === 'liability' ? 'Ø§Ù„ØªØ²Ø§Ù…Ø§Øª' : 
                      row.type === 'income' ? 'Ø¥ÙŠØ±Ø§Ø¯Ø§Øª' : 
                      row.type === 'expense' ? 'Ù…ØµØ±ÙˆÙØ§Øª' : 'Ø­Ù‚ÙˆÙ‚ Ù…Ù„ÙƒÙŠØ©'}
                  </span>
                </td>
                <td>${fmt(row.balance)} Ø±.ÙŠ</td>
              </tr>
            `).join('')}
          </tbody>
        </table>
        <div style="display:flex;justify-content:space-between;margin-top:16px;padding:12px;background:#f8fafc;border-radius:8px">
          <div><strong>Ù…Ø¬Ù…ÙˆØ¹ Ù…Ø¯ÙŠÙ†: ${fmt(totalDebit)} Ø±.ÙŠ</strong></div>
          <div><strong>Ù…Ø¬Ù…ÙˆØ¹ Ø¯Ø§Ø¦Ù†: ${fmt(totalCredit)} Ø±.ÙŠ</strong></div>
        </div>
        <div style="margin-top:12px;color:${Math.abs(totalDebit - totalCredit) < 0.0001 ? 'var(--success)' : 'var(--danger)'}">
          ${Math.abs(totalDebit - totalCredit) < 0.0001 ? 
            'âœ“ Ù…ÙŠØ²Ø§Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…ØªÙˆØ§Ø²Ù†' : 
            'âœ— Ù…ÙŠØ²Ø§Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ØºÙŠØ± Ù…ØªÙˆØ§Ø²Ù†'}
        </div>
      `;
    }
    
    function renderReconcileTab() {
      const container = document.getElementById('tab-reconcile');
      
      const unreconciledInvoices = DB.invoices.filter(i => !i.reconciled && i.status !== 'paid');
      const unreconciledPayments = DB.payments.filter(p => !p.reconciled);
      
      container.innerHTML = `
        <h2>ØªØ³ÙˆÙŠØ© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</h2>
        <div class="row">
          <div>
            <h3>Ø§Ù„ÙÙˆØ§ØªÙŠØ± ØºÙŠØ± Ø§Ù„Ù…Ø³Ø¯Ø¯Ø©</h3>
            <table>
              <thead>
                <tr>
                  <th>Ø§Ù„Ø±Ù‚Ù…</th>
                  <th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
                  <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                  <th>Ø§Ù„Ø¨Ø§Ù‚ÙŠ</th>
                </tr>
              </thead>
              <tbody>
                ${unreconciledInvoices.map(inv => `
                  <tr>
                    <td>${inv.number || inv.id}</td>
                    <td>${inv.clientId}</td>
                    <td>${fmt(inv.amount)} Ø±.ÙŠ</td>
                    <td>${fmt(inv.amount - (inv.paid || 0))} Ø±.ÙŠ</td>
                  </tr>
                `).join('')}
              </tbody>
            </table>
          </div>
          <div>
            <h3>Ø§Ù„Ø¯ÙØ¹Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ø³Ø¯Ø¯Ø©</h3>
            <table>
              <thead>
                <tr>
                  <th>Ø§Ù„Ø±Ù‚Ù…</th>
                  <th>Ø§Ù„ÙØ§ØªÙˆØ±Ø©</th>
                  <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                </tr>
              </thead>
              <tbody>
                ${unreconciledPayments.map(payment => `
                  <tr>
                    <td>${payment.id}</td>
                    <td>${payment.invoiceId}</td>
                    <td>${fmt(payment.amount)} Ø±.ÙŠ</td>
                  </tr>
                `).join('')}
              </tbody>
            </table>
          </div>
        </div>
        <div style="margin-top:16px">
          <button class="btn primary" onclick="uiAutoMatch()">Ù…Ø·Ø§Ø¨Ù‚Ø© Ø£ÙˆØªÙˆÙ…Ø§ØªÙŠÙƒÙŠØ©</button>
        </div>
      `;
    }

    // ======================= Ø¯ÙˆØ§Ù„ Ø§Ù„Ù€ API Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© =======================
    function apiAccept(dealId,truckId){ 
        TMS.acceptTask(dealId,truckId).then(()=>{ 
            renderAll(); 
            pushNotification('ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©', 'ØªÙ… ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø± Ø¥Ù„Ù‰ Ù†Ø´Ø·');
        }); 
    }

    function apiStart(dealId,truckId){ 
        TMS.startTrip(dealId,truckId).then(()=>{ 
            renderAll(); 
            pushNotification('Ø¨Ø¯Ø£Øª Ø§Ù„Ø±Ø­Ù„Ø©', 'ØªÙ… ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø± Ø¥Ù„Ù‰ Ù†Ø´Ø·');
        }); 
    }

    function apiUploadPOD(dealId,truckId){ 
        openModal('Ø±ÙØ¹ POD', `<div><label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª POD</label><textarea id='pod_notes' style='width:100%;min-height:80px'></textarea><div style='display:flex;gap:8px;justify-content:space-between;margin-top:8px'><div><label>Ø£Ø±ÙÙ‚ ØµÙˆØ±Ø© (Ù…Ø­Ø§ÙƒØ§Ø©)</label><input id='pod_file' type='file' /></div><div style='text-align:left'><button class='btn primary' onclick="confirmUploadPOD('${dealId}','${truckId}')">Ø±ÙØ¹ POD</button></div></div></div>`); 
    }

    function confirmUploadPOD(dealId,truckId){ 
        const notes = document.getElementById('pod_notes').value || ''; 
        closeModal(); 
        TMS.uploadPOD(dealId,truckId,{notes}).then(()=>{ 
            DB.notifications = DB.notifications || []; 
            DB.notifications.push({id:'CL'+Date.now(),type:'client_confirm',dealId,truckId,createdAt:new Date().toISOString()}); 
            save(); 
            renderAll(); 
            pushNotification('ØªÙ… Ø±ÙØ¹ POD', 'ØªÙ… ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø± Ø¥Ù„Ù‰ Ù†Ø´Ø·');
        }); 
    }

    function apiClientConfirm(dealId,truckId){ 
        TMS.clientConfirm(dealId,truckId).then(()=>{ 
            renderAll(); 
            pushNotification('ØªÙ… Ø§Ù„ØªØ£ÙƒÙŠØ¯', 'ØªÙ… ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø± Ø¥Ù„Ù‰ Ù†Ø´Ø·');
        }); 
    }

    function apiAgentLoad(dealId){ 
        TMS.agentUpdateLoad(dealId,{}).then(()=>{ 
            renderAll(); 
            pushNotification('ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„', 'ØªÙ… ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø± Ø¥Ù„Ù‰ Ù†Ø´Ø·');
        }); 
    }

    function apiRecordPayment(invId){ 
        const amount = Number(prompt('Ø£Ø¯Ø®Ù„ Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…Ø³ØªÙ„Ù…:', '0')); 
        if(!amount || amount<=0) return alert('Ù…Ø¨Ù„Øº ØºÙŠØ± ØµØ§Ù„Ø­'); 
        TMS.recordPayment(invId,amount).then(()=>{ 
            renderAll(); 
        }); 
    }

    // ======================= Ø¯ÙˆØ§Ù„ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© =======================
    function openCreateDealModal() {
      const html = `
        <div>
          <form id="createDealForm">
            <div class="form-group">
              <label>Ø±Ù‚Ù… Ø§Ù„ØµÙÙ‚Ø©</label>
              <input type="text" id="dealNumber" placeholder="DEAL-2025-001" required>
            </div>
            
            <div class="form-group">
              <label>Ø§Ø³Ù… Ø§Ù„Ø³ÙÙŠÙ†Ø©</label>
              <input type="text" id="shipName" placeholder="ANTAKYA M" required>
            </div>
            
            <div class="form-group">
              <label>Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ø¹Ù…ÙŠÙ„Ø©</label>
              <input type="text" id="companyName" placeholder="ÙØ§Ù„ÙƒÙˆÙ†" required>
            </div>
            
            <div class="form-group">
              <label>Ø§Ù„ÙˆØ¬Ù‡Ø©</label>
              <input type="text" id="destination" placeholder="SAL" required>
            </div>
            
            <div class="form-group">
              <label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ù…ÙˆÙ„Ø© (Ø·Ù†)</label>
              <input type="number" id="totalLoad" min="1" required>
            </div>
            
            <div class="form-group">
              <label>Ø³Ø¹Ø± Ø§Ù„Ø·Ù† (Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ)</label>
              <input type="number" id="pricePerTon" value="${DB.settings.pricePerTon}" required>
            </div>
            
            <div class="form-group">
              <label>Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø©</label>
              <select id="cargoType" required>
                <option value="coal">ÙØ­Ù…</option>
                <option value="grain">Ø­Ø¨ÙˆØ¨</option>
                <option value="general">Ø¨Ø¶Ø§Ø¹Ø© Ø¹Ø§Ù…Ø©</option>
                <option value="construction">Ù…ÙˆØ§Ø¯ Ø¨Ù†Ø§Ø¡</option>
              </select>
            </div>
            
            <div class="form-group">
              <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
              <textarea id="notes" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©"></textarea>
            </div>
            
            <div id="truckDistributionPreview" class="truck-distribution" style="display:none">
              <h4>ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­</h4>
              <div id="truckPreviewList"></div>
            </div>
            
            <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
              <button type="button" class="btn ghost" onclick="previewTruckDistribution()">Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØªÙˆØ²ÙŠØ¹</button>
              <button type="submit" class="btn primary">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙÙ‚Ø©</button>
            </div>
          </form>
        </div>
      `;
      
      openModal('Ø¥Ù†Ø´Ø§Ø¡ ØµÙÙ‚Ø© Ø¬Ø¯ÙŠØ¯Ø©', html);
      
      document.getElementById('totalLoad').addEventListener('input', calculateDealValue);
      document.getElementById('pricePerTon').addEventListener('input', calculateDealValue);
    }

    function calculateDealValue() {
      const totalLoad = parseInt(document.getElementById('totalLoad').value) || 0;
      const pricePerTon = parseInt(document.getElementById('pricePerTon').value) || 0;
      const dealValue = totalLoad * pricePerTon;
      
      const dealValueElement = document.getElementById('dealValuePreview');
      if (!dealValueElement) {
        const formGroup = document.createElement('div');
        formGroup.className = 'form-group';
        formGroup.innerHTML = `
          <label>Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ù„ØµÙÙ‚Ø©</label>
          <input type="text" id="dealValuePreview" value="${dealValue.toLocaleString()} Ø±.ÙŠ" readonly>
        `;
        document.getElementById('createDealForm').insertBefore(formGroup, document.getElementById('truckDistributionPreview'));
      } else {
        dealValueElement.value = `${dealValue.toLocaleString()} Ø±.ÙŠ`;
      }
    }

    function previewTruckDistribution() {
      const totalLoad = parseInt(document.getElementById('totalLoad').value) || 0;
      
      if (totalLoad <= 0) {
        alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø­Ù…ÙˆÙ„Ø© ØµØ­ÙŠØ­Ø©');
        return;
      }
      
      const trucks = calculateOptimalTrucks(totalLoad, DB.settings.maxTruckLoad);
      const previewList = document.getElementById('truckPreviewList');
      previewList.innerHTML = '';
      
      trucks.forEach((truck, index) => {
        const truckItem = document.createElement('div');
        truckItem.className = 'truck-item';
        truckItem.innerHTML = `
          <div><strong>Ù‚Ø§Ø·Ø±Ø© ${index + 1}</strong></div>
          <div class="muted">Ø§Ù„Ø­Ù…ÙˆÙ„Ø©: ${truck.load} Ø·Ù†</div>
        `;
        previewList.appendChild(truckItem);
      });
      
      document.getElementById('truckDistributionPreview').style.display = 'block';
    }

    function openEditDealModal(dealId) {
      const deal = DB.deals.find(d => d.id === dealId);
      if (!deal) {
        pushNotification('Ø®Ø·Ø£', 'Ø§Ù„ØµÙÙ‚Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©', 1000);
        return;
      }

      const html = `
        <div>
          <form id="editDealForm">
            <div class="form-group">
              <label>Ø±Ù‚Ù… Ø§Ù„ØµÙÙ‚Ø©</label>
              <input type="text" id="edit_dealNumber" value="${deal.dealNumber}" required>
            </div>
            
            <div class="form-group">
              <label>Ø§Ø³Ù… Ø§Ù„Ø³ÙÙŠÙ†Ø©</label>
              <input type="text" id="edit_shipName" value="${deal.shipName}" required>
            </div>
            
            <div class="form-group">
              <label>Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ø¹Ù…ÙŠÙ„Ø©</label>
              <input type="text" id="edit_companyName" value="${deal.companyName}" required>
            </div>
            
            <div class="form-group">
              <label>Ù…Ø¹Ø±Ù Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
              <input type="text" id="edit_clientId" value="${deal.clientId || ''}" required>
            </div>
            
            <div class="form-group">
              <label>Ø§Ù„ÙˆØ¬Ù‡Ø©</label>
              <input type="text" id="edit_destination" value="${deal.destination}" required>
            </div>
            
            <div class="form-group">
              <label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ù…ÙˆÙ„Ø© (Ø·Ù†)</label>
              <input type="number" id="edit_totalLoad" value="${deal.totalLoad}" min="1" required>
            </div>
            
            <div class="form-group">
              <label>Ø³Ø¹Ø± Ø§Ù„Ø·Ù† (Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ)</label>
              <input type="number" id="edit_pricePerTon" value="${deal.pricePerTon}" required>
            </div>
            
            <div class="form-group">
              <label>Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø©</label>
              <select id="edit_cargoType" required>
                <option value="coal" ${deal.cargoType === 'coal' ? 'selected' : ''}>ÙØ­Ù…</option>
                <option value="grain" ${deal.cargoType === 'grain' ? 'selected' : ''}>Ø­Ø¨ÙˆØ¨</option>
                <option value="general" ${deal.cargoType === 'general' ? 'selected' : ''}>Ø¨Ø¶Ø§Ø¹Ø© Ø¹Ø§Ù…Ø©</option>
                <option value="construction" ${deal.cargoType === 'construction' ? 'selected' : ''}>Ù…ÙˆØ§Ø¯ Ø¨Ù†Ø§Ø¡</option>
              </select>
            </div>
            
            <div class="form-group">
              <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
              <textarea id="edit_notes" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©">${deal.notes || ''}</textarea>
            </div>
            
            <div class="form-group">
              <label>Ø­Ø§Ù„Ø© Ø§Ù„ØµÙÙ‚Ø©</label>
              <select id="edit_status">
                <option value="created" ${deal.status === 'created' ? 'selected' : ''}>ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡</option>
                <option value="in_progress" ${deal.status === 'in_progress' ? 'selected' : ''}>Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</option>
                <option value="completed" ${deal.status === 'completed' ? 'selected' : ''}>Ù…ÙƒØªÙ…Ù„Ø©</option>
                <option value="cancelled" ${deal.status === 'cancelled' ? 'selected' : ''}>Ù…Ù„ØºØ§Ø©</option>
              </select>
            </div>

            <div id="editTruckDistribution" class="truck-distribution">
              <h4>Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h4>
              <div id="editTruckList">
                ${deal.trucks.map((truck, index) => `
                  <div class="truck-item">
                    <div style="display:flex;justify-content:space-between;align-items:center">
                      <div>
                        <strong>${truck.truckNumber}</strong>
                        <div class="muted">Ø§Ù„Ø³Ø§Ø¦Ù‚: ${truck.driverName} â€¢ Ø§Ù„Ø­Ù…ÙˆÙ„Ø©: ${truck.load} Ø·Ù†</div>
                      </div>
                      <div>
                        <button type="button" class="btn danger" onclick="removeTruckFromDeal('${dealId}', '${truck.id}')">Ø­Ø°Ù</button>
                        <button type="button" class="btn info" onclick="openEditTruckModal('${dealId}', '${truck.id}')">ØªØ¹Ø¯ÙŠÙ„</button>
                      </div>
                    </div>
                  </div>
                `).join('')}
              </div>
              <div style="margin-top:12px">
                <button type="button" class="btn primary" onclick="openAddTruckModal('${dealId}')">Ø¥Ø¶Ø§ÙØ© Ù‚Ø§Ø·Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
              </div>
            </div>
            
            <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
              <button type="button" class="btn danger" onclick="deleteDeal('${dealId}')">Ø­Ø°Ù Ø§Ù„ØµÙÙ‚Ø©</button>
              <button type="button" class="btn ghost" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
              <button type="submit" class="btn primary">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
            </div>
          </form>
        </div>
      `;
      
      openModal(`ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØµÙÙ‚Ø© - ${deal.dealNumber}`, html);

      // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ø§Ù„Ø­Ø¯Ø« Ù„Ù„Ù†Ù…ÙˆØ°Ø¬
      document.getElementById('editDealForm').addEventListener('submit', function(e) {
        e.preventDefault();
        updateDeal(dealId);
      });

      // Ø¥Ø¹Ø§Ø¯Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ù…ÙˆÙ„Ø© Ø£Ùˆ Ø§Ù„Ø³Ø¹Ø±
      document.getElementById('edit_totalLoad').addEventListener('input', function() {
        updateDealValuePreview();
      });
      document.getElementById('edit_pricePerTon').addEventListener('input', function() {
        updateDealValuePreview();
      });
    }

    function updateDealValuePreview() {
      const totalLoad = parseInt(document.getElementById('edit_totalLoad').value) || 0;
      const pricePerTon = parseInt(document.getElementById('edit_pricePerTon').value) || 0;
      const dealValue = totalLoad * pricePerTon;
      
      let previewElement = document.getElementById('editDealValuePreview');
      if (!previewElement) {
        const formGroup = document.createElement('div');
        formGroup.className = 'form-group';
        formGroup.innerHTML = `
          <label>Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ù„ØµÙÙ‚Ø©</label>
          <input type="text" id="editDealValuePreview" value="${dealValue.toLocaleString()} Ø±.ÙŠ" readonly>
        `;
        document.getElementById('editDealForm').insertBefore(formGroup, document.getElementById('editTruckDistribution'));
      } else {
        previewElement.value = `${dealValue.toLocaleString()} Ø±.ÙŠ`;
      }
    }

    function updateDeal(dealId) {
      const deal = DB.deals.find(d => d.id === dealId);
      if (!deal) return;

      const updates = {
        dealNumber: document.getElementById('edit_dealNumber').value,
        shipName: document.getElementById('edit_shipName').value,
        companyName: document.getElementById('edit_companyName').value,
        clientId: document.getElementById('edit_clientId').value,
        destination: document.getElementById('edit_destination').value,
        totalLoad: parseInt(document.getElementById('edit_totalLoad').value),
        pricePerTon: parseInt(document.getElementById('edit_pricePerTon').value),
        cargoType: document.getElementById('edit_cargoType').value,
        notes: document.getElementById('edit_notes').value,
        status: document.getElementById('edit_status').value
      };

      // ØªØ­Ø¯ÙŠØ« Ù‚ÙŠÙ…Ø© Ø§Ù„ØµÙÙ‚Ø©
      updates.dealValue = updates.totalLoad * updates.pricePerTon;

      const dealIndex = DB.deals.findIndex(d => d.id === dealId);
      if (dealIndex !== -1) {
        DB.deals[dealIndex] = { ...DB.deals[dealIndex], ...updates };
        save();
        closeModal();
        renderAll();
        log(`ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙÙ‚Ø©: ${updates.dealNumber}`);
        pushNotification('ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«', `ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙÙ‚Ø© ${updates.dealNumber}`, 1000);
      }
    }

    function openAddTruckModal(dealId) {
      const html = `
        <div>
          <form id="addTruckForm">
            <div class="form-group">
              <label>Ø±Ù‚Ù… Ø§Ù„Ù‚Ø§Ø·Ø±Ø©</label>
              <input type="text" id="new_truckNumber" placeholder="TRK-1001" required>
            </div>
            
            <div class="form-group">
              <label>Ø§Ø³Ù… Ø§Ù„Ø³Ø§Ø¦Ù‚</label>
              <input type="text" id="new_driverName" placeholder="Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯" required>
            </div>
            
            <div class="form-group">
              <label>Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø§Ù„Ø³Ø§Ø¦Ù‚</label>
              <input type="text" id="new_driverPhone" placeholder="+967 XXX XXX XXX">
            </div>
            
            <div class="form-group">
              <label>Ø§Ù„Ø­Ù…ÙˆÙ„Ø© (Ø·Ù†)</label>
              <input type="number" id="new_load" min="1" max="60" required>
            </div>
            
            <div class="form-group">
              <label>Ù…Ø¨Ù„Øº Ø§Ù„Ø¥ÙŠØ¬Ø§Ø± (Ø±ÙŠØ§Ù„)</label>
              <input type="number" id="new_rentAmount" required>
            </div>
            
            <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
              <button type="button" class="btn ghost" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
              <button type="submit" class="btn primary">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ø§Ø·Ø±Ø©</button>
            </div>
          </form>
        </div>
      `;
      
      openModal('Ø¥Ø¶Ø§ÙØ© Ù‚Ø§Ø·Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø©', html);

      document.getElementById('addTruckForm').addEventListener('submit', function(e) {
        e.preventDefault();
        addTruckToDeal(dealId);
      });
    }

    function addTruckToDeal(dealId) {
      const deal = DB.deals.find(d => d.id === dealId);
      if (!deal) return;

      const newTruck = {
        id: 'T' + Date.now() + Math.floor(Math.random() * 1000),
        truckNumber: document.getElementById('new_truckNumber').value,
        driverName: document.getElementById('new_driverName').value,
        driverPhone: document.getElementById('new_driverPhone').value,
        load: parseInt(document.getElementById('new_load').value),
        rentAmount: parseInt(document.getElementById('new_rentAmount').value),
        driverAccepted: false,
        delivered: false,
        clientConfirmed: false,
        companyRevenue: 0,
        dieselAmount: 0,
        expensesAdvance: 0,
        payout: { created: false, paid: false }
      };

      deal.trucks.push(newTruck);
      save();
      closeModal();
      openEditDealModal(dealId); // Ø¥Ø¹Ø§Ø¯Ø© ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
      log(`ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù‚Ø§Ø·Ø±Ø© ${newTruck.truckNumber} Ø¥Ù„Ù‰ Ø§Ù„ØµÙÙ‚Ø© ${deal.dealNumber}`);
    }

    function removeTruckFromDeal(dealId, truckId) {
      if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø§Ø·Ø±Ø©ØŸ')) {
        return;
      }

      const deal = DB.deals.find(d => d.id === dealId);
      if (!deal) return;

      const truck = deal.trucks.find(t => t.id === truckId);
      if (!truck) return;

      deal.trucks = deal.trucks.filter(t => t.id !== truckId);
      save();
      openEditDealModal(dealId); // Ø¥Ø¹Ø§Ø¯Ø© ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
      log(`ØªÙ… Ø­Ø°Ù Ù‚Ø§Ø·Ø±Ø© ${truck.truckNumber} Ù…Ù† Ø§Ù„ØµÙÙ‚Ø© ${deal.dealNumber}`);
    }

    function openEditTruckModal(dealId, truckId) {
      const deal = DB.deals.find(d => d.id === dealId);
      const truck = deal.trucks.find(t => t.id === truckId);
      if (!truck) return;

      const html = `
        <div>
          <form id="editTruckForm">
            <div class="form-group">
              <label>Ø±Ù‚Ù… Ø§Ù„Ù‚Ø§Ø·Ø±Ø©</label>
              <input type="text" id="edit_truckNumber" value="${truck.truckNumber}" required>
            </div>
            
            <div class="form-group">
              <label>Ø§Ø³Ù… Ø§Ù„Ø³Ø§Ø¦Ù‚</label>
              <input type="text" id="edit_driverName" value="${truck.driverName}" required>
            </div>
            
            <div class="form-group">
              <label>Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø§Ù„Ø³Ø§Ø¦Ù‚</label>
              <input type="text" id="edit_driverPhone" value="${truck.driverPhone || ''}">
            </div>
            
            <div class="form-group">
              <label>Ø§Ù„Ø­Ù…ÙˆÙ„Ø© (Ø·Ù†)</label>
              <input type="number" id="edit_load" value="${truck.load}" min="1" max="60" required>
            </div>
            
            <div class="form-group">
              <label>Ù…Ø¨Ù„Øº Ø§Ù„Ø¥ÙŠØ¬Ø§Ø± (Ø±ÙŠØ§Ù„)</label>
              <input type="number" id="edit_rentAmount" value="${truck.rentAmount}" required>
            </div>
            
            <div class="form-group">
              <label>Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠØ²Ù„ (Ø±ÙŠØ§Ù„)</label>
              <input type="number" id="edit_dieselAmount" value="${truck.dieselAmount || 0}">
            </div>
            
            <div class="form-group">
              <label>Ø³Ù„ÙØ© Ø§Ù„Ø³Ø§Ø¦Ù‚ (Ø±ÙŠØ§Ù„)</label>
              <input type="number" id="edit_expensesAdvance" value="${truck.expensesAdvance || 0}">
            </div>
            
            <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
              <button type="button" class="btn ghost" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
              <button type="submit" class="btn primary">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø·Ø±Ø©</button>
            </div>
          </form>
        </div>
      `;
      
      openModal(`ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚Ø§Ø·Ø±Ø© - ${truck.truckNumber}`, html);

      document.getElementById('editTruckForm').addEventListener('submit', function(e) {
        e.preventDefault();
        updateTruck(dealId, truckId);
      });
    }

    function updateTruck(dealId, truckId) {
      const deal = DB.deals.find(d => d.id === dealId);
      const truck = deal.trucks.find(t => t.id === truckId);
      if (!truck) return;

      const updates = {
        truckNumber: document.getElementById('edit_truckNumber').value,
        driverName: document.getElementById('edit_driverName').value,
        driverPhone: document.getElementById('edit_driverPhone').value,
        load: parseInt(document.getElementById('edit_load').value),
        rentAmount: parseInt(document.getElementById('edit_rentAmount').value),
        dieselAmount: parseInt(document.getElementById('edit_dieselAmount').value) || 0,
        expensesAdvance: parseInt(document.getElementById('edit_expensesAdvance').value) || 0
      };

      const truckIndex = deal.trucks.findIndex(t => t.id === truckId);
      if (truckIndex !== -1) {
        deal.trucks[truckIndex] = { ...deal.trucks[truckIndex], ...updates };
        save();
        closeModal();
        openEditDealModal(dealId);
        log(`ØªÙ… ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø·Ø±Ø© ${updates.truckNumber}`);
      }
    }

    function deleteDeal(dealId) {
      if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„ØµÙÙ‚Ø©ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.')) {
        return;
      }

      const deal = DB.deals.find(d => d.id === dealId);
      if (!deal) return;

      DB.deals = DB.deals.filter(d => d.id !== dealId);
      
      // Ø­Ø°Ù Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„ØµÙÙ‚Ø©
      DB.invoices = DB.invoices.filter(i => i.dealId !== dealId);
      
      save();
      closeModal();
      renderAll();
      log(`ØªÙ… Ø­Ø°Ù Ø§Ù„ØµÙÙ‚Ø©: ${deal.dealNumber}`);
      pushNotification('ØªÙ… Ø§Ù„Ø­Ø°Ù', `ØªÙ… Ø­Ø°Ù Ø§Ù„ØµÙÙ‚Ø© ${deal.dealNumber}`, 1000);
    }

    function openAddEmployeeModal() {
      const html = `
        <div>
          <form id="addEmployeeForm">
            <div class="form-group">
              <label>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù</label>
              <input type="text" id="emp_name" required>
            </div>
            
            <div class="form-group">
              <label>Ø§Ù„ÙˆØ¸ÙŠÙØ©</label>
              <input type="text" id="emp_position" required>
            </div>
            
            <div class="form-group">
              <label>Ø§Ù„Ù‚Ø³Ù…</label>
              <select id="emp_department" required>
                <option value="operations">Ø§Ù„ØªØ´ØºÙŠÙ„</option>
                <option value="finance">Ø§Ù„Ù…Ø§Ù„ÙŠØ©</option>
                <option value="hr">Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</option>
                <option value="sales">Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</option>
                <option value="it">ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</option>
              </select>
            </div>
            
            <div class="form-group">
              <label>Ù†ÙˆØ¹ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</label>
              <select id="emp_permission" required>
                <option value="driver">Ø³Ø§Ø¦Ù‚</option>
                <option value="finance">Ù…ÙˆØ¸Ù Ù…Ø§Ù„ÙŠ</option>
                <option value="supervisor">Ù…Ø´Ø±Ù</option>
                <option value="admin">Ù…Ø¯ÙŠØ±</option>
              </select>
            </div>
            
            <div class="form-group">
              <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
              <input type="email" id="emp_email">
            </div>
            
            <div class="form-group">
              <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
              <input type="tel" id="emp_phone">
            </div>
            
            <div class="form-group">
              <label>Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</label>
              <input type="number" id="emp_salary" required>
            </div>
            
            <div class="form-group">
              <label>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ¹ÙŠÙŠÙ†</label>
              <input type="date" id="emp_hireDate" required>
            </div>
            
            <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
              <button type="button" class="btn ghost" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
              <button type="submit" class="btn primary">Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù</button>
            </div>
          </form>
        </div>
      `;
      
      openModal('Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯', html);
    }
    
    function openAddTransactionModal() {
      const html = `
        <div>
          <form id="addTransactionForm">
            <div class="form-group">
              <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©</label>
              <select id="trx_type" required>
                <option value="income">Ø¥ÙŠØ±Ø§Ø¯</option>
                <option value="expense">Ù…ØµØ±ÙˆÙ</option>
              </select>
            </div>
            
            <div class="form-group">
              <label>Ø§Ù„Ù…Ø¨Ù„Øº</label>
              <input type="number" id="trx_amount" required>
            </div>
            
            <div class="form-group">
              <label>Ø§Ù„ÙˆØµÙ</label>
              <input type="text" id="trx_description" required>
            </div>
            
            <div class="form-group">
              <label>Ù…Ù† Ø­Ø³Ø§Ø¨</label>
              <select id="trx_fromAccount" required>
                ${Object.values(DB.accounts).map(account => 
                  `<option value="${account.id}">${account.name}</option>`
                ).join('')}
            </select>
            </div>
            
            <div class="form-group">
              <label>Ø¥Ù„Ù‰ Ø­Ø³Ø§Ø¨</label>
              <select id="trx_toAccount" required>
                ${Object.values(DB.accounts).map(account => 
                  `<option value="${account.id}">${account.name}</option>`
                ).join('')}
              </select>
            </div>
            
            <div class="form-group">
              <label>Ø§Ù„ÙØ¦Ø©</label>
              <select id="trx_category" required>
                <option value="operations">ØªØ´ØºÙŠÙ„</option>
                <option value="salaries">Ø±ÙˆØ§ØªØ¨</option>
                <option value="maintenance">ØµÙŠØ§Ù†Ø©</option>
                <option value="fuel">ÙˆÙ‚ÙˆØ¯</option>
                <option value="office">Ù…ÙƒØªØ¨</option>
                <option value="other">Ø£Ø®Ø±Ù‰</option>
              </select>
            </div>
            
            <div class="form-group">
              <label>Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
              <input type="date" id="trx_date" required>
            </div>
            
            <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
              <button type="button" class="btn ghost" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
              <button type="submit" class="btn primary">Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù…Ù„Ø©</button>
            </div>
          </form>
        </div>
      `;
      
      openModal('Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ø§Ù„ÙŠØ©', html);
    }
    
    function openUpdateBudgetModal() {
      const html = `
        <div>
          <form id="updateBudgetForm">
            <div class="form-group">
              <label>Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</label>
              <input type="number" id="budget_income" value="${DB.budget.income}" required>
            </div>
            
            <div class="form-group">
              <label>Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</label>
              <input type="number" id="budget_expenses" value="${DB.budget.expenses}" required>
            </div>
            
            <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
              <button type="button" class="btn ghost" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
              <button type="submit" class="btn primary">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</button>
            </div>
          </form>
        </div>
      `;
      
      openModal('ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©', html);
    }
    
    function openBulkAttendanceModal() {
      const html = `
        <div>
          <div><strong>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ</strong></div>
          <div class="muted" style="margin-bottom:12px">Ø§Ø®ØªØ± Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†</div>
          
          <div style="display:flex;gap:8px;margin-bottom:16px">
            <button class="btn success" onclick="bulkAttendance('present')">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¬Ù…ÙŠØ¹ ÙƒØ­Ø§Ø¶Ø±ÙŠÙ†</button>
            <button class="btn danger" onclick="bulkAttendance('absent')">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¬Ù…ÙŠØ¹ ÙƒØºØ§Ø¦Ø¨ÙŠÙ†</button>
          </div>
          
          <div>
            <strong>Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†:</strong>
            <div class="list" style="max-height:300px;margin-top:8px">
              ${DB.employees.filter(e => e.status === 'active').map(employee => `
                <div class="item">
                  <div style="display:flex;justify-content:space-between;align-items:center">
                    <div>${employee.name}</div>
                    <div>
                      <button class="btn success" onclick="HR.recordAttendance('${employee.id}', 'present').then(() => closeModal())">Ø­Ø§Ø¶Ø±</button>
                      <button class="btn danger" onclick="HR.recordAttendance('${employee.id}', 'absent').then(() => closeModal())">ØºØ§Ø¦Ø¨</button>
                    </div>
                  </div>
                </div>
              `).join('')}
            </div>
          </div>
        </div>
      `;
      
      openModal('ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ', html);
    }
    
    function bulkAttendance(status) {
      const today = new Date().toISOString().split('T')[0];
      const activeEmployees = DB.employees.filter(e => e.status === 'active');
      
      activeEmployees.forEach(employee => {
        HR.recordAttendance(employee.id, status, today);
      });
      
      closeModal();
      renderHRDashboard();
      pushNotification('ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„', `ØªÙ… ØªØ³Ø¬ÙŠÙ„ ${status} Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†`);
    }

    function openAssign(dealId){ 
        currentAssignDealId = dealId; 
        openModal('ØªØ¹ÙŠÙŠÙ† Ù‚Ø§Ø·Ø±Ø©', renderAssignForm(dealId)); 
    }

    function renderAssignForm(dealId){ 
        return `
            <div style="max-width:100%;">
                <form id='assignForm'>
                    <div style='display:grid;gap:10px; max-width:500px; margin:0 auto;'>
                        <div class="form-group">
                            <label>Ø±Ù‚Ù… Ø§Ù„Ù‚Ø§Ø·Ø±Ø©</label>
                            <input id='a_truck' placeholder='TRK-1001' required style='padding:10px; width:100%;'/>
                        </div>
                        <div class="form-group">
                            <label>Ø§Ø³Ù… Ø§Ù„Ø³Ø§Ø¦Ù‚</label>
                            <input id='a_driver' placeholder='Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯' required style='padding:10px; width:100%;'/>
                        </div>
                        <div style='display:grid;grid-template-columns:1fr 1fr;gap:10px;'>
                            <div class="form-group">
                                <label>Ø§Ù„Ø­Ù…ÙˆÙ„Ø© (Ø·Ù†)</label>
                                <input id='a_load' type='number' placeholder='50' required style='padding:10px; width:100%;'/>
                            </div>
                            <div class="form-group">
                                <label>Ø§Ù„Ø¥ÙŠØ¬Ø§Ø± (Ø±ÙŠØ§Ù„)</label>
                                <input id='a_rent' type='number' placeholder='5000' required style='padding:10px; width:100%;'/>
                            </div>
                        </div>
                        <div style='display:flex;gap:8px;justify-content:flex-end; margin-top:10px;'>
                            <button type="button" class='btn ghost' onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
                            <button class='btn primary' type='submit'>Ø¥Ø¶Ø§ÙØ© Ù‚Ø§Ø·Ø±Ø©</button>
                        </div>
                    </div>
                </form>
            </div>
        `; 
    }

    function openDeal(dealId){ 
        const d = DB.deals.find(x=>x.id===dealId); 
        if(!d) return; 
        
        let trucksHtml = ''; 
        d.trucks.forEach(t=>{ 
            trucksHtml += `
                <tr>
                    <td>${t.truckNumber}</td>
                    <td>${t.driverName}<br><small>${t.driverPhone||''}</small></td>
                    <td>${t.load}</td>
                    <td>${t.rentAmount?.toLocaleString()||0}</td>
                    <td>
                        ${t.driverAccepted? 'âœ… Ù…ÙˆØ§ÙÙ‚Ø©':'â³ Ø¨Ø§Ù†ØªØ¸Ø§Ø±' }
                        ${t.delivered? '<br>ğŸ“¦ ØªÙ… Ø§Ù„ØªÙØ±ÙŠØº':''}
                        ${t.clientConfirmed? '<br>âœ“ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø£ÙƒØ¯':''}
                    </td>
                    <td style="white-space: nowrap;">
                        <button class='btn' onclick="notifyDriver('${dealId}','${t.id}')" style="margin:2px; padding:4px 8px; font-size:12px;">Ø¥Ø´Ø¹Ø§Ø±</button>
                        <button class='btn' onclick="apiAccept('${dealId}','${t.id}')" style="margin:2px; padding:4px 8px; font-size:12px;">Ù…Ø­Ø§ÙƒØ§Ø© Ù…ÙˆØ§ÙÙ‚Ø©</button>
                        <button class='btn' onclick="apiUploadPOD('${dealId}','${t.id}')" style="margin:2px; padding:4px 8px; font-size:12px;">Ù…Ø­Ø§ÙƒØ§Ø© POD</button>
                        <div style='margin-top:4px'>
                            <button class='btn' onclick="openDieselModal('${dealId}','${t.id}')" style="margin:2px; padding:4px 8px; font-size:12px;">ØªØ³Ø¬ÙŠÙ„ Ø¯ÙŠØ²Ù„</button>
                        </div>
                    </td>
                </tr>
            `; 
        }); 
        
        const finance = computeDealFinance(dealId); 
        const truckNames = d.trucks.map(t => t.truckNumber).join(' Ùˆ ');
        
        const html = `
            <div style="max-width:100%; overflow:hidden;">
                <div class='deal-color-bar' style='background:${colorFromString(d.id)}; margin-bottom:12px;'></div>
                <h3 style="margin:0 0 8px 0; font-size:18px;">${d.dealNumber} â€” ${d.shipName}</h3>
                <div class='muted' style="margin-bottom:12px;">${d.companyName} â€¢ ${d.destination}</div>
                
                <div style="margin:16px 0;">
                    <h4 style="margin:0 0 8px 0;">Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª</h4>
                    <div style="overflow-x:auto;">
                        <table style="min-width:600px; width:100%;">
                            <thead>
                                <tr>
                                    <th>Ø§Ù„Ù‚Ø§Ø·Ø±Ø©</th>
                                    <th>Ø§Ù„Ø³Ø§Ø¦Ù‚</th>
                                    <th>Ø­Ù…ÙˆÙ„Ø©</th>
                                    <th>Ø¥ÙŠØ¬Ø§Ø±</th>
                                    <th>Ø­Ø§Ù„Ø©</th>
                                    <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                </tr>
                            </thead>
                            <tbody>${trucksHtml}</tbody>
                        </table>
                    </div>
                </div>
                
                <div class='financial-summary'>
                    <div><strong>Ø§Ù„Ø®Ù„Ø§ØµØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ©:</strong></div>
                    <table class="financial-summary-table">
                        <tr>
                            <th>Ø§Ù„Ø¨Ù†Ø¯</th>
                            <th class="value">Ø§Ù„Ù…Ø¨Ù„Øº (Ø±.ÙŠ)</th>
                        </tr>
                        <tr>
                            <td>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø© Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„</td>
                            <td class="value">${finance.expectedRevenue.toLocaleString()}</td>
                        </tr>
                        <tr>
                            <td>Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ø³Ù„Ù Ù„Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†</td>
                            <td class="value negative">- ${finance.totalAdvances.toLocaleString()}</td>
                        </tr>
                        <tr>
                            <td>Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ø¯ÙŠØ²Ù„ Ù„Ù„Ù‚Ø§Ø·Ø±Ø§Øª</td>
                            <td class="value negative">- ${finance.totalDiesel.toLocaleString()}</td>
                        </tr>
                        <tr>
                            <td>Ø¥ÙŠØ±Ø§Ø¯ Ø§Ù„Ø´Ø±ÙƒØ© Ù…Ù† Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª ${truckNames}</td>
                            <td class="value positive">+ ${finance.totalCompanyRevenue.toLocaleString()}</td>
                        </tr>
                        <tr>
                            <td>Ø¥ÙŠØ¬Ø§Ø± Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª ${truckNames} (Ù…Ø¬Ù…ÙˆØ¹ Ø³Ø¹Ø± Ø§Ù„Ø·Ù† ÙÙŠ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø·Ù†Ø§Ù†)</td>
                            <td class="value negative">- ${finance.totalDriverPayouts.toLocaleString()}</td>
                        </tr>
                        <tr style="background:#f8fafc; font-weight:700;">
                            <td>ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹</td>
                            <td class="value ${finance.netProfit >= 0 ? 'positive' : 'negative'}">${finance.netProfit.toLocaleString()}</td>
                        </tr>
                    </table>
                </div>
                
                <div style='text-align:left; margin-top:16px;'>
                    <button class='btn primary' onclick="TMS.matchAndInvoice('${dealId}').then(()=>{ renderAll(); closeModal(); })">Ù…Ø·Ø§Ø¨Ù‚Ø© ÙˆÙÙˆØªØ±Ø©</button>
                </div>
            </div>
        `; 
        
        openModal(`ØªÙØ§ØµÙŠÙ„ ${d.dealNumber}`, html); 
    }

    function openDieselModal(dealId,truckId){ 
        openModal('ØªØ³Ø¬ÙŠÙ„ Ø¯ÙŠØ²Ù„', `<div><label>Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠØ²Ù„ (Ø±.ÙŠ)</label><input id='diesel_amount' type='number' style='padding:8px;width:100%' /><div style='text-align:left;margin-top:8px'><button class='btn primary' onclick="confirmDiesel('${dealId}','${truckId}')">Ø­ÙØ¸</button></div></div>`); 
    }

    function confirmDiesel(dealId,truckId){ 
        const amt = Number(document.getElementById('diesel_amount').value); 
        if(isNaN(amt) || amt<0) return alert('Ø£Ø¯Ø®Ù„ Ù‚ÙŠÙ…Ø© ØµØ­ÙŠØ­Ø©'); 
        closeModal(); 
        TMS.setDieselAmount(dealId,truckId,amt).then(()=>{ 
            renderAll(); 
        }); 
    }

    function notifyDriver(dealId,truckId){ 
        const d = DB.deals.find(x=>x.id===dealId); 
        const t = d.trucks.find(x=>x.id===truckId); 
        DB.notifications.push({id:'NOT'+Date.now(),type:'assign',dealId,truckId,createdAt:new Date().toISOString(),msg:`ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚Ø§Ø·Ø±Ø© ${t.truckNumber} â€” ${t.driverName}`}); 
        save(); 
        log(`Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ø³Ø§Ø¦Ù‚ ${t.driverName}`); 
        pushNotification('Ø¥Ø´Ø¹Ø§Ø± Ù…Ù‡Ù…Ø©', `ØªÙ… ØªØ¹ÙŠÙŠÙ† ${t.truckNumber} â€” ${t.driverName}`); 
        renderAll(); 
    }

    let currentAssignDealId = null;

    function openModal(title,html){ 
        document.getElementById('modalTitle').innerText = title; 
        document.getElementById('modalBody').innerHTML = html; 
        const modal = document.getElementById('modal');
        modal.classList.add('active');
        
        setTimeout(() => {
            const dialog = modal.querySelector('.dialog');
            if(dialog) {
                dialog.style.transform = 'scale(1)';
                dialog.style.opacity = '1';
            }
        }, 10);
    }

    function closeModal(){ 
        const modal = document.getElementById('modal');
        const dialog = modal.querySelector('.dialog');
        
        if(dialog) {
            dialog.style.transform = 'scale(0.9)';
            dialog.style.opacity = '0';
        }
        
        setTimeout(() => {
            modal.classList.remove('active');
            if(dialog) {
                dialog.style.transform = '';
                dialog.style.opacity = '';
            }
        }, 200);
    }

    // ======================= Ø¯ÙˆØ§Ù„ Ø¥Ø¶Ø§ÙÙŠØ© =======================
    function updateLeaveStatus(leaveId, status) {
      const leave = DB.leaves.find(l => l.id === leaveId);
      if (leave) {
        leave.status = status;
        save();
        renderHRDashboard();
        log(`ØªÙ… ${status === 'approved' ? 'Ù‚Ø¨ÙˆÙ„' : 'Ø±ÙØ¶'} Ø·Ù„Ø¨ Ø¥Ø¬Ø§Ø²Ø© ${leave.employeeName}`);
      }
    }
    
    function generateCustomReport() {
      const report = {
        id: 'REP' + Date.now(),
        type: 'custom',
        title: 'ØªÙ‚Ø±ÙŠØ± Ù…Ø®ØµØµ',
        generatedAt: new Date().toISOString(),
        data: {
          totalDeals: DB.deals.length,
          totalEmployees: DB.employees.length,
          totalTransactions: DB.transactions.length,
          totalRevenue: DB.transactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0),
          totalExpenses: DB.transactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0)
        }
      };
      
      DB.reports.push(report);
      save();
      renderReportsDashboard();
      log('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ù…Ø®ØµØµ');
    }
    
    function generateProfitLossReport() {
      const today = new Date();
      const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);
      const lastDay = new Date(today.getFullYear(), today.getMonth() + 1, 0);
      
      const report = ACCOUNTING.getProfitLossStatement(
        firstDay.toISOString().split('T')[0],
        lastDay.toISOString().split('T')[0]
      );
      
      const html = `
        <div>
          <div class="report-card">
            <h3>ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ÙˆØ§Ù„Ø®Ø³Ø§Ø¦Ø±</h3>
            <div class="muted">Ø§Ù„ÙØªØ±Ø©: ${report.period}</div>
            
            <div style="margin-top:16px">
              <div style="display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #f1f5f9">
                <div>Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</div>
                <div style="color:var(--success);font-weight:700">${report.income.toLocaleString()} Ø±.ÙŠ</div>
              </div>
              
              <div style="display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #f1f5f9">
                <div>Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</div>
                <div style="color:var(--danger);font-weight:700">${report.expenses.toLocaleString()} Ø±.ÙŠ</div>
              </div>
              
              <div style="display:flex;justify-content:space-between;padding:8px 0;border-bottom:2px solid var(--dark)">
                <div><strong>ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­/Ø§Ù„Ø®Ø³Ø§Ø±Ø©</strong></div>
                <div style="color:${report.netProfit >= 0 ? 'var(--success)' : 'var(--danger)'};font-weight:700">
                  ${report.netProfit.toLocaleString()} Ø±.ÙŠ
                </div>
              </div>
            </div>
          </div>
          
          <div style="text-align:left;margin-top:16px">
            <button class="btn primary" onclick="closeModal()">Ù…ÙˆØ§ÙÙ‚</button>
          </div>
        </div>
      `;
      
      openModal('ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ÙˆØ§Ù„Ø®Ø³Ø§Ø¦Ø±', html);
    }
    
    function generateBalanceSheet() {
      const report = ACCOUNTING.getBalanceSheet();
      
      const html = `
        <div>
          <div class="report-card">
            <h3>Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ©</h3>
            <div class="muted">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: ${new Date(report.generatedAt).toLocaleDateString()}</div>
            
            <div style="margin-top:16px">
              <div style="display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #f1f5f9">
                <div><strong>Ø§Ù„Ø£ØµÙˆÙ„</strong></div>
                <div style="font-weight:700">${report.assets.toLocaleString()} Ø±.ÙŠ</div>
              </div>
              
              <div style="display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #f1f5f9">
                <div><strong>Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª</strong></div>
                <div style="font-weight:700">${report.liabilities.toLocaleString()} Ø±.ÙŠ</div>
              </div>
              
              <div style="display:flex;justify-content:space-between;padding:8px 0;border-bottom:2px solid var(--dark)">
                <div><strong>Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</strong></div>
                <div style="font-weight:700">${report.equity.toLocaleString()} Ø±.ÙŠ</div>
              </div>
              
              <div style="display:flex;justify-content:space-between;padding:8px 0;margin-top:8px">
                <div><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</strong></div>
                <div style="font-weight:700">${(report.liabilities + report.equity).toLocaleString()} Ø±.ÙŠ</div>
              </div>
            </div>
          </div>
          
          <div style="text-align:left;margin-top:16px">
            <button class="btn primary" onclick="closeModal()">Ù…ÙˆØ§ÙÙ‚</button>
          </div>
        </div>
      `;
      
      openModal('Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ©', html);
    }

    function openEmployeeDetails(employeeId) {
      const employee = DB.employees.find(e => e.id === employeeId);
      if (!employee) {
        pushNotification('Ø®Ø·Ø£', 'Ø§Ù„Ù…ÙˆØ¸Ù ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 1000);
        return;
      }

      const html = `
        <div>
          <div class="employee-card">
            <h3>${employee.name}</h3>
            <div class="muted">${employee.position} â€¢ ${employee.department}</div>
            <div style="margin-top:12px">
              <div><strong>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„:</strong></div>
              <div>ğŸ“§ ${employee.email || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
              <div>ğŸ“ ${employee.phone || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
            </div>
            <div style="margin-top:12px">
              <div><strong>Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙˆØ¸ÙŠÙÙŠØ©:</strong></div>
              <div>Ø§Ù„Ø±Ø§ØªØ¨: ${employee.salary?.toLocaleString() || '0'} Ø±.ÙŠ</div>
              <div>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ¹ÙŠÙŠÙ†: ${employee.hireDate || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
              <div>Ø§Ù„Ø­Ø§Ù„Ø©: ${employee.status === 'active' ? 'Ù†Ø´Ø·' : 'ØºÙŠØ± Ù†Ø´Ø·'}</div>
              <div>Ù†ÙˆØ¹ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©: ${employee.permission || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
            </div>
          </div>
        </div>
      `;
      
      openModal(`ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù - ${employee.name}`, html);
    }

    function openEditEmployeeModal(employeeId) {
      const employee = DB.employees.find(e => e.id === employeeId);
      if (!employee) {
        pushNotification('Ø®Ø·Ø£', 'Ø§Ù„Ù…ÙˆØ¸Ù ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 1000);
        return;
      }

      const html = `
        <div>
          <form id="editEmployeeForm">
            <div class="form-group">
              <label>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù</label>
              <input type="text" id="edit_emp_name" value="${employee.name}" required>
            </div>
            
            <div class="form-group">
              <label>Ø§Ù„ÙˆØ¸ÙŠÙØ©</label>
              <input type="text" id="edit_emp_position" value="${employee.position}" required>
            </div>
            
            <div class="form-group">
              <label>Ø§Ù„Ù‚Ø³Ù…</label>
              <select id="edit_emp_department" required>
                <option value="operations" ${employee.department === 'operations' ? 'selected' : ''}>Ø§Ù„ØªØ´ØºÙŠÙ„</option>
                <option value="finance" ${employee.department === 'finance' ? 'selected' : ''}>Ø§Ù„Ù…Ø§Ù„ÙŠØ©</option>
                <option value="hr" ${employee.department === 'hr' ? 'selected' : ''}>Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</option>
                <option value="sales" ${employee.department === 'sales' ? 'selected' : ''}>Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</option>
                <option value="it" ${employee.department === 'it' ? 'selected' : ''}>ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</option>
              </select>
            </div>
            
            <div class="form-group">
              <label>Ù†ÙˆØ¹ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</label>
              <select id="edit_emp_permission" required>
                <option value="driver" ${employee.permission === 'driver' ? 'selected' : ''}>Ø³Ø§Ø¦Ù‚</option>
                <option value="finance" ${employee.permission === 'finance' ? 'selected' : ''}>Ù…ÙˆØ¸Ù Ù…Ø§Ù„ÙŠ</option>
                <option value="supervisor" ${employee.permission === 'supervisor' ? 'selected' : ''}>Ù…Ø´Ø±Ù</option>
                <option value="admin" ${employee.permission === 'admin' ? 'selected' : ''}>Ù…Ø¯ÙŠØ±</option>
              </select>
            </div>
            
            <div class="form-group">
              <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
              <input type="email" id="edit_emp_email" value="${employee.email || ''}">
            </div>
            
            <div class="form-group">
              <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
              <input type="tel" id="edit_emp_phone" value="${employee.phone || ''}">
            </div>
            
            <div class="form-group">
              <label>Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</label>
              <input type="number" id="edit_emp_salary" value="${employee.salary || 0}" required>
            </div>
            
            <div class="form-group">
              <label>Ø§Ù„Ø­Ø§Ù„Ø©</label>
              <select id="edit_emp_status" required>
                <option value="active" ${employee.status === 'active' ? 'selected' : ''}>Ù†Ø´Ø·</option>
                <option value="inactive" ${employee.status === 'inactive' ? 'selected' : ''}>ØºÙŠØ± Ù†Ø´Ø·</option>
              </select>
            </div>
            
            <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
              <button type="button" class="btn danger" onclick="deleteEmployee('${employee.id}')">Ø­Ø°Ù</button>
              <button type="button" class="btn ghost" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
              <button type="submit" class="btn primary">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
            </div>
          </form>
        </div>
      `;
      
      openModal(`ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù - ${employee.name}`, html);

      document.getElementById('editEmployeeForm').addEventListener('submit', function(e) {
        e.preventDefault();
        updateEmployee(employeeId);
      });
    }

    function updateEmployee(employeeId) {
      const employee = DB.employees.find(e => e.id === employeeId);
      if (!employee) return;

      const updates = {
        name: document.getElementById('edit_emp_name').value,
        position: document.getElementById('edit_emp_position').value,
        department: document.getElementById('edit_emp_department').value,
        permission: document.getElementById('edit_emp_permission').value,
        email: document.getElementById('edit_emp_email').value,
        phone: document.getElementById('edit_emp_phone').value,
        salary: parseInt(document.getElementById('edit_emp_salary').value),
        status: document.getElementById('edit_emp_status').value
      };

      const employeeIndex = DB.employees.findIndex(e => e.id === employeeId);
      if (employeeIndex !== -1) {
        DB.employees[employeeIndex] = { ...DB.employees[employeeIndex], ...updates };
        save();
        closeModal();
        renderHRDashboard();
        log(`ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù: ${updates.name}`);
        pushNotification('ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«', `ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª ${updates.name}`, 1000);
      }
    }

    function deleteEmployee(employeeId) {
      if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ¸ÙØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.')) {
        return;
      }

      const employee = DB.employees.find(e => e.id === employeeId);
      if (!employee) return;

      DB.employees = DB.employees.filter(e => e.id !== employeeId);
      save();
      closeModal();
      renderHRDashboard();
      log(`ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…ÙˆØ¸Ù: ${employee.name}`);
      pushNotification('ØªÙ… Ø§Ù„Ø­Ø°Ù', `ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…ÙˆØ¸Ù ${employee.name}`, 1000);
    }

    function openEvaluationDetails(evaluationId) {
      const evaluation = DB.evaluations.find(e => e.id === evaluationId);
      if (!evaluation) {
        pushNotification('Ø®Ø·Ø£', 'Ø§Ù„ØªÙ‚ÙŠÙŠÙ… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 1000);
        return;
      }

      const html = `
        <div>
          <div class="employee-card">
            <h3>ØªÙ‚ÙŠÙŠÙ… ${evaluation.employeeName}</h3>
            <div class="muted">Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date(evaluation.date).toLocaleDateString()}</div>
            <div style="margin-top:12px">
              <div><strong>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…:</strong> ${evaluation.rating}/5</div>
              <div style="margin-top:8px">
                <strong>Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª:</strong>
                <div class="muted" style="margin-top:4px">${evaluation.comments || 'Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¹Ù„ÙŠÙ‚Ø§Øª'}</div>
              </div>
              ${evaluation.recommendations ? `
                <div style="margin-top:8px">
                  <strong>Ø§Ù„ØªÙˆØµÙŠØ§Øª:</strong>
                  <div class="muted" style="margin-top:4px">${evaluation.recommendations}</div>
                </div>
              ` : ''}
            </div>
          </div>
        </div>
      `;
      
      openModal(`ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… - ${evaluation.employeeName}`, html);
    }

    function openReportDetails(reportId) {
      const report = DB.reports.find(r => r.id === reportId);
      if (!report) {
        pushNotification('Ø®Ø·Ø£', 'Ø§Ù„ØªÙ‚Ø±ÙŠØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 1000);
        return;
      }

      let detailsHtml = '';
      
      if (report.type === 'financial') {
        detailsHtml = `
          <div><strong>Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª:</strong> ${report.data.income.toLocaleString()} Ø±.ÙŠ</div>
          <div><strong>Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª:</strong> ${report.data.expenses.toLocaleString()} Ø±.ÙŠ</div>
          <div><strong>ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­:</strong> ${report.data.netProfit.toLocaleString()} Ø±.ÙŠ</div>
          <div><strong>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª:</strong> ${report.data.transactionCount}</div>
        `;
      } else if (report.type === 'operational') {
        detailsHtml = `
          <div><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙÙ‚Ø§Øª:</strong> ${report.data.totalDeals}</div>
          <div><strong>Ø§Ù„ØµÙÙ‚Ø§Øª Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©:</strong> ${report.data.completedDeals}</div>
          <div><strong>Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²:</strong> ${report.data.completionRate}%</div>
          <div><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª:</strong> ${report.data.totalRevenue.toLocaleString()} Ø±.ÙŠ</div>
          <div><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª:</strong> ${report.data.totalTrucks}</div>
          <div><strong>Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©:</strong> ${report.data.completedTrucks}</div>
          <div><strong>Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:</strong> ${report.data.truckUtilizationRate}%</div>
        `;
      } else if (report.type === 'hr') {
        detailsHtml = `
          <div><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†:</strong> ${report.data.totalEmployees}</div>
          <div><strong>Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†:</strong> ${report.data.activeEmployees}</div>
          <div><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨:</strong> ${report.data.totalSalary.toLocaleString()} Ø±.ÙŠ</div>
          <div><strong>Ù…ØªÙˆØ³Ø· Ø§Ù„Ø±Ø§ØªØ¨:</strong> ${report.data.avgSalary.toLocaleString()} Ø±.ÙŠ</div>
          <div><strong>Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©:</strong> ${report.data.leaveRequests}</div>
          <div><strong>Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„Ø©:</strong> ${report.data.approvedLeaves}</div>
          <div><strong>Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª:</strong> ${report.data.evaluations}</div>
          <div><strong>Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ø¶ÙˆØ±:</strong> ${report.data.attendanceRate}%</div>
        `;
      }

      const html = `
        <div>
          <div class="report-card">
            <h3>${report.title || `ØªÙ‚Ø±ÙŠØ± ${report.type} - ${report.period}`}</h3>
            <div class="muted">ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙÙŠ: ${new Date(report.generatedAt).toLocaleString()}</div>
            <div style="margin-top:12px">
              ${detailsHtml}
            </div>
          </div>
          <div style="text-align:left; margin-top:12px">
            <button class="btn danger" onclick="deleteReport('${report.id}')">Ø­Ø°Ù Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
          </div>
        </div>
      `;
      
      openModal('ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ±', html);
    }

    function deleteReport(reportId) {
      if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ±ØŸ')) {
        return;
      }

      DB.reports = DB.reports.filter(r => r.id !== reportId);
      save();
      closeModal();
      renderReportsDashboard();
      log('ØªÙ… Ø­Ø°Ù Ø§Ù„ØªÙ‚Ø±ÙŠØ±');
      pushNotification('ØªÙ… Ø§Ù„Ø­Ø°Ù', 'ØªÙ… Ø­Ø°Ù Ø§Ù„ØªÙ‚Ø±ÙŠØ±', 1000);
    }

    // ======================= Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ø¨Ø§Ù„Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬ =======================
    function uiCreateAccount() {
      const id = prompt('Ù…Ø¹Ø±Ù Ø§Ù„Ø­Ø³Ø§Ø¨ (Ù…Ø«Ø§Ù„: client_CUST2)');
      if (!id) return;
      
      const name = prompt('Ø§Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨');
      if (!name) return;
      
      const code = prompt('ÙƒÙˆØ¯ Ø§Ù„Ø­Ø³Ø§Ø¨') || Math.floor(Math.random()*9000)+1000;
      const type = prompt('Ù†ÙˆØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨ (asset, liability, income, expense, equity)') || 'asset';
      
      DB.accounts[id] = {
        id,
        code: String(code),
        name,
        type,
        balance: 0
      };
      
      save();
      renderAccountingDashboard();
      pushNotification('ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡', `ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ ${name}`, 1000);
    }
    
    function uiIssueInvoice() {
      if (DB.deals.length === 0) {
        alert('Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙÙ‚Ø§Øª Ù…ØªØ§Ø­Ø©. ÙŠØ±Ø¬Ù‰ Ø¥Ù†Ø´Ø§Ø¡ ØµÙÙ‚Ø© Ø£ÙˆÙ„Ø§Ù‹.');
        return;
      }
      
      const deal = DB.deals[0];
      const clientId = deal.clientId || 'CUST_TEST';
      const amount = Number(prompt('Ù…Ø¨Ù„Øº Ø§Ù„ÙØ§ØªÙˆØ±Ø©', deal.dealValue)) || 0;
      
      if (amount <= 0) {
        alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­');
        return;
      }
      
      const invoice = issueInvoice({
        dealId: deal.id,
        clientId,
        amount,
        items: []
      });
      
      pushNotification('ÙØ§ØªÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©', `ØªÙ… Ø¥ØµØ¯Ø§Ø± ÙØ§ØªÙˆØ±Ø© ${invoice.number}`, 1000);
      renderAccountingDashboard();
    }
    
    function uiRecordPayment() {
      if (DB.invoices.length === 0) {
        alert('Ù„Ø§ ØªÙˆØ¬Ø¯ ÙÙˆØ§ØªÙŠØ± Ù…ØªØ§Ø­Ø©');
        return;
      }
      
      const invoice = DB.invoices.find(i => i.status !== 'paid') || DB.invoices[0];
      const amount = Number(prompt('Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙØ¹Ø©', invoice.amount - (invoice.paid || 0))) || 0;
      const account = prompt('Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… (cash/bank)', 'cash');
      
      if (amount <= 0) {
        alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­');
        return;
      }
      
      const payment = recordPayment({
        invoiceId: invoice.id,
        amount,
        receivedAccountId: account
      });
      
      pushNotification('Ø¯ÙØ¹Ø© Ø¬Ø¯ÙŠØ¯Ø©', `ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯ÙØ¹Ø© ${fmt(amount)} Ø±.ÙŠ`, 1000);
      renderAccountingDashboard();
    }
    
    function uiCreateDeal() {
      const clientId = prompt('Ù…Ø¹Ø±Ù Ø§Ù„Ø¹Ù…ÙŠÙ„ (Ù…Ø«Ø§Ù„: CUST1)') || uid('client');
      const truckId = prompt('Ù…Ø¹Ø±Ù Ø§Ù„Ù‚Ø§Ø·Ø±Ø© (Ù…Ø«Ø§Ù„: TRK1)') || uid('truck');
      const driverId = prompt('Ù…Ø¹Ø±Ù Ø§Ù„Ø³Ø§Ø¦Ù‚ (Ù…Ø«Ø§Ù„: DRV1)') || uid('driver');
      
      const deal = createDeal({
        clientId,
        truckId,
        driverId,
        note: 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØªØ¬Ø±ÙŠØ¨ÙŠ'
      });
      
      pushNotification('ØµÙÙ‚Ø© Ø¬Ø¯ÙŠØ¯Ø©', `ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØµÙÙ‚Ø© ${deal.id}`, 1000);
      renderAccountingDashboard();
    }
    
    function uiAutoMatch() {
      // Ø¨Ø³ÙŠØ·: Ù„Ù„Ø¯ÙØ¹Ø§Øª Ø§Ù„Ø£ÙˆÙ„Ù‰: Ø§Ø±Ø¬Ø¹ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ ØºÙŠØ± Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø©
      DB.payments.forEach(p => {
        const inv = DB.invoices.find(i => i.id === p.invoiceId);
        if (inv && !inv.reconciled) {
          inv.reconciled = true;
          p.reconciled = true;
        }
      });
      
      save();
      pushNotification('ØªÙ… Ø§Ù„ØªØ³ÙˆÙŠØ©', 'ØªÙ…Øª Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªÙˆÙÙŠÙ‚ Ø§Ù„Ø¨Ø³ÙŠØ·Ø©', 1000);
      renderAccountingDashboard();
    }

    // ======================= Ø¯ÙˆØ§Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹ÙŠÙ†Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© =======================
    function loadSample() {
      if (!confirm('Ø³ØªØ³ØªØ¨Ø¯Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¨Ø¹ÙŠÙ†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©. Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±ØŸ')) return;
      
      try {
        // Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        const settings = DB.settings;
        Object.keys(DB).forEach(key => {
          if (key !== 'settings' && key !== 'accounts') {
            if (Array.isArray(DB[key])) {
              DB[key] = [];
            } else if (typeof DB[key] === 'object') {
              DB[key] = {};
            }
          }
        });
        DB.settings = settings;
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        if (!DB.accounts || Object.keys(DB.accounts).length === 0) {
          DB.accounts = {
            cash: { id: 'cash', code: '1000', name: 'Ø§Ù„Ø®Ø²ÙŠÙ†Ø© (Ù†Ù‚Ø¯)', type: 'asset', balance: 500000 },
            bank: { id: 'bank', code: '1010', name: 'Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†Ùƒ', type: 'asset', balance: 500000 },
            ar: { id: 'ar', code: '1100', name: 'Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ - Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© (Ø¹Ø§Ù…)', type: 'asset', balance: 0 },
            ap: { id: 'ap', code: '2000', name: 'Ø§Ù„Ù…ÙˆØ±Ø¯ÙˆÙ† - Ø§Ù„Ø¯Ø§Ø¦Ù†ÙˆÙ† (Ø¹Ø§Ù…)', type: 'liability', balance: 0 },
            revenue: { id: 'revenue', code: '4000', name: 'Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ù‚Ù„', type: 'income', balance: 0 },
            fuel_exp: { id: 'fuel_exp', code: '5100', name: 'Ù…ØµØ§Ø±ÙŠÙ ÙˆÙ‚ÙˆØ¯', type: 'expense', balance: 0 },
            salary_exp: { id: 'salary_exp', code: '5200', name: 'Ø±ÙˆØ§ØªØ¨', type: 'expense', balance: 0 },
            maintenance_exp: { id: 'maintenance_exp', code: '5300', name: 'ØµÙŠØ§Ù†Ø©', type: 'expense', balance: 0 },
            equity: { id: 'equity', code: '3000', name: 'Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„', type: 'equity', balance: 1000000 }
          };
        }

        DB.budget = { income: 0, expenses: 0, balance: 0 };

        // Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„ØµÙÙ‚Ø§Øª
        const sampleDeals = [ 
          {
            id: 'D1',
            dealNumber: 'DEAL-2025-001',
            shipName: 'ANTAKYA M',
            companyName: 'ÙØ§Ù„ÙƒÙˆÙ†',
            clientId: 'C1',
            destination: 'SAL',
            totalLoad: 180,
            pricePerTon: 50,
            dealValue: 9000,
            cargoType: 'coal',
            notes: 'Ø§ØªÙØ§Ù‚ÙŠØ© Ø´Ù‡Ø±ÙŠØ©',
            trucks: [],
            createdAt: new Date().toISOString(),
            status: 'created'
          }, 
          {
            id: 'D2',
            dealNumber: 'DEAL-2025-002',
            shipName: 'PRIDE',
            companyName: 'Ø³Ø¨Ø£',
            clientId: 'C2',
            destination: 'HOD',
            totalLoad: 120,
            pricePerTon: 55,
            dealValue: 6600,
            cargoType: 'grain',
            notes: 'ØªØ³Ù„ÙŠÙ… Ø¬Ø²Ø¦ÙŠ Ù…Ù…ÙƒÙ†',
            trucks: [],
            createdAt: new Date().toISOString(),
            status: 'created'
          }, 
          {
            id: 'D3',
            dealNumber: 'DEAL-2025-003',
            shipName: 'MERCURY',
            companyName: 'Ø¹Ø§Ù„Ù… Ø§Ù„Ø¨Ø­Ø§Ø±',
            clientId: 'C3',
            destination: 'ADL',
            totalLoad: 240,
            pricePerTon: 48,
            dealValue: 11520,
            cargoType: 'general',
            notes: 'Ù…Ø°ÙƒØ±Ø© Ø´Ø­Ù† Ø¹Ø§Ù…Ø©',
            trucks: [],
            createdAt: new Date().toISOString(),
            status: 'created'
          } 
        ];
        
        sampleDeals.forEach((d, i) => { 
          const trucks = calculateOptimalTrucks(d.totalLoad, DB.settings.maxTruckLoad);
          trucks.forEach((truck, j) => {
            truck.driverName = ['Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯', 'Ø³Ø§Ù„Ù… Ø¹Ù„ÙŠ', 'Ø®Ø§Ù„Ø¯ Ø£Ø­Ù…Ø¯', 'Ù…Ø­Ù…ÙˆØ¯ Ø­Ø³Ù†', 'ÙŠÙˆØ³Ù ÙƒÙ…Ø§Ù„'][j % 5];
            truck.rentAmount = Math.round((d.dealValue / d.totalLoad) * truck.load * 0.65);
            // Ø¬Ø¹Ù„ Ø¨Ø¹Ø¶ Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª ÙÙŠ Ø­Ø§Ù„Ø§Øª Ù…Ø®ØªÙ„ÙØ© Ù„Ù…Ø­Ø§ÙƒØ§Ø© ÙˆØ§Ù‚Ø¹ÙŠØ©
            if (i === 0 && j === 0) {
              truck.driverAccepted = true;
              truck.acceptedAt = new Date(Date.now() - 86400000).toISOString();
            } else if (i === 0 && j === 1) {
              truck.driverAccepted = true;
              truck.startedAt = new Date(Date.now() - 43200000).toISOString();
            } else if (i === 1 && j === 0) {
              truck.driverAccepted = true;
              truck.startedAt = new Date(Date.now() - 21600000).toISOString();
              truck.delivered = true;
              truck.deliveredAt = new Date(Date.now() - 7200000).toISOString();
            }
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨Ø§Øª Ù„Ù„Ù‚Ø§Ø·Ø±Ø§Øª ÙˆØ§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†
            const truckAccountId = `truck_${truck.id}`;
            DB.accounts[truckAccountId] = {
              id: truckAccountId,
              code: Math.floor(Math.random()*9000)+1000,
              name: `Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‚Ø§Ø·Ø±Ø© ${truck.truckNumber}`,
              type: 'asset',
              balance: 0
            };
            
            const driverAccountId = `driver_${truck.driverName.replace(/\s+/g, '_')}`;
            DB.accounts[driverAccountId] = {
              id: driverAccountId,
              code: Math.floor(Math.random()*9000)+1000,
              name: `Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø§Ø¦Ù‚ ${truck.driverName}`,
              type: 'asset',
              balance: 0
            };
          });
          d.trucks = trucks;
          
          // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ù„Ù„Ø¹Ù…ÙŠÙ„
          const clientAccountId = `client_${d.clientId}`;
          DB.accounts[clientAccountId] = {
            id: clientAccountId,
            code: Math.floor(Math.random()*9000)+1000,
            name: `Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„ ${d.companyName}`,
            type: 'asset',
            balance: 0
          };
          
          DB.deals.push(d); 
        });

        // Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©
        const sampleEmployees = [
          {
            id: 'EMP1',
            name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯',
            position: 'Ø³Ø§Ø¦Ù‚',
            department: 'operations',
            permission: 'driver',
            email: 'ahmed@company.com',
            phone: '0123456789',
            salary: 15000,
            hireDate: '2024-01-15',
            status: 'active'
          },
          {
            id: 'EMP2',
            name: 'Ø³Ø§Ù„Ù… Ø¹Ù„ÙŠ',
            position: 'Ù…Ø­Ø§Ø³Ø¨',
            department: 'finance',
            permission: 'finance',
            email: 'salem@company.com',
            phone: '0123456790',
            salary: 20000,
            hireDate: '2024-02-10',
            status: 'active'
          },
          {
            id: 'EMP3',
            name: 'Ø®Ø§Ù„Ø¯ Ø£Ø­Ù…Ø¯',
            position: 'Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª',
            department: 'operations',
            permission: 'supervisor',
            email: 'khaled@company.com',
            phone: '0123456791',
            salary: 30000,
            hireDate: '2024-01-01',
            status: 'active'
          }
        ];
        
        sampleEmployees.forEach(emp => {
          DB.employees.push(emp);
          
          // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ù„Ù„Ù…ÙˆØ¸Ù
          const employeeAccountId = `employee_${emp.id}`;
          DB.accounts[employeeAccountId] = {
            id: employeeAccountId,
            code: Math.floor(Math.random()*9000)+1000,
            name: `Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ÙˆØ¸Ù ${emp.name}`,
            type: 'asset',
            balance: 0
          };
        });

        // Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©
        const sampleTransactions = [
          {
            id: 'TRX1',
            type: 'income',
            amount: 50000,
            description: 'Ø¯ÙØ¹Ø© Ù…Ù† Ø¹Ù…ÙŠÙ„ ÙØ§Ù„ÙƒÙˆÙ†',
            fromAccount: 'client_C1',
            toAccount: 'revenue',
            category: 'operations',
            date: new Date(Date.now() - 86400000).toISOString()
          },
          {
            id: 'TRX2',
            type: 'expense',
            amount: 15000,
            description: 'Ø±Ø§ØªØ¨ Ø§Ù„Ø³Ø§Ø¦Ù‚ Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯',
            fromAccount: 'cash',
            toAccount: 'salary_exp',
            category: 'salaries',
            date: new Date(Date.now() - 172800000).toISOString()
          },
          {
            id: 'TRX3',
            type: 'expense',
            amount: 5000,
            description: 'Ù…ØµØ§Ø±ÙŠÙ ÙˆÙ‚ÙˆØ¯',
            fromAccount: 'cash',
            toAccount: 'fuel_exp',
            category: 'fuel',
            date: new Date(Date.now() - 259200000).toISOString()
          }
        ];
        
        sampleTransactions.forEach(trx => {
          DB.transactions.push(trx);
          
          // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©
          if (trx.type === 'income') {
            DB.budget.income += trx.amount;
            DB.budget.balance += trx.amount;
          } else if (trx.type === 'expense') {
            DB.budget.expenses += trx.amount;
            DB.budget.balance -= trx.amount;
          }
        });

        // Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ø­Ø¶ÙˆØ±
        const today = new Date().toISOString().split('T')[0];
        const yesterday = new Date(Date.now() - 86400000).toISOString().split('T')[0];
        
        DB.employees.forEach(emp => {
          DB.attendance.push({
            id: 'ATT' + Date.now(),
            employeeId: emp.id,
            employeeName: emp.name,
            date: today,
            status: 'present',
            recordedAt: new Date().toISOString()
          });
          
          DB.attendance.push({
            id: 'ATT' + Date.now(),
            employeeId: emp.id,
            employeeName: emp.name,
            date: yesterday,
            status: 'present',
            recordedAt: new Date(Date.now() - 86400000).toISOString()
          });
        });

        save();
        renderAll();
        pushNotification('ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„', 'ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­', 1000);
      } catch (error) {
        console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹ÙŠÙ†Ø§Øª:', error);
        pushNotification('Ø®Ø·Ø£', 'ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©', 1000);
      }
    }

    function fixSampleData() {
      try {
        // Ø¥ØµÙ„Ø§Ø­ Ø£ÙŠ Ù…Ø´Ø§ÙƒÙ„ ÙÙŠ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        initializeDB();
        
        // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙÙ‚Ø§Øª ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
        DB.deals.forEach(deal => {
          if (!deal.trucks) deal.trucks = [];
          if (!deal.createdAt) deal.createdAt = new Date().toISOString();
          if (!deal.status) deal.status = 'created';
          
          // Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù‚Ø§Ø·Ø±Ø§Øª
          deal.trucks.forEach(truck => {
            if (!truck.id) truck.id = uid('T');
            if (!truck.truckNumber) truck.truckNumber = 'TR-' + Math.floor(Math.random() * 1000);
            if (!truck.driverName) truck.driverName = 'Ø³ÙŠØªÙ… Ø§Ù„ØªØ¹ÙŠÙŠÙ†';
            if (!truck.load) truck.load = 0;
            if (!truck.rentAmount) truck.rentAmount = 0;
            if (!truck.dieselAmount) truck.dieselAmount = 0;
            if (!truck.expensesAdvance) truck.expensesAdvance = 0;
            if (!truck.driverAccepted) truck.driverAccepted = false;
            if (!truck.delivered) truck.delivered = false;
            if (!truck.clientConfirmed) truck.clientConfirmed = false;
            if (!truck.companyRevenue) truck.companyRevenue = 0;
            if (!truck.payout) truck.payout = { created: false, paid: false };
          });
        });
        
        // Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
        DB.employees.forEach(emp => {
          if (!emp.id) emp.id = uid('EMP');
          if (!emp.status) emp.status = 'active';
          if (!emp.permission) emp.permission = 'driver';
        });
        
        // Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª
        if (!DB.accounts || Object.keys(DB.accounts).length === 0) {
          DB.accounts = {
            cash: { id: 'cash', code: '1000', name: 'Ø§Ù„Ø®Ø²ÙŠÙ†Ø© (Ù†Ù‚Ø¯)', type: 'asset', balance: 0 },
            bank: { id: 'bank', code: '1010', name: 'Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†Ùƒ', type: 'asset', balance: 0 },
            ar: { id: 'ar', code: '1100', name: 'Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ - Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© (Ø¹Ø§Ù…)', type: 'asset', balance: 0 },
            ap: { id: 'ap', code: '2000', name: 'Ø§Ù„Ù…ÙˆØ±Ø¯ÙˆÙ† - Ø§Ù„Ø¯Ø§Ø¦Ù†ÙˆÙ† (Ø¹Ø§Ù…)', type: 'liability', balance: 0 },
            revenue: { id: 'revenue', code: '4000', name: 'Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ù‚Ù„', type: 'income', balance: 0 },
            fuel_exp: { id: 'fuel_exp', code: '5100', name: 'Ù…ØµØ§Ø±ÙŠÙ ÙˆÙ‚ÙˆØ¯', type: 'expense', balance: 0 },
            salary_exp: { id: 'salary_exp', code: '5200', name: 'Ø±ÙˆØ§ØªØ¨', type: 'expense', balance: 0 },
            maintenance_exp: { id: 'maintenance_exp', code: '5300', name: 'ØµÙŠØ§Ù†Ø©', type: 'expense', balance: 0 },
            equity: { id: 'equity', code: '3000', name: 'Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„', type: 'equity', balance: 0 }
          };
        }
        
        save();
        renderAll();
        pushNotification('ØªÙ… Ø§Ù„Ø¥ØµÙ„Ø§Ø­', 'ØªÙ… Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 1000);
      } catch (error) {
        console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
        pushNotification('Ø®Ø·Ø£', 'ÙØ´Ù„ ÙÙŠ Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 1000);
      }
    }

    function clearAllData() {
      if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.')) return;
      
      try {
        Object.keys(DB).forEach(key => {
          if (key !== 'settings') {
            if (Array.isArray(DB[key])) {
              DB[key] = [];
            } else if (typeof DB[key] === 'object') {
              DB[key] = {};
            }
          }
        });
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        DB.accounts = {
          cash: { id: 'cash', code: '1000', name: 'Ø§Ù„Ø®Ø²ÙŠÙ†Ø© (Ù†Ù‚Ø¯)', type: 'asset', balance: 0 },
          bank: { id: 'bank', code: '1010', name: 'Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†Ùƒ', type: 'asset', balance: 0 },
          ar: { id: 'ar', code: '1100', name: 'Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ - Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© (Ø¹Ø§Ù…)', type: 'asset', balance: 0 },
          ap: { id: 'ap', code: '2000', name: 'Ø§Ù„Ù…ÙˆØ±Ø¯ÙˆÙ† - Ø§Ù„Ø¯Ø§Ø¦Ù†ÙˆÙ† (Ø¹Ø§Ù…)', type: 'liability', balance: 0 },
          revenue: { id: 'revenue', code: '4000', name: 'Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ù‚Ù„', type: 'income', balance: 0 },
          fuel_exp: { id: 'fuel_exp', code: '5100', name: 'Ù…ØµØ§Ø±ÙŠÙ ÙˆÙ‚ÙˆØ¯', type: 'expense', balance: 0 },
          salary_exp: { id: 'salary_exp', code: '5200', name: 'Ø±ÙˆØ§ØªØ¨', type: 'expense', balance: 0 },
          maintenance_exp: { id: 'maintenance_exp', code: '5300', name: 'ØµÙŠØ§Ù†Ø©', type: 'expense', balance: 0 },
          equity: { id: 'equity', code: '3000', name: 'Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„', type: 'equity', balance: 0 }
        };
        
        DB.budget = { income: 0, expenses: 0, balance: 0 };
        
        save();
        renderAll();
        pushNotification('ØªÙ… Ø§Ù„Ù…Ø³Ø­', 'ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 1000);
      } catch (error) {
        console.error('Ø®Ø·Ø£ ÙÙŠ Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
        pushNotification('Ø®Ø·Ø£', 'ÙØ´Ù„ ÙÙŠ Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 1000);
      }
    }

    function exportData() {
      try {
        const dataStr = JSON.stringify(DB, null, 2);
        const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
        
        const exportFileDefaultName = `tms_backup_${new Date().toISOString().split('T')[0]}.json`;
        
        const linkElement = document.createElement('a');
        linkElement.setAttribute('href', dataUri);
        linkElement.setAttribute('download', exportFileDefaultName);
        linkElement.click();
        
        pushNotification('ØªÙ… Ø§Ù„ØªØµØ¯ÙŠØ±', 'ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 1000);
      } catch (error) {
        console.error('Ø®Ø·Ø£ ÙÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
        pushNotification('Ø®Ø·Ø£', 'ÙØ´Ù„ ÙÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 1000);
      }
    }

    // ======================= Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø¯ÙˆØ§Ø± =======================
    function switchRole(role) {
      currentUserRole = role;
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†Ø´Ø·Ø©
      document.querySelectorAll('.role-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      document.querySelector(`[data-role="${role}"]`).classList.add('active');
      
      // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø§Ø¸Ø±
      document.querySelectorAll('.view').forEach(view => {
        view.classList.remove('active');
      });
      
      // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ù†Ø¸Ø± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
      document.getElementById(`view_${role}`).classList.add('active');
      
      // Ø¥Ø¹Ø§Ø¯Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ±
      renderAll();
      
      log(`ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø¯ÙˆØ± Ø¥Ù„Ù‰: ${role}`);
    }

    // ======================= Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨ =======================
    function setupTabs() {
      document.addEventListener('click', function(e) {
        if (e.target && e.target.classList.contains('tab')) {
          const tabContainer = e.target.closest('.tab-container');
          const contentContainer = tabContainer.nextElementSibling;
          const tabId = e.target.getAttribute('data-tab');
          
          // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø§Ø· Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª
          tabContainer.querySelectorAll('.tab').forEach(tab => {
            tab.classList.remove('active');
          });
          contentContainer.querySelectorAll('.tab-content').forEach(content => {
            content.classList.remove('active');
          });
          
          // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ø´Ø§Ø· Ù„Ù„Ø²Ø± ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø­Ø¯Ø¯
          e.target.classList.add('active');
          contentContainer.querySelector(`#tab-${tabId}`).classList.add('active');
        }
      });
    }

    // ======================= Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙ‡ÙŠØ¦Ø© ÙˆØ§Ù„Ø¹Ø±Ø¶ =======================
    function renderAll() {
      renderKPIs();
      renderActivity();
      
      // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠ
      switch(currentUserRole) {
        case 'admin':
          renderAdminList();
          renderInvoices();
          break;
        case 'driver':
          renderDriverTasks();
          break;
        case 'client':
          renderClientNotifications();
          break;
        case 'agent':
          renderAgentTasks();
          break;
        case 'hr':
          renderHRDashboard();
          break;
        case 'accountant':
          renderAccountantDashboard();
          break;
        case 'reports':
          renderReportsDashboard();
          break;
        case 'accounting':
          renderAccountingDashboard();
          break;
        case 'help':
          renderHelpContent();
          break;
      }
    }

    // ======================= Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© =======================
    document.addEventListener('DOMContentLoaded', function() {
      // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
      document.querySelectorAll('.role-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          switchRole(this.getAttribute('data-role'));
        });
      });
      
      setupTabs();
      
      // Ø¥Ø¹Ø¯Ø§Ø¯ Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡
      document.addEventListener('submit', function(e) {
        e.preventDefault();
        
        if (e.target.id === 'createDealForm') {
          const dealData = {
            dealNumber: document.getElementById('dealNumber').value,
            shipName: document.getElementById('shipName').value,
            companyName: document.getElementById('companyName').value,
            clientId: 'C' + Date.now(),
            destination: document.getElementById('destination').value,
            totalLoad: parseInt(document.getElementById('totalLoad').value),
            pricePerTon: parseInt(document.getElementById('pricePerTon').value),
            cargoType: document.getElementById('cargoType').value,
            notes: document.getElementById('notes').value
          };
          
          TMS.createDeal(dealData).then(() => {
            closeModal();
            renderAll();
          });
        }
        
        if (e.target.id === 'addEmployeeForm') {
          const employeeData = {
            name: document.getElementById('emp_name').value,
            position: document.getElementById('emp_position').value,
            department: document.getElementById('emp_department').value,
            permission: document.getElementById('emp_permission').value,
            email: document.getElementById('emp_email').value,
            phone: document.getElementById('emp_phone').value,
            salary: parseInt(document.getElementById('emp_salary').value),
            hireDate: document.getElementById('emp_hireDate').value
          };
          
          HR.addEmployee(employeeData).then(() => {
            closeModal();
            renderAll();
          });
        }
        
        if (e.target.id === 'addTransactionForm') {
          const transactionData = {
            type: document.getElementById('trx_type').value,
            amount: parseInt(document.getElementById('trx_amount').value),
            description: document.getElementById('trx_description').value,
            fromAccount: document.getElementById('trx_fromAccount').value,
            toAccount: document.getElementById('trx_toAccount').value,
            category: document.getElementById('trx_category').value,
            date: document.getElementById('trx_date').value
          };
          
          ACCOUNTING.addTransaction(transactionData).then(() => {
            closeModal();
            renderAll();
          });
        }
        
        if (e.target.id === 'updateBudgetForm') {
          const budgetData = {
            income: parseInt(document.getElementById('budget_income').value),
            expenses: parseInt(document.getElementById('budget_expenses').value)
          };
          
          ACCOUNTING.updateBudget(budgetData).then(() => {
            closeModal();
            renderAll();
          });
        }
        
        if (e.target.id === 'assignForm') {
          const truckData = {
            truckNumber: document.getElementById('a_truck').value,
            driverName: document.getElementById('a_driver').value,
            load: parseInt(document.getElementById('a_load').value),
            rentAmount: parseInt(document.getElementById('a_rent').value)
          };
          
          const deal = DB.deals.find(d => d.id === currentAssignDealId);
          if (deal) {
            const newTruck = {
              id: 'T' + Date.now(),
              ...truckData,
              driverPhone: '',
              dieselAmount: 0,
              expensesAdvance: 0,
              driverAccepted: false,
              delivered: false,
              clientConfirmed: false,
              companyRevenue: 0,
              payout: { created: false, paid: false }
            };
            
            deal.trucks.push(newTruck);
            save();
            closeModal();
            renderAll();
            pushNotification('ØªÙ… Ø§Ù„ØªØ¹ÙŠÙŠÙ†', `ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚Ø§Ø·Ø±Ø© ${truckData.truckNumber} Ù„Ù„Ø³Ø§Ø¦Ù‚ ${truckData.driverName}`);
          }
        }
      });
      
      // Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
      renderAll();
    });
  </script>
</body>
</html>